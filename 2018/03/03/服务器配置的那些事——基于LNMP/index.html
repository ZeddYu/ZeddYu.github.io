<!DOCTYPE html><html class="has-navbar-fixed-top" lang="zh-cmn-Hans"><head><meta charset="utf-8"><title>服务器配置的那些事--基于LNMP - Zedd&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5"><meta name="description" content="ZeddYu's Blog"><meta name="description" content="感觉还是自己搭个服务器比较好。之前是大一下学期就想搭了的，只是当时好像已经开始实行了域名备案措施，江苏备案还要暂住证，就没去弄了，感觉自己用ip弄博客太傻了，所以还是一直用之前在某个博客系统上的博客。那个博客也有很多自己写的东西，而且有些还见不得人的东西-&gt;_-&gt; 所以这篇就用来记录一下就搭建服务器的一些坑 服务器用的是的vultr提供的，域名godaddy。系统centos 7.2"><meta property="og:type" content="article"><meta property="og:title" content="服务器配置的那些事--基于LNMP"><meta property="og:url" content="https://blog.zeddyu.info/2018/03/03/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ELNMP/index.html"><meta property="og:site_name" content="Zedd&#39;s Blog"><meta property="og:description" content="感觉还是自己搭个服务器比较好。之前是大一下学期就想搭了的，只是当时好像已经开始实行了域名备案措施，江苏备案还要暂住证，就没去弄了，感觉自己用ip弄博客太傻了，所以还是一直用之前在某个博客系统上的博客。那个博客也有很多自己写的东西，而且有些还见不得人的东西-&gt;_-&gt; 所以这篇就用来记录一下就搭建服务器的一些坑 服务器用的是的vultr提供的，域名godaddy。系统centos 7.2"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2018-03-03T01:09:00.000Z"><meta property="article:modified_time" content="2021-09-27T17:45:58.724Z"><meta property="article:author" content="Zedd"><meta property="article:tag" content="Dev"><meta name="twitter:card" content="summary"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.8.1/css/bulma.min.css"><script defer="defer" src="https://at.alicdn.com/t/font_1780077_0ad2sbnz4nz.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="/css/style.css"><script>window.ga_tid="UA-112937997-1",window.ga_api="https://blog.zeddyu.info/ga_api/*"</script><script src="https://cdn.jsdelivr.net/npm/cfga@1.0.3" async></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Zedd's Blog" type="application/atom+xml"></head><body><nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation"><div class="container"><div class="navbar-brand"><div class="navbar-item navbar-logo"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s.gravatar.com/avatar/204a0c779acdb62f9084826396f6dccb?s=80" alt="" height="28"></div><div class="navbar-burger"><span></span><span></span><span></span></div></div><div class="navbar-menu navbar-start"> <a class="navbar-item" href="/">Index</a> <a class="navbar-item" href="/archives">Archives</a> <a class="navbar-item" href="/categories">Categories</a> <a class="navbar-item" href="/tags">Tags</a> <a class="navbar-item" href="/friends">Friends</a> <a class="navbar-item" href="/about">About</a> <a class="navbar-item" href="/advertisement">Ads</a></div><div class="navbar-menu navbar-end"> <a class="navbar-item search" title="Search" href="javascript:;"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-sousuo"></use></svg></a><div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc"> <a class="navbar-item" title="Table of Contents"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-list"></use></svg></a><div class="navbar-dropdown is-right"> <a class="navbar-item" href="#0x0">1&nbsp;&nbsp;<b>0x0</b></a><hr class="navbar-divider"> <a class="navbar-item" href="#0x1">2&nbsp;&nbsp;<b>0x1</b></a> <a class="navbar-item" href="#1-添加Nginx到YUM源">2.1&nbsp;&nbsp;1.添加Nginx到YUM源</a> <a class="navbar-item" href="#2-开始安装Nginx">2.2&nbsp;&nbsp;2.开始安装Nginx</a> <a class="navbar-item" href="#3-启动Nginx">2.3&nbsp;&nbsp;3.启动Nginx</a> <a class="navbar-item" href="#4-CentOS-7-开机启动Nginx">2.4&nbsp;&nbsp;4.CentOS 7 开机启动Nginx</a> <a class="navbar-item" href="#5-一些Nginx的常用目录">2.5&nbsp;&nbsp;5.一些Nginx的常用目录</a> <a class="navbar-item" href="#6-注意事项">2.6&nbsp;&nbsp;6.注意事项</a><hr class="navbar-divider"> <a class="navbar-item" href="#0x2">3&nbsp;&nbsp;<b>0x2</b></a> <a class="navbar-item" href="#1-安装">3.1&nbsp;&nbsp;1.安装:</a> <a class="navbar-item" href="#2-启动">3.2&nbsp;&nbsp;2.启动</a> <a class="navbar-item" href="#3-开机启动">3.3&nbsp;&nbsp;3.开机启动</a> <a class="navbar-item" href="#4-配置MariaDB">3.4&nbsp;&nbsp;4.配置MariaDB</a> <a class="navbar-item" href="#5-测试">3.5&nbsp;&nbsp;5.测试</a><hr class="navbar-divider"> <a class="navbar-item" href="#0x3">4&nbsp;&nbsp;<b>0x3</b></a><hr class="navbar-divider"> <a class="navbar-item" href="#0x4">5&nbsp;&nbsp;<b>0x4</b></a> <a class="navbar-item" href="#这里就简单提提typecho的坑。">5.1&nbsp;&nbsp;这里就简单提提typecho的坑。</a><hr class="navbar-divider"> <a class="navbar-item" href="#0x5">6&nbsp;&nbsp;<b>0x5</b></a></div></div> <a class="navbar-item" title="GitHub" href="https://github.com/ZeddYu" target="_blank" rel="noopener"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a> <a class="navbar-item" title="Twitter" href="https://twitter.com/ZeddYu_Lu" target="_blank" rel="noopener"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-twitter"></use></svg></a> <a class="navbar-item" title="RSS" href="https://blog.zeddyu.info/atom.xml"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-rss"></use></svg></a></div></div></nav><section class="section"><div class="container"><article class="article content gallery" itemscope itemprop="blogPost"><h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name"> 服务器配置的那些事--基于LNMP</h1><div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile"> <span class="column is-narrow"><span>Mar 3 2018</span> <span class="second-date-block">(<time datetime="2018-03-03T01:09:00.000Z" itemprop="datePublished">Mar 3 2018</time>)</span></span> <span class="column is-narrow article-category"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-folder"></use></svg><a class="article-category-link" href="/categories/Dev/">Dev</a></span> <span class="column is-narrow"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-shalou"></use></svg> <span class="article-category-link">10 minutes read (About 1560 words)</span></span></div><div class="article-entry is-size-6-mobile" itemprop="articleBody"><ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x0"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x0</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x1"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x1</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-添加Nginx到YUM源"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">1.添加Nginx到YUM源</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-开始安装Nginx"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">2.开始安装Nginx</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-启动Nginx"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">3.启动Nginx</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-CentOS-7-开机启动Nginx"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">4.CentOS 7 开机启动Nginx</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-一些Nginx的常用目录"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">5.一些Nginx的常用目录</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#6-注意事项"><span class="post-toc-number">2.6.</span> <span class="post-toc-text">6.注意事项</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x2"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x2</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-安装"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">1.安装:</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-启动"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">2.启动</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-开机启动"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">3.开机启动</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-配置MariaDB"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">4.配置MariaDB</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-测试"><span class="post-toc-number">3.5.</span> <span class="post-toc-text">5.测试</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x3"><span class="post-toc-number">4.</span> <span class="post-toc-text">0x3</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x4"><span class="post-toc-number">5.</span> <span class="post-toc-text">0x4</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#这里就简单提提typecho的坑。"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">这里就简单提提typecho的坑。</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x5"><span class="post-toc-number">6.</span> <span class="post-toc-text">0x5</span></a></li></ol><html><head></head><body><p>感觉还是自己搭个服务器比较好。之前是大一下学期就想搭了的，只是当时好像已经开始实行了域名备案措施，江苏备案还要暂住证，就没去弄了，感觉自己用ip弄博客太傻了，所以还是一直用之前在某个博客系统上的博客。那个博客也有很多自己写的东西，而且有些还见不得人的东西-&gt;_-&gt;</p><p>所以这篇就用来记录一下就搭建服务器的一些坑</p><p>服务器用的是的vultr提供的，域名godaddy。系统centos 7.2</p><a id="more"></a><h2 id="0x0"><a href="#0x0" class="headerlink" title="0x0"></a>0x0</h2><p>一开始Vultr选好服务器以后，会有个<code>Startup Script</code>的选项，这个选项是可以执行一些服务器建好以后运行的脚本</p><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># <span class="hljs-doctag">NOTE:</span> This is an example that sets up SSH authorization. To use it, you'd need to replace "ssh-rsa AA... youremail@example.com" with your SSH public.</span></span><br><span class="line"><span class="hljs-comment"># You can replace this entire script with anything you'd like, there is no need to keep it</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mkdir -p /root/.ssh</span><br><span class="line">chmod 600 /root/.ssh</span><br><span class="line"><span class="hljs-built_in">echo</span> ssh-rsa AA... youremail@example.com &gt; /root/.ssh/authorized_keys</span><br><span class="line">chmod 700 /root/.ssh/authorized_keys</span><br></pre></td></tr></tbody></table></figure><p></p><p>这是Vultr给的示例脚本示例。这样子的话，每次建服务器只需要你写好脚本就可以配置好一些通用的组件了，例如Nginx、php等。</p><p>我自己写的脚本不是很好，就不放出来了。</p><h2 id="0x1"><a href="#0x1" class="headerlink" title="0x1"></a>0x1</h2><p>然后就是先开始配置nginx了</p><h3 id="1-添加Nginx到YUM源"><a href="#1-添加Nginx到YUM源" class="headerlink" title="1.添加Nginx到YUM源"></a>1.添加Nginx到YUM源</h3><p>添加CentOS 7 Nginx yum资源库,打开终端,使用以下命令:</p><pre><code>sudo rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</code></pre><p>然后为了是最新稳定的Nginx，又特地去修改了yum的nginx.repo</p><pre><code>[nginx]
name=nginx repo
baseurl=http://nginx.org/packages/mainline/OS/OSRELEASE/$basearch/
gpgcheck=0
enabled=1</code></pre><p>按照<a href="https://nginx.org/en/linux_packages.html" target="_blank" rel="noopener">官方文档</a>来修改</p><h3 id="2-开始安装Nginx"><a href="#2-开始安装Nginx" class="headerlink" title="2.开始安装Nginx"></a>2.开始安装Nginx</h3><p>在你的CentOS 7 服务器中使用<code>yum</code>命令从Nginx源服务器中获取来安装Nginx：</p><pre><code>sudo yum install -y nginx</code></pre><h3 id="3-启动Nginx"><a href="#3-启动Nginx" class="headerlink" title="3.启动Nginx"></a>3.启动Nginx</h3><p>刚安装的Nginx不会自行启动。运行Nginx:</p><pre><code>sudo systemctl start nginx.service</code></pre><p>然后可以通过</p><pre><code>curl localshost</code></pre><p>来查看Nginx是否启动成功</p><h3 id="4-CentOS-7-开机启动Nginx"><a href="#4-CentOS-7-开机启动Nginx" class="headerlink" title="4.CentOS 7 开机启动Nginx"></a>4.CentOS 7 开机启动Nginx</h3><pre><code>sudo systemctl enable nginx.service</code></pre><h3 id="5-一些Nginx的常用目录"><a href="#5-一些Nginx的常用目录" class="headerlink" title="5.一些Nginx的常用目录"></a>5.一些Nginx的常用目录</h3><p>网站文件存放默认目录:</p><pre><code>/usr/share/nginx/html</code></pre><p>网站默认站点配置:</p><pre><code>/etc/nginx/conf.d/default.conf</code></pre><p>自定义Nginx站点配置文件存放目录:</p><pre><code>/etc/nginx/conf.d/</code></pre><p>Nginx全局配置</p><pre><code>/etc/nginx/nginx.conf</code></pre><h3 id="6-注意事项"><a href="#6-注意事项" class="headerlink" title="6.注意事项"></a>6.注意事项</h3><p>比较坑的是一开始我只想配个Nginx然后配域名试试能不能访问，结果配好Nginx之后直接访问ip发现无法访问。然后考虑ip被墙了，但是吧,ping了ip还是能ping通的，但是无论挂不挂代理都还是不能访问。这就比较郁闷了。</p><p>后来经过提醒，用 <code>ss -tan</code> 查看了一下端口，发现80已经是处于监听状态了，这就比较奇怪了，再去扫了一下服务器的端口，这时候发现80端口是关闭的。</p><p>百思不得其解，难道Vultr也有阿里云的那种安全防护，得手动打开？</p><p>然后问了一下大佬，就可能是防火墙的问题了。</p><p>Centos是自带的<code>firewall</code>,<code>iptables</code>,但是<code>iptables</code>还得配置，我们就不用<code>iptables</code>了，就用自带的<code>firewalld</code>了</p><p>开始排查防火墙</p><p>先看看80是否开启</p><pre><code>firewall-cmd --query-port=80/tcp</code></pre><p>显示</p><pre><code>no</code></pre><p>果然是因为防火墙屏蔽了80端口，然后我们通过</p><pre><code>firewall-cmd --zone=public --add-port=80/tcp --permanent</code></pre><p>打开80端口，<br>显示</p><pre><code>success</code></pre><p>即可开启80端口，然后重启防火墙</p><pre><code>systemctl [start|stop|restart] firewalld.service </code></pre><p>终于可以看到熟悉的Nginx界面了。<br></p><h2 id="0x2"><a href="#0x2" class="headerlink" title="0x2"></a>0x2</h2><p>接着就是MariaDB</p><h3 id="1-安装"><a href="#1-安装" class="headerlink" title="1.安装:"></a>1.安装:</h3><pre><code>yum install mariadb mariadb-server</code></pre><h3 id="2-启动"><a href="#2-启动" class="headerlink" title="2.启动"></a>2.启动</h3><pre><code>systemctl start mariadb</code></pre><h3 id="3-开机启动"><a href="#3-开机启动" class="headerlink" title="3.开机启动"></a>3.开机启动</h3><pre><code>systemctl enable mariadb</code></pre><h3 id="4-配置MariaDB"><a href="#4-配置MariaDB" class="headerlink" title="4.配置MariaDB"></a>4.配置MariaDB</h3><pre><code>mysql_secure_installation</code></pre><h3 id="5-测试"><a href="#5-测试" class="headerlink" title="5.测试"></a>5.测试</h3><pre><code>mysql -u root -p</code></pre><h2 id="0x3"><a href="#0x3" class="headerlink" title="0x3"></a>0x3</h2><p>再装php</p><p><a href="https://www.vultr.com/docs/how-to-install-php-7-x-on-centos-7" target="_blank" rel="noopener">Vultr</a>有比较详细的安装教程,我就贴出来了。这里装的是php7.1</p><p>然后再安装个php-fpm</p><pre><code>yum install php71w-fpm</code></pre><p>这里注意的是php7.1是php71w的前缀</p><p>接下来进入Nginx的目录配置nginx.conf或者是/conf.d/default.d，一般目录是在<code>/etc/nginx/</code>,把下面这段注释取消就好了。</p><pre><code>location ~ \.php$ {
    root           html;
    fastcgi_pass   127.0.0.1:9000;
    fastcgi_index  index.php;
    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
    include        fastcgi_params;
}</code></pre><p>值得一提的是，我在配阿里云都没出现在过什么问题，但是就是配Vultr就出现了一些坑</p><p>首先是出现了</p><pre><code>connect() failed (111: Connection refused) while connecting to upstream, server: localhost, request: "GET /xxx.php HTTP/1.1", upstream: "fastcgi://127.0.0.1:9000"</code></pre><p>这个就是php-fpm忘记开了</p><p>然后又碰到了<code>File Not Found</code>的错误,<code>cat</code>了<code>error.log</code>看一下:</p><pre><code>FastCGI sent in stderr: "Primary script unknown" while reading response header from upstream, server: localhost, request: "GET /test.php HTTP/1.1", upstream: "fastcgi://127.0.0.1:9000"</code></pre><p>这就比较郁闷了，不过Google还是能找到的，反正就是说<code>File Not Found</code>，看了一下原来是location的<code>root</code>配置问题，</p><pre><code>location ~ \.php$ {
    root           /usr/share/nginx/html;
    fastcgi_pass   127.0.0.1:9000;
    fastcgi_index  index.php;
    fastcgi_param  SCRIPT_FILENAME  /$document_root$fastcgi_script_name;
    include        fastcgi_params;
}</code></pre><p>特别要注意root指向的位置，这又是比较坑的东西。</p><p>然后就是安装typecho的坑了。</p><h2 id="0x4"><a href="#0x4" class="headerlink" title="0x4"></a>0x4</h2><h3 id="这里就简单提提typecho的坑。"><a href="#这里就简单提提typecho的坑。" class="headerlink" title="这里就简单提提typecho的坑。"></a>这里就简单提提typecho的坑。</h3><p>第一个就是与nginx的配置，这个还好有<a href="http://docs.typecho.org/servers" target="_blank" rel="noopener">文档</a>，但是只能解决我的</p><pre><code>无法登录后台，点击前台链接或者后台登录时出现"404, not found"</code></pre><p>这个问题</p><p>还有出现的一个问题就是typecho的登录302的问题。</p><p>还好有大佬直接给了我解决方案:</p><pre><code>在config.inc.php加入define('__TYPECHO_SECURE__',1);</code></pre><p>后来查了一下发现这个是用来开启https访问typecho的设置</p><pre><code>/** 开启HTTPS */
define('__TYPECHO_SECURE__',true);</code></pre><p>具体可以参照一下这篇<a href="https://faq.xiaoz.me/archives/64.html" target="_blank" rel="noopener">文章</a></p><p>还有typecho点击评论确无法评论的问题，只要在typecho管理员控制台中在永久链接中把自定义文章路径</p><p>默认是</p><pre><code>默认风格 /archives/{cid}/</code></pre><p>改成</p><pre><code>wordpress风格 /archives/{slug}.html</code></pre><p>具体原因没查，我猜也是nginx与typecho的pathinfo问题</p><h2 id="0x5"><a href="#0x5" class="headerlink" title="0x5"></a>0x5</h2><p>这篇文章主要就到这吧，后续会增加一些自己以后遇到的问题</p><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html></div><div class="columns is-variable is-1 is-multiline is-mobile"> <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Dev/">#Dev</a></span></div><hr><blockquote class="colorquote info"><p>Article Author: Zeddy</p><p>Article Link: https://blog.zeddyu.info/2018/03/03/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ELNMP/index.html</p><p>Copyright Notice: With the exception of the special statement at the beginning of the article, all articles can be reprinted in accordance with the CC BY 4.0 agreement with the author&#39;s permission.</p></blockquote><blockquote class="colorquote success"><p>Ad: I am looking for some guys who have a strong interest in CTFs to build a team focused on international CTFs that are on the ctftime.org, if anyone is interested in this idea you can take a look at here: https://blog.zeddyu.info/advertisement/</p><p>Ad: 想了解更多有意思的国际赛 CTF 中 Web 知识技巧，欢迎加入我的 <a href="https://blog.zeddyu.info/advertisement/#知识星球" target="_blank" rel="noopener">知识星球</a> ; 另外我正在召集一群小伙伴组建一支专注国际 CTF 的队伍，如果有感兴趣的小伙伴也可在 <a href="https://blog.zeddyu.info/advertisement/#International-CTF-Team" target="_blank" rel="noopener">International CTF Team</a> 查看详情</p></blockquote><div class="columns is-mobile is-multiline article-nav"> <span class="column is-12-mobile is-half-desktop article-nav-prev"><a href="/2018/03/04/MacOS-X-%E4%B8%8B%E9%85%8D%E7%BD%AENginx-amp-PHP/">MacOS X 下配置Nginx &amp;amp; PHP</a></span> <span class="column is-12-mobile is-half-desktop article-nav-next"><a href="/2018/01/28/Docker%E9%95%9C%E5%83%8F%E7%9A%84%E6%97%B6%E9%97%B4%E9%97%AE%E9%A2%98/">Docker镜像的时间问题</a></span></div></article><div class="comments"><h3 class="title is-4">Comments</h3><script>function loadDisqus(){var e=document,n=e.createElement("script");n.src="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqus.js",l=e.createElement("link"),l.href="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqusjs.css",l.setAttribute("rel","stylesheet"),(e.head||e.body).appendChild(n),e.head.appendChild(l),n.onload=function(){new DisqusJS({shortname:"zeddyu",siteName:"blog.zeddyu.info",identifier:document.location.origin+document.location.pathname+document.location.search,url:document.location.origin+document.location.pathname+document.location.search,title:document.title,api:"https://blog.zeddyu.info/api/",apikey:"57m1j10pU1WfesAhs8Ri3OcmPEaRmoyIuNCPcYaUu6mqWu6Ek4qvRiQf9CXl2JoH",admin:"ZeddYu",adminLabel:""})}}var runningOnBrowser="undefined"!=typeof window,isBot=runningOnBrowser&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);setTimeout(function(){isBot||loadDisqus()},1)</script><div id="disqus_thread"></div></div></div></section><footer class="footer"><div class="container"><div class="columns content"><div class="column is-narrow has-text-centered"> &copy; 2021 Zedd&nbsp; Powered by <a href="http://hexo.io/" target="_blank" rel="noopener noreferrer">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-minos">Minos</a></div><div class="column is-hidden-mobile"></div><div class="column is-narrow"><div class="columns is-mobile is-multiline is-centered"> <a class="column is-narrow has-text-black" title="GitHub" href="https://github.com/ZeddYu" target="_blank" rel="noopener">GitHub</a> <a class="column is-narrow has-text-black" title="RSS" href="https://blog.zeddyu.info/atom.xml">RSS</a> <a class="column is-narrow has-text-black" title="Twitter" href="https://twitter.com/ZeddYu_Lu" target="_blank" rel="noopener">Twitter</a></div></div></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script><script>moment.locale("en-AU")</script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script><style>.hljs{position:relative}.hljs .clipboard-btn{float:right;color:#9a9a9a;background:0 0;border:none;cursor:pointer}.hljs .clipboard-btn:hover{color:#8a8a8a}.hljs>.clipboard-btn{display:none;position:absolute;right:4px;top:4px}.hljs:hover>.clipboard-btn{display:inline}.hljs>figcaption>.clipboard-btn{margin-right:4px}</style><script>$(document).ready(function(){$("figure.hljs").each(function(t,e){var a="code-"+t,r=e.querySelector(".code"),c=$('<button>Copy <i class="far fa-clipboard"></i></button>');r.id=a,c.addClass("clipboard-btn"),c.attr("data-clipboard-target-id",a);var n=e.querySelector("figcaption");n?n.append(c[0]):e.prepend(c[0])}),new ClipboardJS(".clipboard-btn",{target:function(t){return document.getElementById(t.getAttribute("data-clipboard-target-id"))}}).on("success",function(t){t.clearSelection()})})</script><script src="https://cdn.jsdelivr.net/gh/ZeddYu/ZeddYu.github.io@master/js/script.js"></script><script src="https://cdn.jsdelivr.net/gh/ZeddYu/ZeddYu.github.io@master/js/insight.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1740444562387978" crossorigin="anonymous"></script><div class="searchbox ins-search"><div class="searchbox-mask"></div><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"> <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},CONTENT_URL:"/content.json"}</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html>