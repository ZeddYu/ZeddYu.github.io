<!DOCTYPE html><html class="has-navbar-fixed-top" lang="zh-cmn-Hans"><head><meta charset="utf-8"><title>MacOS X 下配置Nginx &amp;amp; PHP - Zedd&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5"><meta name="description" content="ZeddYu's Blog"><meta name="description" content="也有一段时间没写博客了，说好的技术博主呢，hhhhh。其实一些小错误感觉没什么好写的。但是配置环境的坑我踩了好久了。趁这次重装了Mac，刚好记录记录配置Nginx，虽然前面写过一篇配置，但是Mac上还是有比较多的坑的。也不知道啥时候Mac才自带Nginx呀。个人喜欢Homebrew，没用Macport，所以下文都是采用的Homebrew。"><meta property="og:type" content="article"><meta property="og:title" content="MacOS X 下配置Nginx &amp; PHP"><meta property="og:url" content="https://blog.zeddyu.info/2018/03/04/MacOS-X-%E4%B8%8B%E9%85%8D%E7%BD%AENginx-amp-PHP/index.html"><meta property="og:site_name" content="Zedd&#39;s Blog"><meta property="og:description" content="也有一段时间没写博客了，说好的技术博主呢，hhhhh。其实一些小错误感觉没什么好写的。但是配置环境的坑我踩了好久了。趁这次重装了Mac，刚好记录记录配置Nginx，虽然前面写过一篇配置，但是Mac上还是有比较多的坑的。也不知道啥时候Mac才自带Nginx呀。个人喜欢Homebrew，没用Macport，所以下文都是采用的Homebrew。"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2018-03-04T02:22:00.000Z"><meta property="article:modified_time" content="2021-09-27T17:45:58.720Z"><meta property="article:author" content="Zedd"><meta property="article:tag" content="Dev"><meta name="twitter:card" content="summary"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.8.1/css/bulma.min.css"><script defer="defer" src="https://at.alicdn.com/t/font_1780077_0ad2sbnz4nz.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="/css/style.css"><script>window.ga_tid="UA-112937997-1",window.ga_api="https://blog.zeddyu.info/ga_api/*"</script><script src="https://cdn.jsdelivr.net/npm/cfga@1.0.3" async></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Zedd's Blog" type="application/atom+xml"></head><body><nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation"><div class="container"><div class="navbar-brand"><div class="navbar-item navbar-logo"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s.gravatar.com/avatar/204a0c779acdb62f9084826396f6dccb?s=80" alt="" height="28"></div><div class="navbar-burger"><span></span><span></span><span></span></div></div><div class="navbar-menu navbar-start"> <a class="navbar-item" href="/">Index</a> <a class="navbar-item" href="/archives">Archives</a> <a class="navbar-item" href="/categories">Categories</a> <a class="navbar-item" href="/tags">Tags</a> <a class="navbar-item" href="/friends">Friends</a> <a class="navbar-item" href="/about">About</a> <a class="navbar-item" href="/advertisement">Ads</a></div><div class="navbar-menu navbar-end"> <a class="navbar-item search" title="Search" href="javascript:;"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-sousuo"></use></svg></a><div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc"> <a class="navbar-item" title="Table of Contents"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-list"></use></svg></a><div class="navbar-dropdown is-right"> <a class="navbar-item" href="#0x1-Nginx安装">1&nbsp;&nbsp;<b>0x1 Nginx安装</b></a><hr class="navbar-divider"> <a class="navbar-item" href="#0x2-PHP">2&nbsp;&nbsp;<b>0x2 PHP</b></a><hr class="navbar-divider"> <a class="navbar-item" href="#0x3-php-fpm">3&nbsp;&nbsp;<b>0x3 php-fpm</b></a><hr class="navbar-divider"> <a class="navbar-item" href="#0x4-配置Nginx-conf">4&nbsp;&nbsp;<b>0x4 配置Nginx.conf</b></a><hr class="navbar-divider"> <a class="navbar-item" href="#0x5-BrBrBr">5&nbsp;&nbsp;<b>0x5 BrBrBr</b></a></div></div> <a class="navbar-item" title="GitHub" href="https://github.com/ZeddYu" target="_blank" rel="noopener"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a> <a class="navbar-item" title="Twitter" href="https://twitter.com/ZeddYu_Lu" target="_blank" rel="noopener"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-twitter"></use></svg></a> <a class="navbar-item" title="RSS" href="https://blog.zeddyu.info/atom.xml"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-rss"></use></svg></a></div></div></nav><section class="section"><div class="container"><article class="article content gallery" itemscope itemprop="blogPost"><h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name"> MacOS X 下配置Nginx &amp;amp; PHP</h1><div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile"> <span class="column is-narrow"><span>Mar 4 2018</span> <span class="second-date-block">(<time datetime="2018-03-04T02:22:00.000Z" itemprop="datePublished">Mar 4 2018</time>)</span></span> <span class="column is-narrow article-category"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-folder"></use></svg><a class="article-category-link" href="/categories/Dev/">Dev</a></span> <span class="column is-narrow"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-shalou"></use></svg> <span class="article-category-link">8 minutes read (About 1136 words)</span></span></div><div class="article-entry is-size-6-mobile" itemprop="articleBody"><ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x1-Nginx安装"><span class="post-toc-number">1.</span> <span class="post-toc-text">0x1 Nginx安装</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x2-PHP"><span class="post-toc-number">2.</span> <span class="post-toc-text">0x2 PHP</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x3-php-fpm"><span class="post-toc-number">3.</span> <span class="post-toc-text">0x3 php-fpm</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x4-配置Nginx-conf"><span class="post-toc-number">4.</span> <span class="post-toc-text">0x4 配置Nginx.conf</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#0x5-BrBrBr"><span class="post-toc-number">5.</span> <span class="post-toc-text">0x5 BrBrBr</span></a></li></ol><html><head></head><body><p>也有一段时间没写博客了，说好的技术博主呢，hhhhh。其实一些小错误感觉没什么好写的。但是配置环境的坑我踩了好久了。趁这次重装了Mac，刚好记录记录配置Nginx，虽然前面写过一篇配置，但是Mac上还是有比较多的坑的。也不知道啥时候Mac才自带Nginx呀。个人喜欢Homebrew，没用Macport，所以下文都是采用的Homebrew。</p><a id="more"></a><h2 id="0x1-Nginx安装"><a href="#0x1-Nginx安装" class="headerlink" title="0x1 Nginx安装"></a>0x1 Nginx安装</h2><p>通过Homebrew安装</p><p></p><figure class="highlight mipsasm hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="hljs-keyword">brew </span>search nginx</span><br><span class="line">$ <span class="hljs-keyword">brew </span><span class="hljs-keyword">install </span>nginx</span><br></pre></td></tr></tbody></table></figure><p></p><p>然后通过</p><p></p><figure class="highlight armasm hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="hljs-keyword">brew </span><span class="hljs-meta">info</span> nginx</span><br></pre></td></tr></tbody></table></figure><p></p><p>你可以看到关于nginx的各种信息</p><p></p><figure class="highlight groovy hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Docroot <span class="hljs-string">is:</span> <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/var/</span>www</span><br><span class="line"></span><br><span class="line">Nginx.<span class="hljs-string">conf :</span> <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/etc/</span>nginx/nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="hljs-string">Log :</span> <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/var/</span>log/nginx</span><br></pre></td></tr></tbody></table></figure><p></p><p>通过</p><p></p><figure class="highlight elixir hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-variable">$ </span>nginx</span><br></pre></td></tr></tbody></table></figure><p></p><p>即可启动nginx，访问localhost:8080便可看到Nginx欢迎界面</p><h2 id="0x2-PHP"><a href="#0x2-PHP" class="headerlink" title="0x2 PHP"></a>0x2 PHP</h2><p>采用了系统的php</p><p></p><figure class="highlight angelscript hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ php -v</span><br><span class="line">PHP <span class="hljs-number">5.6</span><span class="hljs-number">.30</span> (cli) (built: Oct <span class="hljs-number">29</span> <span class="hljs-number">2017</span> <span class="hljs-number">20</span>:<span class="hljs-number">30</span>:<span class="hljs-number">32</span>)</span><br><span class="line">Copyright (c) <span class="hljs-number">1997</span><span class="hljs-number">-2016</span> The PHP Group</span><br><span class="line">Zend Engine v2<span class="hljs-number">.6</span><span class="hljs-number">.0</span>, Copyright (c) <span class="hljs-number">1998</span><span class="hljs-number">-2016</span> Zend Technologies</span><br></pre></td></tr></tbody></table></figure><p></p><p>想用php7也可以通过brew进行安装使用</p><h2 id="0x3-php-fpm"><a href="#0x3-php-fpm" class="headerlink" title="0x3 php-fpm"></a>0x3 php-fpm</h2><p>按照上面流程走的话，如果在Nginx网站目录下创建一个index.php，内容为phpinfo，会发现访问index.php会出现直接下载，那便是因为还没有启动php-fpm以及配置nginx.conf的原因。</p><p>Mac自带php-fpm，但是这里还是有比较多坑的。<br>参考来自: <a href="https://github.com/musicode/test/issues/5" target="_blank" rel="noopener">Mac 配置 php-fpm</a></p><p>直接运行<code>php-fpm</code>启动php-fpm</p><p></p><figure class="highlight angelscript hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ php-fpm</span><br><span class="line">[<span class="hljs-number">04</span>-Mar<span class="hljs-number">-2018</span> <span class="hljs-number">00</span>:<span class="hljs-number">35</span>:<span class="hljs-number">04</span>] ERROR: failed to open configuration file <span class="hljs-string">'/private/etc/php-fpm.conf'</span>: No such file <span class="hljs-keyword">or</span> directory (<span class="hljs-number">2</span>)</span><br><span class="line">[<span class="hljs-number">04</span>-Mar<span class="hljs-number">-2018</span> <span class="hljs-number">00</span>:<span class="hljs-number">35</span>:<span class="hljs-number">04</span>] ERROR: failed to load configuration file <span class="hljs-string">'/private/etc/php-fpm.conf'</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>错误信息显示，不能打开配置文件，<code>cd /private/etc</code>，发现没有 <code>php-fpm.conf</code>文件，但是有<code>php-fpm.conf.default</code>文件。这个文件是默认配置，我们可以复制一份，改名为<code>php-fpm.conf</code>，然后再根据需要改动配置。</p><p></p><figure class="highlight gradle hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo cp <span class="hljs-regexp">/private/</span>etc<span class="hljs-regexp">/php-fpm.conf.default /</span><span class="hljs-keyword">private</span><span class="hljs-regexp">/etc/</span>php-fpm.conf</span><br></pre></td></tr></tbody></table></figure><p></p><p>再执行<code>php-fpm</code></p><p></p><figure class="highlight subunit hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ php-fpm</span><br><span class="line"><span class="hljs-keyword">ERROR: </span>failed to open error_log (/usr/var/log/php-fpm.log): No such file or directory (2)</span><br><span class="line"><span class="hljs-keyword">ERROR: </span>failed to post process the configuration</span><br><span class="line"><span class="hljs-keyword">ERROR: </span>FPM initialization failed</span><br></pre></td></tr></tbody></table></figure><p></p><p>错误信息显示，不能打开错误日志文件。<code>cd /usr/var/log</code>发现根本没有这个目录，甚至连<code>var</code>目录都没有，加上为了避免权限问题，干脆配置到 <code>/usr/local/var/log</code>目录。</p><p>修改<code>php-fpm.conf</code>中<code>error_log</code> 配置为 <code>/usr/local/var/log/php-fpm.log</code>，并把 user 和 group 改为和当前用户一样。</p><p></p><figure class="highlight routeros hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">; <span class="hljs-builtin-name">Error</span> log file</span><br><span class="line">; <span class="hljs-keyword">If</span> it<span class="hljs-string">'s set to "syslog", log is sent to syslogd instead of being written</span></span><br><span class="line"><span class="hljs-string">; in a local file.</span></span><br><span class="line"><span class="hljs-string">; Note: the default prefix is /usr/var</span></span><br><span class="line"><span class="hljs-string">; Default Value: log/php-fpm.log</span></span><br><span class="line"><span class="hljs-string">error_log = /usr/local/var/log/php-fpm.log</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">...</span></span><br><span class="line"><span class="hljs-string"></span></span><br><span class="line"><span class="hljs-string">; Unix user/group of processes</span></span><br><span class="line"><span class="hljs-string">; Note: The user is mandatory. If the group is not set, the default user'</span>s group</span><br><span class="line">;       will be used.</span><br><span class="line">user = xxx(当前用户)</span><br><span class="line">group = xxx(当前用户组)</span><br></pre></td></tr></tbody></table></figure><p></p><p>怎么查看当前用户以及所属组呢？<a href="http://www.cnblogs.com/520zijuan/archive/2013/02/03/2890851.html" target="_blank" rel="noopener">参考链接</a></p><p></p><figure class="highlight gams hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-symbol">$</span> who   <span class="hljs-comment">//查看当前登陆的用户</span></span><br><span class="line"><span class="hljs-symbol">$</span> finger    <span class="hljs-comment">//用于查找并显示用户信息</span></span><br><span class="line"><span class="hljs-symbol">$</span> finger xxx   <span class="hljs-comment">//查看用户的信息</span></span><br><span class="line"><span class="hljs-symbol">$</span> groups xxx   <span class="hljs-comment">//查看用户所属组别</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>执行 php-fpm，再次报错：</p><p></p><figure class="highlight xquery hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ php-fpm</span><br><span class="line">NOTICE: [pool www] <span class="hljs-string">'user'</span> directive <span class="hljs-literal">is</span> ignored <span class="hljs-keyword">when</span> FPM <span class="hljs-literal">is</span><span class="hljs-built_in"> not</span> running <span class="hljs-keyword">as</span><span class="hljs-built_in"> root</span></span><br><span class="line">NOTICE: [pool www] <span class="hljs-string">'group'</span> directive <span class="hljs-literal">is</span> ignored <span class="hljs-keyword">when</span> FPM <span class="hljs-literal">is</span><span class="hljs-built_in"> not</span> running <span class="hljs-keyword">as</span><span class="hljs-built_in"> root</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>于是用<code>sudo php-fpm</code>，再次报错：</p><p></p><figure class="highlight routeros hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo php-fpm</span><br><span class="line">ERROR: unable <span class="hljs-keyword">to</span> bind listening socket <span class="hljs-keyword">for</span><span class="hljs-built_in"> address </span><span class="hljs-string">'127.0.0.1:9000'</span>:<span class="hljs-built_in"> Address </span>already <span class="hljs-keyword">in</span> use (48)</span><br><span class="line">ERROR: FPM initialization failed</span><br></pre></td></tr></tbody></table></figure><p></p><p>编辑<code>php-fpm.conf</code>，修改<code>listen</code>为<code>127.0.0.1:9999</code>。<br>具体也可以参考<a href="http://www.cnblogs.com/kaiye/archive/2013/05/25/3099393.html" target="_blank" rel="noopener">Mac如何查看端口占用</a></p><p>其实后来通过检查端口，发现当时占用的也是php-fpm，也有点疑惑。</p><p>可以用过<code>sudo pkill php-fpm</code>关闭php-fpm</p><p></p><figure class="highlight elixir hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-variable">$ </span>sudo pkill php-fpm</span><br></pre></td></tr></tbody></table></figure><p></p><p>最后</p><p></p><figure class="highlight angelscript hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php-fpm -t</span><br><span class="line">[<span class="hljs-number">04</span>-Mar<span class="hljs-number">-2018</span> <span class="hljs-number">01</span>:<span class="hljs-number">56</span>:<span class="hljs-number">01</span>] NOTICE: configuration file /<span class="hljs-keyword">private</span>/etc/php-fpm.conf test <span class="hljs-keyword">is</span> successful</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="0x4-配置Nginx-conf"><a href="#0x4-配置Nginx-conf" class="headerlink" title="0x4 配置Nginx.conf"></a>0x4 配置Nginx.conf</h2><p>nginx.conf的配置还是相当重要的，毕竟是nginx的配置文件</p><p>网上也挺多<a href="https://www.jianshu.com/p/31c9d412585a" target="_blank" rel="noopener">参考链接</a></p><p>首先，找到<code>server</code>的<code>location</code>配置，给<code>index</code>加一个<code>index.php</code></p><p></p><figure class="highlight glsl hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">location</span> / {</span><br><span class="line">    root   html;</span><br><span class="line">    <span class="hljs-keyword">index</span>  <span class="hljs-keyword">index</span>.html <span class="hljs-keyword">index</span>.htm <span class="hljs-keyword">index</span>.php;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>然后配置端口，我改成了80端口，但是每次启动都需要sudo</p><p></p><figure class="highlight nginx hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-section">server</span> {</span><br><span class="line">    <span class="hljs-attribute">listen</span>       <span class="hljs-number">80</span>;</span><br><span class="line">    <span class="hljs-attribute">server_name</span>  localhost;</span><br></pre></td></tr></tbody></table></figure><p></p><p>接着去掉php相关的注释，并修改 fastcgi_param 参数</p><p></p><figure class="highlight arcade hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- fastcgi_param SCRIPT_FILENAME /scripts<span class="hljs-symbol">$fastcgi</span>_script_name;</span><br><span class="line">+ fastcgi_param SCRIPT_FILENAME <span class="hljs-symbol">$docume</span>nt_root<span class="hljs-symbol">$fastcgi</span>_script_name;</span><br></pre></td></tr></tbody></table></figure><p></p><p>所以完整php配置为</p><p></p><figure class="highlight nginx hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class="line"><span class="hljs-comment">#</span></span><br><span class="line"><span class="hljs-attribute">location</span> <span class="hljs-regexp">~ \.php$</span> {</span><br><span class="line">    <span class="hljs-attribute">root</span>           html;</span><br><span class="line">    <span class="hljs-attribute">fastcgi_pass</span>   <span class="hljs-number">127.0.0.1:9000</span>;</span><br><span class="line">    <span class="hljs-attribute">fastcgi_index</span>  index.php;</span><br><span class="line">    <span class="hljs-attribute">fastcgi_param</span>  SCRIPT_FILENAME  <span class="hljs-variable">$document_root</span><span class="hljs-variable">$fastcgi_script_name</span>;</span><br><span class="line">    <span class="hljs-attribute">include</span>        fastcgi_params;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>重启Nginx</p><p></p><figure class="highlight elixir hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-variable">$ </span>sudo nginx -s reload</span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="0x5-BrBrBr"><a href="#0x5-BrBrBr" class="headerlink" title="0x5 BrBrBr"></a>0x5 BrBrBr</h2><p>好啦，可以开心地进行开发啦！</p><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html></div><div class="columns is-variable is-1 is-multiline is-mobile"> <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Dev/">#Dev</a></span></div><hr><blockquote class="colorquote info"><p>Article Author: Zeddy</p><p>Article Link: https://blog.zeddyu.info/2018/03/04/MacOS-X-%E4%B8%8B%E9%85%8D%E7%BD%AENginx-amp-PHP/index.html</p><p>Copyright Notice: With the exception of the special statement at the beginning of the article, all articles can be reprinted in accordance with the CC BY 4.0 agreement with the author&#39;s permission.</p></blockquote><blockquote class="colorquote success"><p>Ad: I am looking for some guys who have a strong interest in CTFs to build a team focused on international CTFs that are on the ctftime.org, if anyone is interested in this idea you can take a look at here: https://blog.zeddyu.info/advertisement/</p><p>Ad: 想了解更多有意思的国际赛 CTF 中 Web 知识技巧，欢迎加入我的 <a href="https://blog.zeddyu.info/advertisement/#知识星球" target="_blank" rel="noopener">知识星球</a> ; 另外我正在召集一群小伙伴组建一支专注国际 CTF 的队伍，如果有感兴趣的小伙伴也可在 <a href="https://blog.zeddyu.info/advertisement/#International-CTF-Team" target="_blank" rel="noopener">International CTF Team</a> 查看详情</p></blockquote><div class="columns is-mobile is-multiline article-nav"> <span class="column is-12-mobile is-half-desktop article-nav-prev"><a href="/2018/03/13/%E5%8D%9A%E5%AE%A2%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8F%8A%E4%B8%80%E4%BA%9B%E5%9D%91/">博客自动化及一些坑</a></span> <span class="column is-12-mobile is-half-desktop article-nav-next"><a href="/2018/03/03/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ELNMP/">服务器配置的那些事--基于LNMP</a></span></div></article><div class="comments"><h3 class="title is-4">Comments</h3><script>function loadDisqus(){var e=document,n=e.createElement("script");n.src="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqus.js",l=e.createElement("link"),l.href="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqusjs.css",l.setAttribute("rel","stylesheet"),(e.head||e.body).appendChild(n),e.head.appendChild(l),n.onload=function(){new DisqusJS({shortname:"zeddyu",siteName:"blog.zeddyu.info",identifier:document.location.origin+document.location.pathname+document.location.search,url:document.location.origin+document.location.pathname+document.location.search,title:document.title,api:"https://blog.zeddyu.info/api/",apikey:"57m1j10pU1WfesAhs8Ri3OcmPEaRmoyIuNCPcYaUu6mqWu6Ek4qvRiQf9CXl2JoH",admin:"ZeddYu",adminLabel:""})}}var runningOnBrowser="undefined"!=typeof window,isBot=runningOnBrowser&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);setTimeout(function(){isBot||loadDisqus()},1)</script><div id="disqus_thread"></div></div></div></section><footer class="footer"><div class="container"><div class="columns content"><div class="column is-narrow has-text-centered"> &copy; 2021 Zedd&nbsp; Powered by <a href="http://hexo.io/" target="_blank" rel="noopener noreferrer">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-minos">Minos</a></div><div class="column is-hidden-mobile"></div><div class="column is-narrow"><div class="columns is-mobile is-multiline is-centered"> <a class="column is-narrow has-text-black" title="GitHub" href="https://github.com/ZeddYu" target="_blank" rel="noopener">GitHub</a> <a class="column is-narrow has-text-black" title="RSS" href="https://blog.zeddyu.info/atom.xml">RSS</a> <a class="column is-narrow has-text-black" title="Twitter" href="https://twitter.com/ZeddYu_Lu" target="_blank" rel="noopener">Twitter</a></div></div></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script><script>moment.locale("en-AU")</script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script><style>.hljs{position:relative}.hljs .clipboard-btn{float:right;color:#9a9a9a;background:0 0;border:none;cursor:pointer}.hljs .clipboard-btn:hover{color:#8a8a8a}.hljs>.clipboard-btn{display:none;position:absolute;right:4px;top:4px}.hljs:hover>.clipboard-btn{display:inline}.hljs>figcaption>.clipboard-btn{margin-right:4px}</style><script>$(document).ready(function(){$("figure.hljs").each(function(t,e){var a="code-"+t,r=e.querySelector(".code"),c=$('<button>Copy <i class="far fa-clipboard"></i></button>');r.id=a,c.addClass("clipboard-btn"),c.attr("data-clipboard-target-id",a);var n=e.querySelector("figcaption");n?n.append(c[0]):e.prepend(c[0])}),new ClipboardJS(".clipboard-btn",{target:function(t){return document.getElementById(t.getAttribute("data-clipboard-target-id"))}}).on("success",function(t){t.clearSelection()})})</script><script src="https://cdn.jsdelivr.net/gh/ZeddYu/ZeddYu.github.io@master/js/script.js"></script><script src="https://cdn.jsdelivr.net/gh/ZeddYu/ZeddYu.github.io@master/js/insight.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1740444562387978" crossorigin="anonymous"></script><div class="searchbox ins-search"><div class="searchbox-mask"></div><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"> <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},CONTENT_URL:"/content.json"}</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html>